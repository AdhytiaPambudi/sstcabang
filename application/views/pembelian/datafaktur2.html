{% extends "layout.html" %} {% block content %} {% include "navigation.html" %}
<style type="text/css">

@font-face {
font-family: "Fake-Receipt";
src: url('{{ base_url }}assets/fonts/fake_receipt.ttf');
}

/*.button.disabled {
  opacity: 0.65; 
  cursor: not-allowed;
}*/

.modal .modal-body {
    overflow-y: auto;
    overflow-x: auto;
}
.clearfix:after {
  content: "";
  display: table;
  clear: both;
}
.rata-kanan{
    text-align: right;
}
.huruf-tebal{
    font-weight: bold;
}

td.child ul li span.dtr-data{
    display: inline-block;
    min-width: 80px;
    text-align: right;
    text-align: right;
}
table tr td{
    padding: 0 5px 0 5px;
}

a {
  color: #0087C3;
  text-decoration: none;
}

/*body {
  position: relative;
  width: 21cm;  
  height: 29.7cm; 
  margin: 0 auto; 
  color: #555555;
  background: #FFFFFF; 
  font-family: Arial, sans-serif; 
  font-size: 14px; 
  font-family: SourceSansPro;
}*/

header {
  padding: 10px 0;
  margin-bottom: 20px;
  border-bottom: 1px solid #AAAAAA;
}

table {
    font-size: 11px;
}
table tr td {
    padding-left: 3px;
}
.detail td{
    border-right: solid 1px;
    border-bottom: solid 1px;
    font-size: 10px;
}
.detail-item td{
    border-right: solid 1px;
    font-size: 10px;
}
.atas td{
    border-top: solid 1px;
}
.awal{
    border-left: solid 1px;
    font-size: 10px;
}

#logo {
  float: left;
  margin-top: 8px;
}

#logo img {
  height: 70px;
}

#company {
  float: right;
  text-align: right;
}


#details {
  margin-bottom: 50px;
}

#client {
  padding-left: 6px;
  border-left: 6px solid #0087C3;
  float: left;
}

#client .to {
  color: #777777;
}

h2.name {
  font-size: 1.4em;
  font-weight: normal;
  margin: 0;
}

#invoice {
  float: right;
  text-align: right;
}

#invoice h1 {
  color: #0087C3;
  font-size: 2.4em;
  line-height: 1em;
  font-weight: normal;
  margin: 0  0 10px 0;
}

#invoice .date {
  font-size: 1.1em;
  color: #777777;
}

@media print {
    html, body{
        font-size:6px;
        font-family: Tahoma;
        width: 210mm;
        height: 155mm;
        margin-top: 0mm !important;
    }
}
table.report-container {
    page-break-after:always;
}
thead.report-header {
    display:table-header-group;
}
tfoot.report-footer {
    display:table-footer-group;
    bottom: 0;
}
        
</style>
<div id="dvjson"></div>
<div id="progressGIF" style="position: fixed; top:0px; left:0px; bottom:0px; right:0px; background-color: rgba(0, 0, 0, 0.10); z-index: 1000; display: none;">
    <center>
    <img src="{{base_url}}assets/img/progress.gif" width="150px" style="padding-top: 15%; position: relative;">
    <p style="position: relative; font-size: 18px;">DATA SEDANG DI PROSES</p>
    </center>
</div>
<div id="page-wrapper">
    <div class="row">
        <div class="col-lg-12">
            <!-- <h1 class="page-header">Data Faktur</h1> -->
        </div>
        <!-- /.col-lg-12 -->
    </div>
    <!-- /.row -->    
    <form role="form" method="post" id="myForm">
    <div class="row">
        <div class="col-lg-6" style="margin-bottom: 10px">
            <!-- <button id="reload" class="btn btn-default" onclick="reloadTable()"><i class="fa fa-refresh"></i> Reload</button> -->
            <!-- <button class="btn btn-primary" onclick="updateData()"><i class="fa fa-refresh"></i> Update</button> -->
        </div>
        <div class="col-lg-6" style="margin-bottom: 10px; text-align: right;">
            <!-- <button type="button" id="kirimFaktur" class="btn btn-warning" onclick="buatInkaso()"><i class="fa fa-check"></i> Buat Inkaso</button> -->
        </div>
        <div class="col-lg-12">
            <table>
                <tr>
                    <td><label>Periode</label></td>
                    <td><input type="date" name="tgl1" class="form-control input-sm"></td>
                    <td>s/d</td>
                    <td><input type="date" name="tgl2" class="form-control input-sm"></td>
                    <td><button id="buttonload" class="btn btn-primary" onclick="load_data(event,this)">Tampilkan data</button></td>
                </tr>
            </table>
        </div>
        <div class="col-lg-12" style="text-align: right;">
            <input type="checkbox" name="all" id="all" value="all" onclick="allData()"> tampilkan semua data
        </div>
    </div>
    <!-- /.row -->
    <div class="row">
        <div class="col-lg-12">
            <!-- /.panel -->
            <div class="panel panel-default">
                        <div class="panel-heading">
                            <b>Datatable List Faktur</b> 
                            <!-- <button onclick="export_all(event)">all CSV</button> -->
                            <!-- <button onclick="cetak_ulang(event)">cetak Ulang</button> -->
                        </div>
                        <!-- /.panel-heading -->
                        <div class="panel-body">
                            <table class="table table-striped table-bordered table-hover" id="dataTables-example">
                                <thead>
                                    <tr>
                                        <th>#</th>
                                        <th>Status Pusat</th>
                                        <th><input type="checkbox" name="title"  value="" id="checkAll" ></th>
                                        <th>Detail</th>
                                        <!-- <th>Print</th> -->
                                        <th>Faktur Komersil</th>
                                        <th>Tanggal Faktur</th>
                                        <th>No Faktur</th>
                                        <th>No SO</th>
                                        <th>Type Doc</th>
                                        <th>Pelanggan</th>
                                        <th>Nama Pelanggan</th>
                                        <th>Salesman</th>
                                        <th>Rayon</th>
                                        <th>Status</th>
                                        <th>Acu</th>
                                        <th>Cara Bayar</th>
                                        <th>Value Cash Diskon</th>
                                        <th>TOP</th>
                                        <th>Tanggal JTO</th>
                                        <th>Gross</th>
                                        <th>Potongan</th>
                                        <th>Value</th>
                                        <th>PPN</th>
                                        <th>Total</th>
                                        <th>Saldo</th>
                                        <th>Status Inkaso</th>
                                        <th>No DIH</th>
                                        <th>Tgl DIH</th>
                                        <th>Alasan JTO</th>
                                    </tr>
                                </thead>
                                <tbody></tbody>
                            </table>
                        </div>
                        <!-- /.panel-body -->
                    </div>
        </div>
        <!-- /.col-lg-12 -->
    </div>
    <!-- /.row -->
    </form>
</div>
<!-- /#page-wrapper -->

<!-- Bootstrap modal -->
<div class="modal fade" id="modal_form" role="dialog">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                <h3 class="modal-title">Detail Data Faktur</h3>
            </div>
            <div class="modal-body form" style="overflow-x: auto">
                <h3>Data Header</h3> 
                <table width="100%" class="table2 table-striped table-bordered table-hover" id="headerDataFaktur">
                    <thead style="line-height: 2">
                        <tr>
                            <th style="min-width:100px">Cabang</th>
                            <th style="min-width:100px">No SO</th>
                            <th style="min-width:100px">Faktur Komersil</th>
                            <th style="min-width:100px">Faktur</th>
                            <th style="min-width:100px">Time Faktur</th>
                            <th style="min-width:100px">Pelanggan</th>
                            <th style="min-width:100px">Nama Pelanggan</th>
                            <th style="min-width:100px">Alamat Faktur</th>
                            <th style="min-width:100px">Tipe Pelanggan</th>
                            <th style="min-width:100px">NPWP Pelanggan</th>
                            <th style="min-width:100px">Kategori Pelanggan</th>
                            <th style="min-width:100px">Acu</th>
                            <th style="min-width:100px">Cara Bayar</th>
                            <th style="min-width:100px">Cash Diskon</th>
                            <th style="min-width:100px">Value Cash Diskon</th>
                            <th style="min-width:100px">TOP</th>
                            <th style="min-width:100px">Tgl JTO Faktur</th>
                            <th style="min-width:100px">Nama Salesman</th>
                            <th style="min-width:100px">Rayon</th>
                            <th style="min-width:100px">Status</th>
                            <th style="min-width:100px">Tipe Dokumen</th>
                            <th style="min-width:100px">Disc Cab Max</th>
                            <th style="min-width:100px">Disc Prins Max</th>
                            <th style="min-width:100px">COGS</th>
                            <th style="min-width:100px">Total COGS</th>
                        </tr>
                    </thead>
                </table><br>

                <h3>Data Detail</h3>
                <table width="100%" class="table2 table-striped table-bordered table-hover" id="detailDataFaktur">
                    <thead style="line-height: 2">
                        <tr>
                            <th style="min-width:50px">No</th>
                            <th style="min-width:100px">Kode Produk</th>
                            <th style="min-width:100px">Nama Produk</th>
                            <th style="min-width:100px">Harga</th>
                            <th style="min-width:100px">Qty Faktur</th>
                            <th style="min-width:100px">Bonus Faktur</th>
                            <th style="min-width:100px">Qty Faktur Komersil</th>
                            <th style="min-width:100px">Bonus Faktur Komersil</th>
                            <th style="min-width:100px">Value Bonus</th>
                            <th style="min-width:100px">Disc Cabang</th>
                            <th style="min-width:100px">Value Disc Cabang</th>
                            <th style="min-width:100px">Disc Cabang Total</th>
                            <th style="min-width:100px">Value Disc Cabang Total</th>
                            <th style="min-width:100px">Disc Prins 1</th>
                            <th style="min-width:100px">Value Disc Prins 1</th>
                            <th style="min-width:100px">Disc Prins 2</th>
                            <th style="min-width:100px">Value Disc Prins 2</th>
                            <th style="min-width:100px">Disc Prins Total</th>
                            <th style="min-width:100px">Value Disc Prins Total</th>
                            <th style="min-width:100px">Disc Total</th>
                            <th style="min-width:100px">Value Disc Total</th>
                            <th style="min-width:100px">Gross</th>
                            <th style="min-width:100px">Potongan</th>
                            <th style="min-width:100px">Value</th>
                            <th style="min-width:100px">PPN</th>
                            <th style="min-width:100px">Lain Lain</th>
                            <th style="min-width:100px">Total</th>
                            <th style="min-width:100px">Batch No</th>
                            <th style="min-width:100px">Exp Date</th>
                        </tr>
                    </thead>
                </table>
            </div>
            <div class="modal-footer"><!-- 
                <button type="button" id="btnSave" onclick="saveData()" class="btn btn-primary">Save</button>
                <button type="button" class="btn btn-danger" data-dismiss="modal">Cancel</button> -->
            </div>
        </div><!-- /.modal-content -->
    </div><!-- /.modal-dialog -->
</div><!-- /.modal -->
<div class="modal fade" id="modal_form_cndn" role="dialog">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                <h3 class="modal-title">Detail Data Faktur CN/DN</h3>
            </div>
            <div class="modal-body form" style="overflow-x: auto">
                <h3>Data Header</h3> 
                 <table width="100%" class="table2 table-striped table-bordered table-hover" id="headerDataCNDN">
                    <thead style="line-height: 2">
                        <tr>
                            <th style="min-width:100px">Cabang</th>
                            <th style="min-width:100px">No Faktur</th>
                            <th style="min-width:100px">Time Faktur</th>
                            <th style="min-width:100px">Pelanggan</th>
                            <th style="min-width:100px">Nama Pelanggan</th>
                            <th style="min-width:100px">Alamat Faktur</th>
                            <th style="min-width:100px">Tipe Pelanggan</th>
                            <th style="min-width:100px">NPWP Pelanggan</th>
                            <th style="min-width:100px">Kategori Pelanggan</th>
                            <th style="min-width:100px">Acu</th>
                            <th style="min-width:100px">Cara Bayar</th>
                            <th style="min-width:100px">TOP</th>
                        </tr>
                    </thead>
                </table><br>

                <h3>Data Detail</h3>
                <table width="100%" class="table2 table-striped table-bordered table-hover" id="detailDataFaktur_cndn">
                    <thead style="line-height: 2">
                        <tr>
                            <th style="min-width:50px">No</th>
                            <th style="min-width:100px">Kode Produk</th>
                            <th style="min-width:100px">Nama Produk</th>
                            <th style="min-width:100px">Harga</th>
                            <th style="min-width:100px">Persen</th>
                            <th style="min-width:100px">Nilai</th>
                            <th style="min-width:100px">Disc Cabang</th>
                            <th style="min-width:100px">Jumlah</th>
                        </tr>
                    </thead>
                </table>
            </div>
            <div class="modal-footer"><!-- 
                <button type="button" id="btnSave" onclick="saveData()" class="btn btn-primary">Save</button>
                <button type="button" class="btn btn-danger" data-dismiss="modal">Cancel</button> -->
            </div>
        </div><!-- /.modal-content -->
    </div><!-- /.modal-dialog -->
</div>
<div class="modal fade" role="dialog"  id="example-cetak">
    <div class="modal-content">
    <div class="modal-body form">
    <div id ="print_out">
    <table border="0" cellspacing="0">
        <tr>
            <td height="80px" width="80px" valign="top">
                <div id="logo"><img src="{{base_url}}assets/logo/1489135837049.jpg"></div>
            </td>
            <td width="280px" valign="top">
                PT. SAPTA SARITAMA<br>
                Jl. Caringin No. 254 A BABAKAN, BANDUNG
            </td>
            <td rowspan="3" valign="top">
                <table cellspacing="0">
                    <tr>
                        <td>No.Faktur &nbsp;</td>
                        <td>:&nbsp;</td>
                        <td width="180" nowrap v-html="NoFaktur"></td>
                    </tr>
                    <tr>
                        <td>Tanggal &nbsp;</td>
                        <td>:&nbsp;</td>
                        <td width="100" nowrap v-html="TglFaktur | format_tanggal"></td>
                    </tr>
                    <tr>
                        <td>Cabang &nbsp;</td>
                        <td>:&nbsp;</td>
                        <td width="100" nowrap v-html="Cabang"></td>
                    </tr>
                    <tr>
                        <td>Tipe Pelanggan &nbsp;</td>
                        <td>:&nbsp;</td>
                        <td width="100" nowrap v-html="TipePelanggan"></td>
                        
                    </tr>
                    <tr>
                        <td>Cara Bayar &nbsp;</td>
                        <td>:&nbsp;</td>
                        <td width="100" nowrap v-html="CaraBayar"></td>
                        
                    </tr>
                    <tr>
                        <td>TOP &nbsp;</td>
                        <td>:&nbsp;</td>
                        <td width="100" nowrap><span v-text="TOP"></span><span v-if="TOP > 0">&nbsp;Hari</span></td>
                    </tr>
                    <tr>
                        <td width="100" nowrap>Tgl Jatuh Tempo &nbsp;</td>
                        <td>:&nbsp;</td>
                        <td width="100" nowrap v-html="Jatuh_Tempo | format_tanggal"></td>
                        
                    </tr>
                    <tr>
                        <td width="100" nowrap>No Pajak &nbsp;</td>
                        <td>:&nbsp;</td>
                        <td width="100" nowrap v-html="NoPajak"></td>
                    </tr>
                </table>
            </td>
            <td valign="top" align="center">
                <span v-if="data_detail[0].TipeDokumen == 'Faktur'"><H5>Faktur Penjualan</H5></span>
                <span v-if="data_detail[0].TipeDokumen == 'Retur'"><H5>Retur Penjualan</H5></span>
                <div id="bcTarget"></div>
            </td>
        </tr>
        <tr>
            <td colspan="2">
                <table>
                    <tr>
                        <td>Pelanggan</td>
                        <td>: <span v-html='Pelanggan'></span> - <span v-html='NamaPelanggan'></span></td>
                    </tr>
                    <tr>
                        <td>Alamat</td>
                        <td>: <span v-html='AlamatFaktur'></td>
                    </tr>
                    <tr>
                        <td>NPWP</td>
                        <td>: <span v-html='NPWPPelanggan'></td>
                    </tr>
                </table>
            </td>
            <td></td>
        </tr>
    </table>
    <table cellspacing="0" class="report-container">
    <thead class="report-header">
        <tr class="detail atas" align="center">
            <td rowspan="2" width="20" class="awal">No.</td>
            <td rowspan="2" width="60">ID</td>
            <td rowspan="2" width="220">NAMA PRODUK</td>
            <td colspan="5">DATA</td>
            <td rowspan="2" width="60">BONUS</td>
            <td rowspan="2" width="80">DISKON</td>
            <td rowspan="2" width="80">GROSS</td>
            <td rowspan="2" width="80">POTONGAN</td>
            <td rowspan="2" width="80">VALUE</td>
        </tr>
        <tr class="detail" align="center">
            <td width="40">Qty</td>
            <td width="30">Satuan</td>
            <td width="30">Batch</td>
            <td width="100">Exp Date</td>
            <td width="50">Harga</td>
        </tr>
    </thead>
    <tbody class="report-body">
        <tr v-for = "(index,datas) in data_detail" class="detail-item" style="page-break-after: always;" >
            <td valign="top" v-html='index + 1' class='awal'> {{ index }}</td>
            <td valign="top" v-html='datas.KodeProduk' style='padding-left:5px;'></td>
            <td style='padding-left:2px;'>
                <span v-text='datas.NamaProduk'></span>
                    <span v-if="datas.DiscCab > 0" v-text="'D/'"></span>
                    <span v-if="datas.DiscCab > 0" v-text="datas.DiscCab | currencyDisplay"></span>
                    <span v-if="parseFloat(datas.DiscPrins1)+parseFloat(datas.DiscPrins2) > 0" v-text='"P/"'></span>
                    <span v-if="parseFloat(datas.DiscPrins1)+parseFloat(datas.DiscPrins2) > 0" v-text='parseFloat(datas.DiscPrins1)+parseFloat(datas.DiscPrins2) | currencyDisplay'></span>
            </td>
            <td v-html='datas.QtyFaktur | currencyDisplay' style='padding-right:2px;' align='right'> </td>
            <td v-html='datas.UOM' style='padding-left:2px;'></td>
            <td v-html='datas.BatchNo' style='padding-left:2px;'></td>
            <td v-html='datas.ExpDate' style='padding-left:2px;font-size:11px'></td>
            <td v-html='datas.Harga | currencyDisplay' style='padding-right:2px;'  align="right"></td>
            <td v-html='datas.ValueBonus | currencyDisplay' style='padding-right:2px;'  align="right"></td>
             <td v-html='datas.ValueDiscCab + datas.ValueDiscPrins1 + datas.ValueDiscPrins2 | currencyDisplay' style='padding-right:2px;'  align="right"></td>
            <td v-html='datas.Gross_detail | currencyDisplay' style='padding-right:2px;'  align="right"></td>
            <td v-html='datas.Potongan_detail | currencyDisplay' style='padding-right:2px;'  align="right"></td>
            <td v-html='datas.Value_detail | currencyDisplay' style='padding-right:2px;'  align="right"></td>
        </tr>
    </tbody>
    <tr v-if="data_detail.length <= 10 ">
        <td style="border-bottom: solid 1px;" colspan='13'>
            
        </td>
    </tr>
    <tr v-if="data_detail.length > 10 && data_detail.length <= 20">
        <td style="border-bottom: solid 1px;"  colspan='13'>
            <div style="border-bottom: solid 1px;"></div>
            <div style="page-break-before:always"></div>

        </td>
    </tr>
    <tr v-if="data_detail.length > 20 && data_detail.length < 35">
        <td style="border-bottom: solid 1px;"  colspan='13'>
            <div style="border-bottom: solid 1px;"></div>
            <div style="page-break-before:auto"></div>

        </td>
    </tr>
    <tr v-if="data_detail.length >= 35">
        <td style="border-bottom: solid 1px;"  colspan='13'>
            <div style="border-bottom: solid 1px;"></div>
            <div style="page-break-before:always"></div>

        </td>
    </tr>
        <tr class="detail atas" style="font-size: 11px;">
            <td class='awal' colspan="3" valign="top">Jumlah</td>
            <td align='right' v-html='total_qty | currencyDisplay' style='padding-right:2px;'></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td><!-- <td align='right' v-html='total_Harga | currencyDisplay' style='padding-right:2px;'></td> -->
            <td align='right' v-html='total_ValueBonus | currencyDisplay' style='padding-right:2px;'></td>
            <td align='right' v-html='total_ValueDiscCab + total_ValueDiscPrins1 + total_ValueDiscPrins2| currencyDisplay' style='padding-right:2px;'></td>
            <td align='right' v-html='Gross | currencyDisplay' style='padding-right:2px;'></td>
            <td align='right' v-html='Potongan | currencyDisplay' style='padding-right:2px;'></td>
            <td align='right' v-html='Value | currencyDisplay' style='padding-right:2px;'></td>
        </tr>
        <tr class="detail atas">
            <td style='padding-left:5px;' colspan="10" rowspan='4' valign="top" class="awal">Terbilang : <br> <span id ="terbilang_value"></span></td>
            <td></td>
        </tr>
        <tr class="detail">
            <td colspan="2">Ongkos Kirim</td>
            <td align='right' v-html='OngkosKirim | currencyDisplay' style='padding-right:2px;'></td>
        </tr>
        <tr class="detail">
            <td colspan="2">Materai</td>
            <td align='right' v-html='Materai | currencyDisplay' style='padding-right:2px;'></td>
        </tr>
        <tr class="detail">
            <td colspan="2">PPN</td>
            <td align='right' v-html='Ppn | currencyDisplay' style='padding-right:2px;'></td>
        </tr>
        <tr class="detail">
            <td colspan="3" rowspan="2" class="awal">
                <div id="qcTarget"></div>
                <img id="qrImage" src="" style="margin:2px;"></td></td>
            <td colspan="4" rowspan="2" align="left">
            <td colspan="3" rowspan="2"></td>
            <td colspan="2">Jumlah Tagihan</td>
            <td align='right' v-html='Total | currencyDisplay' style='padding-right:2px;'></td>
        </tr>
        <tr class="detail">
            <td colspan="2">Dasar Pengenaan Pajak</td>
            <td></td>
        </tr>
    </table>
    <table width="840px;">
        <tr>
            <td>
                Pembayaran harap di transfer ke 
                <!-- rekening {....................} BCA cabang {---------------------} A/C : {-------------}; -->
                <span v-text="Bank_Acc"></span>.&nbsp;
                Pembayaran dengan cek dan giro dianggap sah setelah diuangkan <br>
                * Sesuai PER. DJP /16/PJ/2014 e-faktur Pajak tidak perlu di cek hard copy. Jika diperlukan e-faktur Pajak dapat
                dicetak sendiri dengan memindai kode QRCODE dikiri bawah dokumen ini.
            </td>
        </tr>
    </table>
    <table width="100%">
        <tr>
            <td width="250" align="center">
                <br>
                Penerima, <br><br><br><br><br><br>
                <span style="border-top: solid 1px; width: 200px; display: block;"></span>
            </td>
            <td width="250" align="center">
                Hormat Kami,<br>
                Pengirim, <br><br><br><br><br>
                <span v-html="Nama_APJ"></span>
                <span style="border-top: solid 1px; width: 200px; display: block;" v-text="SIKA_Faktur"></span>
            </td>
        </tr>
    </table>
    <br>
    </div> 
    </div>
    </div>
</div>

<div class="modal fade" role="dialog"  id="example-cetak-cn" role="dialog">
    <div class="modal-content">
    <div class="modal-body form">
    <div id ="print_out_cn">
        <h4>PT SAPTASARITAMA * <span v-html="TipeDokumen"></span> *</h4>
        <div class="style2"></div>
        <table class="header" cellspacing="0">
            <tr>
                <td width="80">No. Dokumen </td>
                <td>:</td>
                <td width="170"v-html="NoFaktur" style='padding-left:2px;'></td>
                <td width="80">Kode Sales</td>
                <td>:</td>
                <td width="170"></td>
                <td rowspan="4" width="190">
                    Kepada Yth. <span v-html="NamaPelanggan"></span> <br>
                    <span v-html="AlamatFaktur"></span>
                </td>
            </tr>
            <tr>
                <td>Tgl. Dokumen</td>
                <td>:</td>
                <td v-html="TglFaktur | format_tanggal" style='padding-left:2px;'></td>
                <td>Rayon </td>
                <td>:</td>
                <td v-html="Cabang" style='padding-left:2px;'></td>
            </tr>
            <tr>
                <td>Lama Bayar </td>
                <td>:</td>
                <td v-text="TOP + ' hari'" style='padding-left:2px;'></td>
                <td>Tgl j. Tempo </td>
                <td>:</td>
                <td v-html="TglFaktur | j_tempo" style='padding-left:2px;'></td>
            </tr>
            <tr>
                <td>No. Acuan</td>
                <td>:</td>
                <td v-html="Acu" style='padding-left:2px;'></td>
                <td>Kode Outlet</td>
                <td>:</td>
                <td v-html="Pelanggan" style='padding-left:2px;'></td>
            </tr>
        </table>
        <div class="style1"></div>
        <table border="0" cellspacing="0" cellpadding="1">
            <tr align="center">
                <td width="80" class="atas kiri bawah">Kode</td>
                <td width="300" class="atas kiri bawah">Nama Barang</td>
                <td width="90" class="atas kiri bawah">Nilai</td>
                <td width="90" class="atas kiri bawah">S-Harga</td>
                <td width="80" class="atas kiri bawah">%Prc</td>
                <td width="100" class="atas kiri kanan bawah">Jumlah</td>
            </tr>
            <tr>
                <td colspan="6" class="kiri kanan bawah">KAMI KREDITIR REKENING SDR</td>
            </tr>
            <tr v-for="detail_data in data_detail">
                <td class="kiri"><span v-html="detail_data.KodeProduk"></span></td>
                <td class="kiri"><span v-html="detail_data.Produk"></td>
                <td class="kiri" align="right"><span v-html="detail_data.Value |currencyDisplay"></td>
                <td class="kiri" align="right"><span v-html="detail_data.DasarPerhitungan | currencyDisplay"></td>
                <td class="kiri" align="right"><span v-html="detail_data.Persen"></td>
                <td class="kiri kanan" align="right"><span v-html="detail_data.Jumlah | currencyDisplay"></td>
            </tr>
            <tr>
                <td colspan="2" align="center" class="atas bawah kiri">Total Potongan</td>
                <td colspan="4" align="center" class="atas bawah kanan kiri">Nilai Dokumen</td>
            </tr>
            <tr>
                <td colspan="2" align="center" class="kiri bawah"><span v-html="total_Harga"></td>
                <td colspan="4" align="center" class="kiri kanan bawah"><span v-html="total_Harga"></td>
            </tr>
        </table>
        <br>
        Terbilang: 
        <br>
        <table>
            <tr align="center">
                <td width="300px">
                    T a n d a &nbsp; T e r i m a<br><br><br>(--------------------)
                </td>
                <td width="300px">
                    H o r m a t &nbsp; K a m i<br><br><br>(--------------------)
                </td>
            </tr>
        </table>
    </div>
    </div>
    </div>
</div>
<!-- End Bootstrap modal -->
{% endblock %}

{% block js %}
<script>
    var tabel;
    $(document).ready(function() {
        vue_cetak = new Vue({
            el : '#example-cetak',
            data : {
                faktur:[],
                jml_halaman : 1,
                TglFaktur: '',
                NoFaktur: '',
                NoPajak:'',
                TipePelanggan: '',
                Pelanggan: '',
                NamaPelanggan: '',
                AlamatFaktur: '',
                Cabang: '',
                Bank_Acc:'',
                NPWPPelanggan: '',
                CaraBayar: '',
                TOP: '',
                Jatuh_Tempo : '',
                Status: '',
                statusPusat: '',
                TipeFaktur: '',
                Gross: '',
                Value: '',
                Potongan: '',
                Ppn: '',
                Materai: '',
                OngkosKirim: '',
                Total: '',
                Nama_APJ: '',
                SIKA_Faktur:'',
                total_qty : 0,
                total_Harga : 0,
                total_Bonus : 0,
                total_ValueBonus : 0,
                total_ValueDiscCab : 0,
                total_ValueDiscPrins1 : 0,
                total_ValueDiscPrins2 : 0,
                data_detail : []
            },
            computed:{
                jml_halaman:function(){
                    var halaman = 1;
                    halaman = Math.ceil(this.data_detail.length / 10);
                    return halaman;
                },
                total_qty:function(){
                    var gross = 0;
                    $.each(this.data_detail, function (i, e) {
                        gross += Math.round(e.QtyFaktur);
                    });
                    return gross;
                },
                total_Harga:function(){
                    var gross = 0;
                    $.each(this.data_detail, function (i, e) {
                        gross += Math.round(e.Harga);
                    });
                    return gross;
                },
                total_Bonus:function(){
                    var gross = 0;
                    $.each(this.data_detail, function (i, e) {
                        gross += Math.round(e.Bonus);
                    });
                    return gross;
                },
                total_ValueBonus:function(){
                    var gross = 0;
                    $.each(this.data_detail, function (i, e) {
                        gross += Math.round(e.ValueBonus);
                    });
                    return gross;
                },
                total_ValueDiscCab:function(){
                    var gross = 0;
                    $.each(this.data_detail, function (i, e) {
                        gross += Math.round(e.ValueDiscCab);
                    });
                    return gross;
                },
                total_ValueDiscPrins1:function(){
                    var gross = 0;
                    $.each(this.data_detail, function (i, e) {
                        gross += Math.round(e.ValueDiscPrins1);
                    });
                    return gross;
                },
                total_ValueDiscPrins1:function(){
                    var gross = 0;
                    $.each(this.data_detail, function (i, e) {
                        gross += Math.round(e.ValueDiscPrins2);
                    });
                    return gross;
                },
            }
        });
         vue_cetak_cn = new Vue({
            el : '#example-cetak-cn',
            data : {
                jml_halaman : 1,
                TglFaktur: '',
                NoFaktur: '',
                NoPajak:'',
                TipePelanggan: '',
                TipeDokumen: 'CN',
                Pelanggan: '',
                Acu: '',
                NamaPelanggan: '',
                AlamatFaktur: '',
                Cabang: '',
                Bank_Acc:'',
                NPWPPelanggan: '',
                TOP: '',
                Jatuh_Tempo: '',
                Status: '',
                statusPusat: '',
                Potongan: '',
                Total: '',
                Nama_APJ:'',
                SIKA_Faktur:'',
                // total_Harga : 0,
                data_detail : []
            },
            computed:{
                jml_halaman:function(){
                    var halaman = 1;
                    halaman = Math.ceil(this.data_detail.length / 10);
                    return halaman;
                },
                total_Harga:function(){
                    var gross = 0;
                    $.each(this.data_detail, function (i, e) {
                        gross += Math.round(e.Jumlah);
                    });
                    return gross;
                },
                total_ValueBonus:function(){
                    var gross = 0;
                    $.each(this.data_detail, function (i, e) {
                        gross += Math.round(e.ValueBonus);
                    });
                    return gross;
                },
                total_ValueDiscCab:function(){
                    var gross = 0;
                    $.each(this.data_detail, function (i, e) {
                        gross += Math.round(e.ValueDiscCab);
                    });
                    return gross;
                },
            }

        });

        Vue.filter('currencyDisplay',{
                read: function(val){
                    return accounting.formatNumber(val);
                },
                write: function(val,oldVal){
                    return accounting.unformat(val,",")
                }
        });

        Vue.filter('format_tanggal',{
            read: function(val){
                return f_tanggal(val);
            }
        });

        Vue.filter('format_pajak',{
            read: function(val){
                var pattern = '###.###-##.########'
                var i = 0,
                    v = val.toString();
                return pattern.replace(/#/g, _ => v[i++]);
        }
        });

        $('#dataTables-example').on('processing.dt', function (e, settings, processing) {
            if (processing) {
                // console.log('it is loadding');     // **I do not get this**
                $("#buttonload").html('<i class="fa fa-refresh fa-spin"></i>&nbsp;silahkan tunggu Loading');
                $("#buttonload").prop('disabled', true);
            } else {
                // console.log('it is not loadding'); // **I get this**
                $("#buttonload").text('Tampilkan data');
                $("#buttonload").prop('disabled', false);
            }
        });

    });

    $("#checkAll").change(function () {
        $("input:checkbox").not("#all").prop('checked', $(this).prop("checked"));
    });

    function load_data(e,x){
        e.preventDefault();


        $("#notif").empty();
        var status = 'Open';
        var tgl1 = $('[name=tgl1]').val();
        var tgl2 = $('[name=tgl2]').val();
        if(tgl1 == "" || tgl2 == ""){
            notif("warning", "<h4>Mohon isi periode</h4> <br> karena bila load semua data tanpa periode akan memakan waktu  lama");
            $('[name=tgl1]').focus();
            return;
        }
        
        if ($.fn.dataTable.isDataTable('#dataTables-example')) {
            tabel.destroy();
            $('#tblRemittanceList tbody').empty();
        }
        
        $(x).prop('disabled', true);
        tabel = $('#dataTables-example').DataTable({
            "ordering": false,
            "processing": true,
            "serverSide": true,
            scrollX:        true,
            scrollCollapse: true,
            fixedColumns:   {
                leftColumns: 1,
                rightColumns: 1
            },
            "ajax": {
                "url": "{{ base_url }}listDataFaktur",
                "data":{
                    tipe: 'Faktur',
                    tgl1: tgl1,
                    tgl2: tgl2
                }, 
                "type": "POST"
            },
            "lengthMenu": [[10, 25, 50, 100, -1], [10, 25, 50, 100, "All"]],
            // responsive: true,
            dom: 'Bfrtip',
            columnDefs: [
                {
                    targets: 2,
                    "render": function ( data, type, row, meta ) {
                        // console.log(row);
                        return '<p align="center"><input type="checkbox" class="ceklis" value="'+row[4]+'" dokumen="'+row[8]+'"></p>';
                    }
                },
                {
                    targets: 7,
                    "render": function ( data, type, row, meta ) {
                        return data;
                    }
                },
                {
                    targets: [19,20,21,22,23,24],
                    className: 'rata-kanan huruf-tebal'
                },
            ],
            buttons: [
                'excel',
                // 'copy', 'csv', 'excel', 
                {
                    extend:'pdfHtml5',
                    title: 'PT. SAPTA SARITAMA\n-----------------------------------\nData Faktur ',
                    exportOptions: {
                        columns: [ 0, 1, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20],
                    },
                    download: 'open',
                    orientation: 'landscape',
                    pageSize: 'A4',
                    customize: function (doc) {
                        // doc.content[1].table.widths = Array(doc.content[1].table.body[0].length + 1).join('*').split('');
                        doc.pageMargins = [20, 20, 10,10 ];
                        doc.styles.tableHeader.fontSize = 8;
                        doc.defaultStyle.fontSize = 8;
                    }
                },
                {
                    extend: 'print',
                    exportOptions: {
                        columns: ':visible',
                    }
                },
                {
                    text: 'Cetak Faktur preprinted',
                    action: function ( e, dt, node, config ) {
// detek windows -------------------------------------------------------------------------
                        var url = "";
                        var OSName = "Unknown";
                        if (window.navigator.userAgent.indexOf("Windows NT 10.0")!= -1) OSName="Windows 10";
                        if (window.navigator.userAgent.indexOf("Windows NT 6.2") != -1) OSName="Windows 8";
                        if (window.navigator.userAgent.indexOf("Windows NT 6.1") != -1) OSName="Windows 7";
                        if (window.navigator.userAgent.indexOf("Windows NT 6.0") != -1) OSName="Windows Vista";
                        if (window.navigator.userAgent.indexOf("Windows NT 5.1") != -1) OSName="Windows XP";
                        if (window.navigator.userAgent.indexOf("Windows NT 5.0") != -1) OSName="Windows 2000";
                        if (window.navigator.userAgent.indexOf("Mac")            != -1) OSName="Mac/iOS";
                        if (window.navigator.userAgent.indexOf("X11")            != -1) OSName="UNIX";
                        if (window.navigator.userAgent.indexOf("Linux")          != -1) OSName="Linux";
                        // console.log(OSName);
// end detek window ---------------------------------------------------------------------
                        if(OSName == 'Windows 7'){
                            // url = 'cetak_faktur_preprinted_xp';
                            // url = 'cetak_faktur_blank';
                            url = 'cetak_faktur_text';
                        }else{
                            url = 'cetak_faktur_preprinted_xp';
                            // url = 'cetak_faktur_preprinted';
                        }
                        cetaklist(url);
                    }
                },
                {
                    text: 'Cetak Faktur barcode',
                    action: function ( e, dt, node, config ) {
                        cetaklist("cetak_faktur");
                    }
                },
                {
                    text: 'Cetak Faktur + DO barcode',
                    action: function ( e, dt, node, config ) {
                        cetaklist2("cetak_faktur");
                    }
                },
                {
                    text: 'Cetak item banyak',
                    action: function ( e, dt, node, config ) {
                        cetak_preprinted();
                    }
                },
                'pageLength', 'colvis'
            ],
            "pageLength": 100,
            "language": {
                    "emptyTable":     "Tidak ada data.."
                }
        });

    }


    function reloadTable()
    {
        tabel.ajax.reload(null,false);
    }

    function allData() { 
        var all = document.getElementById('all').value;       
        if($("#all").is(':checked')){ 
            tabel.ajax.url('{{ base_url }}listDataFaktur/all');
        }   
        else{
            tabel.ajax.url('{{ base_url }}listDataFaktur');
        }
        reloadTable();
    }   

    function prosesData(No)
    {
        var url = "{{ base_url }}prosesDataFaktur"; 
        // ajax adding data to database
        $('#progressGIF').show();
        $.ajax({
            url : url,
            type: "POST",
            data:{No:No},
            dataType: "JSON",
            success: function(data)
            {
                if (data.status == false) {
                    // notif('danger', 'PERHATIAN! Data Pelanggan & Salesman Harus Sesuai Dengan List.', 'saveResult');
                    notif('warning', 'PERHATIAN! Tidak dapat terhubung dengan server pusat');
                }
                else{
                    notif('success', 'SUKSES! Data berhasil disimpan ke server pusat');
                    reloadTable();
                }
                $('#progressGIF').hide();
            },
            error: function (jqXHR, textStatus, errorThrown)
            {
                notif('warning', 'PERHATIAN! Tidak dapat terhubung dengan server pusat');
                $('#progressGIF').hide();
            }
        });
    }

    function view(no,TipeDokumen){

         // show bootstrap modal when complete loaded

        $('.itemRowHeader').remove();
        $('.itemRowDetail').remove();
        $.ajax({
            url : "{{ base_url }}listDetailFaktur",
            type: "POST",
            data:{no:no,TipeDokumen:TipeDokumen},
            dataType: "JSON",
            success: function(data)
            {   
                if(TipeDokumen =='Faktur' || TipeDokumen == 'Retur')
                {   
                    $('#modal_form').modal('show');
                    var x = 1;
                    var nf = new Intl.NumberFormat();
                    $('#headerDataFaktur').append('<tr class="itemRowHeader"><td style="min-width:100px">'+data[0].Cabang+'</td><td style="min-width:100px">'+data[0].NoSO+'</td><td style="min-width:100px">'+data[0].NoDO+'</td><td style="min-width:100px">'+data[0].NoFaktur+'</td><td style="min-width:100px">'+data[0].TimeFaktur+'</td><td style="min-width:100px">'+data[0].Pelanggan+'</td><td style="min-width:100px">'+data[0].NamaPelanggan+'</td><td style="min-width:100px">'+data[0].AlamatFaktur+'</td><td style="min-width:100px">'+data[0].TipePelanggan+'</td><td style="min-width:100px">'+data[0].NPWPPelanggan+'</td><td style="min-width:100px">'+data[0].KategoriPelanggan+'</td><td style="min-width:100px">'+data[0].Acu+'</td><td style="min-width:100px">'+data[0].CaraBayar+'</td><td style="min-width:100px">'+data[0].CashDiskon+'</td><td style="min-width:100px">'+numberWithCommas(data[0].ValueCashDiskon)+'</td><td style="min-width:100px">'+data[0].TOP+'</td><td style="min-width:100px">'+data[0].TglJtoFaktur+'</td><td style="min-width:100px">'+data[0].NamaSalesman+'</td><td style="min-width:100px">'+data[0].Rayon+'</td><td style="min-width:100px">'+data[0].Status+'</td><td style="min-width:100px">'+data[0].TipeDokumen+'</td><td style="min-width:100px">'+data[0].DiscCabMax+'</td><td style="min-width:100px">'+data[0].DiscPrinsMax+'</td><td style="min-width:100px">'+data[0].COGS+'</td><td style="min-width:100px">'+data[0].TotalCOGS+'</td></tr>');

                    for(i in data)
                    {
                        $('#detailDataFaktur').append($('<tr class="itemRowDetail"><td style="min-width:50px">'+x+'</td><td style="min-width:100px">'+data[i].KodeProduk+'</td><td style="min-width:100px">'+data[i].NamaProduk+'</td><td style="min-width:100px" class="rata-kanan">'+numberWithCommas(data[i].Harga)+'</td><td style="min-width:100px" class="rata-kanan">'+data[i].QtyDO+'</td><td style="min-width:100px" class="rata-kanan">'+data[i].BonusDO+'</td><td style="min-width:100px" class="rata-kanan">'+data[i].QtyFaktur+'</td><td style="min-width:100px" class="rata-kanan">'+data[i].BonusFaktur+'</td><td style="min-width:100px" class="rata-kanan">'+numberWithCommas(data[i].ValueBonus)+'</td><td style="min-width:100px" class="rata-kanan">'+data[i].DiscCab+'</td><td style="min-width:100px" class="rata-kanan">'+numberWithCommas(data[i].ValueDiscCab)+'</td><td style="min-width:100px" class="rata-kanan">'+data[i].DiscCabTot+'</td><td style="min-width:100px" class="rata-kanan">'+numberWithCommas(data[i].ValueDiscCabTotal)+'</td><td style="min-width:100px" class="rata-kanan">'+data[i].DiscPrins1+'</td><td style="min-width:100px" class="rata-kanan">'+numberWithCommas(data[i].ValueDiscPrins1)+'</td><td style="min-width:100px" class="rata-kanan">'+data[i].DiscPrins2+'</td><td style="min-width:100px" class="rata-kanan">'+numberWithCommas(data[i].ValueDiscPrins2)+'</td><td style="min-width:100px" class="rata-kanan">'+data[i].DiscPrinsTot+'</td><td style="min-width:100px" class="rata-kanan">'+numberWithCommas(data[i].ValueDiscPrinsTotal)+'</td><td style="min-width:100px" class="rata-kanan">'+data[i].DiscTotal+'</td><td style="min-width:100px" class="rata-kanan">'+numberWithCommas(data[i].ValueDiscTotal)+'</td><td style="min-width:100px" class="rata-kanan">'+numberWithCommas(data[i].Gross)+'</td><td style="min-width:100px" class="rata-kanan">'+numberWithCommas(data[i].Potongan)+'</td><td style="min-width:100px" class="rata-kanan">'+numberWithCommas(data[i].Value)+'</td><td style="min-width:100px" class="rata-kanan">'+numberWithCommas(data[i].Ppn)+'</td><td style="min-width:100px" class="rata-kanan">'+numberWithCommas(data[i].LainLain)+'</td><td style="min-width:100px" class="rata-kanan">'+numberWithCommas(data[i].Total)+'</td><td style="min-width:100px">'+data[i].BatchNo+'</td><td style="min-width:100px">'+data[i].ExpDate+'</td></tr>'));
                        x++;
                    }

                }else{
                    $('#modal_form_cndn').modal('show');
                    var x = 1;
                    var nf = new Intl.NumberFormat();
                    $('#headerDataCNDN').append('<tr class="itemRowHeader"><td style="min-width:100px">'+data[0].Cabang+'</td><td style="min-width:100px">'+data[0].NoFaktur+'</td><td style="min-width:100px">'+data[0].TimeFaktur+'</td><td style="min-width:100px">'+data[0].Pelanggan+'</td><td style="min-width:100px">'+data[0].NamaPelanggan+'</td><td style="min-width:100px">'+data[0].AlamatFaktur+'</td><td style="min-width:100px">'+data[0].TipePelanggan+'</td><td style="min-width:100px">'+data[0].NPWPPelanggan+'</td><td style="min-width:100px">'+data[0].KategoriPelanggan+'</td><td style="min-width:100px">'+data[0].Acu+'</td><td style="min-width:100px">'+data[0].CaraBayar+'</td><td style="min-width:100px">'+data[0].TOP+'</td></tr>');

                    for(i in data)
                    {
                        $('#detailDataFaktur_cndn').append($('<tr class="itemRowDetail"><td style="min-width:50px">'+x+'</td><td style="min-width:100px">'+data[i].KodeProduk+'</td><td style="min-width:100px">'+data[i].Produk+'</td><td style="min-width:100px" class="rata-kanan">'+numberWithCommas(data[i].DasarPerhitungan)+'</td><td style="min-width:100px" class="rata-kanan">'+data[i].Persen+'</td><td style="min-width:100px" class="rata-kanan">'+data[i].Rupiah+'</td><td style="min-width:100px" class="rata-kanan">'+data[i].DscCab+'</td><td style="min-width:100px" class="rata-kanan">'+numberWithCommas(data[i].Jumlah)+'</td></tr>'));
                        x++;
                    }
                }
                
            },
            error: function (jqXHR, textStatus, errorThrown)
            {
                alert('Error get data from ajax');
            }
        });
    }
    function cetak(no,TipeDokumen){
        // vue_cetak = [];
        $("#notif").empty();
        jQuery('.itemRow').remove();
        $.ajax({
            url : "{{ base_url }}printdataFaktur",
            type: "POST",
            data:{no:no,TipeDokumen:TipeDokumen},
            dataType: "JSON",
            success: function(data)
            {
                if(TipeDokumen == 'Faktur' || TipeDokumen =='Retur'){
                    vue_cetak.TglFaktur         = data[0].TglFaktur;
                    vue_cetak.NoFaktur          = data[0].NoFaktur;
                    vue_cetak.NoPajak           = data[0].NoPajak;
                    vue_cetak.TipePelanggan     = data[0].TipePelanggan;
                    vue_cetak.Pelanggan         = data[0].Pelanggan;
                    vue_cetak.NamaPelanggan     = data[0].NamaPelanggan;
                    vue_cetak.AlamatFaktur      = data[0].AlamatFaktur;
                    vue_cetak.Cabang            = data[0].Cabang;
                    vue_cetak.NPWPPelanggan     = data[0].NPWPPelanggan;
                    vue_cetak.CaraBayar         = data[0].CaraBayar;
                    if(data[0].CaraBayar == "Cash"){
                        vue_cetak.TOP               = 7;
                        var newdate = new Date(data[0].TglFaktur);
                        vue_cetak.Jatuh_Tempo       = newdate.setDate(newdate.getDate() + 7);
                    }else{
                        vue_cetak.TOP               = 21;
                        var newdate = new Date(data[0].TglFaktur);
                        vue_cetak.Jatuh_Tempo       = newdate.setDate(newdate.getDate() + 21);
                    }
                    vue_cetak.Status            = data[0].Status;
                    vue_cetak.statusPusat       = data[0].statusPusat;
                    vue_cetak.TipeFaktur        = data[0].TipeFaktur;
                    vue_cetak.Gross             = data[0].Gross;
                    vue_cetak.Value             = data[0].Value;
                    vue_cetak.Potongan          = data[0].Potongan;
                    vue_cetak.Ppn               = data[0].Ppn;
                    vue_cetak.Materai           = data[0].Materai;
                    vue_cetak.OngkosKirim       = data[0].OngkosKirim;
                    vue_cetak.Total             = data[0].Total;
                    vue_cetak.Nama_APJ          = data[0].Nama_APJ;
                    vue_cetak.SIKA_Faktur       = data[0].SIKA_Faktur;
                    vue_cetak.Bank_Acc          = data[0].Bank_Acc;
                    vue_cetak.data_detail       = data;
                    var total_value = Math.round(data[0].Total);
                    document.getElementById("terbilang_value").innerHTML = terbilang(total_value);
                    $("#bcTarget").barcode(vue_cetak.NoFaktur, "code128",{
                        barWidth: 1,
                        barHeight: 30
                    });
                    if(data[0].NoPajak){
                        $('#qcTarget').qrcode({
                            render : "canvas",
                            width: 60,
                            height: 60,
                            text: data[0].NoPajak
                        });
                        var dataUrl = document.querySelector('canvas').toDataURL();
                        $("canvas").hide();
                        $("#qrImage").attr('src',dataUrl);    
                    }
                    
                    setTimeout(function(){
                        // console.log(vue_cetak);
                        // $('canvas').printQr();
                        $('#print_out').print();
                    },1000);
                }else{
                    vue_cetak_cn.TglFaktur         = data[0].TglFaktur;
                    vue_cetak_cn.NoFaktur          = data[0].NoFaktur;
                    vue_cetak_cn.NoPajak           = data[0].NoPajak;;
                    vue_cetak_cn.TipePelanggan     = data[0].TipePelanggan;
                    vue_cetak_cn.TipeDokumen       = data[0].TipeDokumen;
                    vue_cetak_cn.Pelanggan         = data[0].Pelanggan;
                    vue_cetak_cn.NamaPelanggan     = data[0].NamaPelanggan;
                    vue_cetak_cn.AlamatFaktur      = data[0].AlamatFaktur;
                    vue_cetak_cn.Cabang            = data[0].Cabang;
                    vue_cetak_cn.Bank_Acc          = data[0].Bank_Acc;
                    vue_cetak_cn.Acu               = data[0].Acu;
                    vue_cetak_cn.NPWPPelanggan     = data[0].NPWPPelanggan;
                    vue_cetak_cn.TOP               = data[0].TOP;
                    vue_cetak_cn.Status            = data[0].Status;
                    vue_cetak_cn.statusPusat       = data[0].statusPusat;
                    vue_cetak_cn.Potongan          = data[0].Potongan;
                    vue_cetak_cn.Total             = data[0].Total;
                    vue_cetak_cn.data_detail       = data;
                    var total_value = Math.round(data[0].Total);
                    document.getElementById("terbilang_value").innerHTML = terbilang(total_value);
                    $("#bcTarget").barcode(vue_cetak.NoFaktur, "code128",{
                        barWidth: 1,
                        barHeight: 30
                    });
                    if(data[0].NoPajak){
                        $('#qcTarget').qrcode({
                            render : "canvas",
                            width: 60,
                            height: 60,
                            text: data[0].NoPajak
                        });
                        var dataUrl = document.querySelector('canvas').toDataURL();
                        $("canvas").hide();
                        $("#qrImage").attr('src',dataUrl);    
                    }
                    $("canvas").hide();
                    $("#qrImage").attr('src',dataUrl);
                    setTimeout(function(){
                        // $('canvas').printQr();
                        $('#print_out_cn').print();
                    },1000);
                }
                
            },
            error: function (jqXHR, textStatus, errorThrown)
            {
                notif('danger', 'GAGAL! Error get data from ajax');
            }
        });
       
    }

    function updateData()
    {
        $("#notif").empty();
        var url = "{{ base_url }}updateDataFakturPusat"; 
        // ajax adding data to database
        $('#progressGIF').show();
        $.ajax({
            url : url,
            type: "POST",
            dataType: "JSON",
            success: function(data)
            {
                if (data.ket == 'GAGAL') {
                    // notif('danger', 'PERHATIAN! Data Pelanggan & Salesman Harus Sesuai Dengan List.', 'saveResult');
                    notif('warning', 'PERHATIAN! Tidak dapat terhubung dengan server pusat');
                }
                // else if (data.ket == 'CEK') {
                //     notif('warning', 'PERHATIAN! Periksa kembali, masih ada data usulan belum di proses ke pusat');   
                // }
                else{
                    notif('success', 'SUKSES! Data berhasil diupdate dari server pusat');
                }
                reloadTable();
                $('#progressGIF').hide();
            },
            error: function (jqXHR, textStatus, errorThrown)
            {
                notif('warning', 'PERHATIAN! Tidak dapat terhubung dengan server pusat');
                $('#progressGIF').hide();
            }
        });
    }

    function buatInkaso()
    { 
        $('#progressGIF').show();
        var txt = "";
        var url = "{{ base_url }}buatInkaso"; 
            // ajax adding data to database
            $.ajax({
                url : url,
                type: "POST",
                data: $('#myForm').serialize(),
                dataType: "JSON",
                success: function(data)
                {
                    if (data.status == false) {
                        notif('warning', "PERHATIAN! Belum ada data yang dipilih.");
                    }
                    else{
                        notif('success', 'SUKSES! Data berhasil diupload ke server pusat');
                    }
                    reloadTable();  
                    $('#progressGIF').hide();
                },
                error: function (jqXHR, textStatus, errorThrown)
                {
                    reloadTable();  
                    $('#progressGIF').hide();
                }
            });
    }

    function cetaklist(kertas){
        $("#notif").empty();
        $("#print_out").empty();
        var nofaktur=[];
        var waktu = 0;
        $(".ceklis:checked").each(function () {
            // nofaktur.push($(this).val());
            nofaktur.push({
                "nofaktur" : $(this).val(),
                "TipeDokumen" : $(this).attr("dokumen")
            });
        });
        if(nofaktur.length == 0){
            notif('warning', 'Data belum dipilih');
            return;
        }
        $('#progressGIF').show();
        var f = 0;
        for (var i = 0; i < nofaktur.length; i++) {
            waktu = waktu + 2000;
        // console.log(nofaktur[i].nofaktur);
            $.ajax({
                url : "{{ base_url }}printdataFaktur",
                type: "POST",
                data:{no:nofaktur[i].nofaktur,TipeDokumen:nofaktur[i].TipeDokumen},
                dataType: "JSON",
                success: function(data)
                {
                    // console.log(data);
                    data2 = JSON.stringify(data);
                    if(data[0].TipeDokumen == 'Faktur' || data[0].TipeDokumen =='Retur'){
                        $("#print_out").append($("<div>").load("{{base_url}}assets/print_template/"+kertas+".php", {var1:data2}, function(){
                            f = f+1;
                            // console.log("================================");
                            // console.log(f);
                            // console.log(nofaktur.length);
                            // console.log('load finish '+f);
                            if(f == nofaktur.length){
                                $('#progressGIF').hide();
                                $('#print_out').print();
                                // $.print("#print_out");
                                // $('#print_out').printThis();
                            }
                        }));
                    }else{
                        $("#print_out").append($("<div>").load("{{base_url}}assets/print_template/cetak_cn.php", {var1:data},function(){
                                f = f+1; 
                                if(f == nofaktur.length){
                                    $('#progressGIF').hide();
                                    $('#print_out') .print();
                                }
                        }));
                    }
                },
                error: function (jqXHR, textStatus, errorThrown)
                {
                    notif('danger', 'GAGAL! Error get data from ajax');
                }
            });
        }
        // $('#print_out').ready(function() {
        //     $('#print_out').print();
        // });
        // setTimeout(function(){
            // $('#print_out').print();
        // },waktu);
    }

    function cetaklist2(kertas){
        $("#notif").empty();
        $("#print_out").empty();
        var nofaktur=[];
        var waktu = 0;
        $(".ceklis:checked").each(function () {
            // nofaktur.push($(this).val());
            nofaktur.push({
                "nofaktur" : $(this).val(),
                "TipeDokumen" : $(this).attr("dokumen")
            });
        });
        if(nofaktur.length == 0){
            notif('warning', 'Data belum dipilih');
            return;
        }
        $('#progressGIF').show();
        var f = 0;
        for (var i = 0; i < nofaktur.length; i++) {
            waktu = waktu + 2000;
        // console.log(nofaktur[i].nofaktur);
            $.ajax({
                url : "{{ base_url }}printdataFaktur",
                type: "POST",
                data:{no:nofaktur[i].nofaktur,TipeDokumen:nofaktur[i].TipeDokumen},
                dataType: "JSON",
                success: function(data)
                {
                    console.log(data);
                    data2 = JSON.stringify(data);
                    if(data[0].TipeDokumen == 'Faktur' || data[0].TipeDokumen =='Retur'){
                        $("#print_out").append($("<div>").load("{{base_url}}assets/print_template/"+kertas+".php", {var1:data2}, function(){
                            $('#progressGIF').hide()
                            $('#print_out').print();
                        }));
                    }else{
                        $("#print_out").append($("<div>").load("{{base_url}}assets/print_template/cetak_cn.php", {var1:data},function(){
                                f = f+1; 
                                if(f == nofaktur.length){
                                    $('#progressGIF').hide();
                                    $('#print_out') .print();
                                }
                        }));
                    }
                },
                error: function (jqXHR, textStatus, errorThrown)
                {
                    notif('danger', 'GAGAL! Error get data from ajax');
                }
            });
        }
    }

    function cetak_preprinted(){
        var nodo=[];
        var jumlah = $('input[name="list[]"]:checked').length;
        for (var i = 0; i < jumlah.length; i++) {
            nodo.push($('input[name="list"]:checked').val())
        }
        $(".ceklis:checked").each(function () {
            nodo.push($(this).val());
        });
        if(nodo.length == 0){
            notif('warning', 'Data belum dipilih');
            return;
        }
        x = nodo[0].substring(4, 5);
        // console.log(x);
        switch(x) {
          case '1':
            var tipe_dok = 'Faktur';
            break;
          case '2':
            var tipe_dok = 'Retur';
            break;
          default:
            var tipe_dok = 'CNDN';
        }

        var url_safe_nodo = encodeURIComponent(nodo);
        window.open('{{ base_url }}print_faktur_penjualan?nofaktur='+url_safe_nodo+'&'+'TipeDokumen='+tipe_dok);
    }

    function printDiv(divID) {
        //Get the HTML of div
        var divElements = document.getElementById(divID).outerHTML;
        //Get the HTML of whole page
        var oldPage = document.body.outerHTML;

        //Reset the page's HTML with div's HTML only
        document.body.innerHTML = 
          "<html><head><title></title></head><body>" + 
          divElements + "</body>";

        //Print Page
        window.print();

        //Restore orignal HTML
        document.body.innerHTML = oldPage;

      
    }

    function cetak_ulang(e){
        e.preventDefault();
        $.print("#print_out");
        // printDiv('print_out');
    }

     function terbilang(total_value){
        var bilangan = total_value.toString();
        var kalimat ="";
        var angka   = new Array('0','0','0','0','0','0','0','0','0','0','0','0','0','0','0','0');
        var kata    = new Array('','Satu','Dua','Tiga','Empat','Lima','Enam','Tujuh','Delapan','Sembilan');
        var tingkat = new Array('','Ribu','Juta','Milyar','Triliun');
        var panjang_bilangan = bilangan.length;
        /* pengujian panjang bilangan */
        if(panjang_bilangan > 15){
            kalimat = "Diluar Batas";
        }else{
            /* mengambil angka-angka yang ada dalam bilangan, dimasukkan ke dalam array */
            for(i = 1; i <= panjang_bilangan; i++) {
                angka[i] = bilangan.substr(-(i),1);
            }
             
            var i = 1;
            var j = 0;
             
            /* mulai proses iterasi terhadap array angka */
            while(i <= panjang_bilangan){
                subkalimat = "";
                kata1 = "";
                kata2 = "";
                kata3 = "";
                 
                /* untuk Ratusan */
                if(angka[i+2] != "0"){
                    if(angka[i+2] == "1"){
                        kata1 = "Seratus";
                    }else{
                        kata1 = kata[angka[i+2]] + " Ratus";
                    }
                }
                 
                /* untuk Puluhan atau Belasan */
                if(angka[i+1] != "0"){
                    if(angka[i+1] == "1"){
                        if(angka[i] == "0"){
                            kata2 = "Sepuluh";
                        }else if(angka[i] == "1"){
                            kata2 = "Sebelas";
                        }else{
                            kata2 = kata[angka[i]] + " Belas";
                        }
                    }else{
                        kata2 = kata[angka[i+1]] + " Puluh";
                    }
                }
                 
                /* untuk Satuan */
                if (angka[i] != "0"){
                    if (angka[i+1] != "1"){
                        kata3 = kata[angka[i]];
                    }
                }
                 
                /* pengujian angka apakah tidak nol semua, lalu ditambahkan tingkat */
                if ((angka[i] != "0") || (angka[i+1] != "0") || (angka[i+2] != "0")){
                    subkalimat = kata1+" "+kata2+" "+kata3+" "+tingkat[j]+" ";
                }
                 
                /* gabungkan variabe sub kalimat (untuk Satu blok 3 angka) ke variabel kalimat */
                kalimat = subkalimat + kalimat;
                i = i + 3;
                j = j + 1;
            }
             
            /* mengganti Satu Ribu jadi Seribu jika diperlukan */
            if ((angka[5] == "0") && (angka[6] == "0")){
                kalimat = kalimat.replace("Satu Ribu","Seribu");
            }
        }
        return kalimat;
    }

    function f_tanggal(tgl){
        var hari = ['Minggu', 'Senin', 'Selasa', 'Rabu', 'Kamis', 'Jumat', 'Sabtu'];
        var bulan = ['Januari', 'Februari', 'Maret','April','Mei','Juni','Juli','Agustus','September','Oktober','November','Desember'];

        var tanggal = new Date(tgl).getDate();
        var xhari = new Date(tgl).getDay();
        var xbulan = new Date(tgl).getMonth();
        var xtahun = new Date(tgl).getYear();
        var hari = hari[xhari];
        var bulan = bulan[xbulan];
        var tahun = (xtahun < 1000)?xtahun + 1900 : xtahun;

        // console.log(hari +', ' + tanggal + ' ' + bulan + ' ' + tahun);
        // return hari +', ' + tanggal + ' ' + bulan + ' ' + tahun;
        return tanggal + ' ' + bulan + ' ' + tahun;
    }

    function export_all(e){
        e.preventDefault();
            var url = "{{ base_url }}listfakturexcel";
        $.ajax({
            url : url,
            type: "POST",
            dataType: "JSON",
            success: function(data) 
            {
                console.log(data);
                const xls = new xlsExport(data, title);
                xls.exportToXLS('export.xls');

                // $("#dvjson").excelexportjs({
                //   containerid: "dvjson",
                //   datatype: 'json', 
                //   dataset: data, 
                //   columns: getColumns(data)     
                // });
            },
            error: function (jqXHR, textStatus, errorThrown)
            {
                notif('warning', 'PERHATIAN! Error Export');
                $('#progressGIF').hide();
            }
        });
    }
</script>
    {% endblock %}