<?php defined('BASEPATH') OR exit('No direct script access allowed'); ?>

ERROR - 2020-12-23 08:02:24 --> Severity: Warning --> session_destroy(): Trying to destroy uninitialized session D:\xampp70\htdocs\sstcabang\application\controllers\Auth.php 74
ERROR - 2020-12-23 08:07:50 --> Cabang
ERROR - 2020-12-23 08:08:18 --> 404 Page Not Found: /index
ERROR - 2020-12-23 08:41:16 --> 404 Page Not Found: /index
ERROR - 2020-12-23 08:41:16 --> 404 Page Not Found: /index
ERROR - 2020-12-23 08:44:49 --> Severity: Warning --> session_destroy(): Trying to destroy uninitialized session D:\xampp70\htdocs\sstcabang\application\controllers\Auth.php 74
ERROR - 2020-12-23 08:45:27 --> 404 Page Not Found: /index
ERROR - 2020-12-23 08:45:31 --> 404 Page Not Found: /index
ERROR - 2020-12-23 09:15:59 --> 404 Page Not Found: /index
ERROR - 2020-12-23 09:16:01 --> 404 Page Not Found: /index
ERROR - 2020-12-23 09:19:24 --> 404 Page Not Found: /index
ERROR - 2020-12-23 09:19:24 --> 404 Page Not Found: /index
ERROR - 2020-12-23 09:30:54 --> Severity: error --> Exception: syntax error, unexpected 'if' (T_IF) D:\xampp70\htdocs\sstcabang\application\controllers\pembelian\Usulanreturbeli.php 856
ERROR - 2020-12-23 09:32:38 --> 404 Page Not Found: /index
ERROR - 2020-12-23 09:32:54 --> 404 Page Not Found: /index
ERROR - 2020-12-23 09:34:00 --> 404 Page Not Found: /index
ERROR - 2020-12-23 09:38:12 --> 404 Page Not Found: /index
ERROR - 2020-12-23 09:38:13 --> 404 Page Not Found: /index
ERROR - 2020-12-23 09:38:17 --> 404 Page Not Found: /index
ERROR - 2020-12-23 09:38:22 --> 404 Page Not Found: /index
ERROR - 2020-12-23 09:38:25 --> 404 Page Not Found: /index
ERROR - 2020-12-23 09:38:33 --> 404 Page Not Found: /index
ERROR - 2020-12-23 09:38:36 --> 404 Page Not Found: /index
ERROR - 2020-12-23 09:38:39 --> 404 Page Not Found: /index
ERROR - 2020-12-23 09:38:41 --> 404 Page Not Found: /index
ERROR - 2020-12-23 09:38:54 --> 404 Page Not Found: /index
ERROR - 2020-12-23 09:38:57 --> 404 Page Not Found: /index
ERROR - 2020-12-23 09:39:58 --> 404 Page Not Found: /index
ERROR - 2020-12-23 09:40:06 --> 404 Page Not Found: /index
ERROR - 2020-12-23 09:42:40 --> 404 Page Not Found: /index
ERROR - 2020-12-23 09:42:45 --> 404 Page Not Found: /index
ERROR - 2020-12-23 09:43:55 --> 404 Page Not Found: /index
ERROR - 2020-12-23 09:44:07 --> 404 Page Not Found: /index
ERROR - 2020-12-23 09:44:22 --> 404 Page Not Found: /index
ERROR - 2020-12-23 09:44:39 --> 404 Page Not Found: /index
ERROR - 2020-12-23 09:44:41 --> 404 Page Not Found: /index
ERROR - 2020-12-23 09:45:05 --> 404 Page Not Found: /index
ERROR - 2020-12-23 09:45:07 --> 404 Page Not Found: /index
ERROR - 2020-12-23 09:48:05 --> 404 Page Not Found: /index
ERROR - 2020-12-23 09:48:06 --> 404 Page Not Found: /index
ERROR - 2020-12-23 09:48:28 --> 404 Page Not Found: /index
ERROR - 2020-12-23 09:48:28 --> 404 Page Not Found: /index
ERROR - 2020-12-23 09:48:39 --> 404 Page Not Found: /index
ERROR - 2020-12-23 09:48:39 --> 404 Page Not Found: /index
ERROR - 2020-12-23 09:48:41 --> 404 Page Not Found: /index
ERROR - 2020-12-23 09:48:41 --> 404 Page Not Found: /index
ERROR - 2020-12-23 11:33:40 --> Query error: You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near '10:20:41
WHERE `No_Usulan` = 'RTR-N/MTM/51/221220/1000218'
AND `Produk` = 'AP480' at line 1 - Invalid query: UPDATE `trs_usulan_retur_beli_detail` SET App_Pst_Status = R, App_Pst_Time = 2020-12-23 10:20:41
WHERE `No_Usulan` = 'RTR-N/MTM/51/221220/1000218'
AND `Produk` = 'AP48002'
AND `BatchNo` = '180903'
AND `noline` = '1'
ERROR - 2020-12-23 11:36:23 --> Query error: You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near '10:20:41
WHERE `No_Usulan` = 'RTR-N/MTM/51/221220/1000218'
AND `Produk` = 'AP480' at line 1 - Invalid query: UPDATE `trs_usulan_retur_beli_detail` SET App_Pst_Status = R, App_Pst_Time = 2020-12-23 10:20:41
WHERE `No_Usulan` = 'RTR-N/MTM/51/221220/1000218'
AND `Produk` = 'AP48002'
AND `BatchNo` = '180903'
AND `noline` = '1'
ERROR - 2020-12-23 11:37:52 --> Query error: Unknown column 'R' in 'field list' - Invalid query: UPDATE `trs_usulan_retur_beli_detail` SET App_Pst_Status = R
WHERE `No_Usulan` = 'RTR-N/MTM/51/221220/1000218'
AND `Produk` = 'AP48002'
AND `BatchNo` = '180903'
AND `noline` = '1'
ERROR - 2020-12-23 12:52:51 --> Cabang
ERROR - 2020-12-23 12:53:48 --> Severity: error --> Exception: syntax error, unexpected '}' D:\xampp70\htdocs\sstcabang\application\models\pembelian\Model_retur_beli.php 1294
ERROR - 2020-12-23 12:58:10 --> Severity: error --> Exception: syntax error, unexpected '}' D:\xampp70\htdocs\sstcabang\application\models\pembelian\Model_retur_beli.php 1294
ERROR - 2020-12-23 13:05:17 --> Cabang
ERROR - 2020-12-23 13:05:59 --> Query error: You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'App_Pst_Status = "Reject", 
                            App_Pst_Time = "2020-12' at line 1 - Invalid query: update trs_usulan_retur_beli_header set Status_Usulan = "Close" App_Pst_Status = "Reject", 
                            App_Pst_Time = "2020-12-23 13:05:59" where  No_Usulan = "RTR-N/MTM/51/221220/1000218"
ERROR - 2020-12-23 13:06:16 --> Cabang
ERROR - 2020-12-23 13:06:42 --> Query error: You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'App_Pst_Status = "Reject", 
                            App_Pst_Time = "2020-12' at line 1 - Invalid query: update trs_usulan_retur_beli_header set Status_Usulan = "Close" App_Pst_Status = "Reject", 
                            App_Pst_Time = "2020-12-23 13:06:42" where  No_Usulan = "RTR-N/MTM/51/221220/1000218"
ERROR - 2020-12-23 13:06:58 --> Cabang
ERROR - 2020-12-23 13:07:33 --> Cabang
ERROR - 2020-12-23 13:07:42 --> Cabang
ERROR - 2020-12-23 13:07:46 --> Cabang
ERROR - 2020-12-23 13:07:52 --> Cabang
ERROR - 2020-12-23 13:07:59 --> Cabang
ERROR - 2020-12-23 13:08:14 --> Cabang
ERROR - 2020-12-23 13:20:19 --> Query error: You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'App_Pst_Status = "Reject", 
                            App_Pst_Time = "2020-12' at line 1 - Invalid query: update trs_usulan_retur_beli_header set Status_Usulan = "Close" App_Pst_Status = "Reject", 
                            App_Pst_Time = "2020-12-23 13:20:19" where  No_Usulan = "RTR-N/MTM/51/221220/1000218"
ERROR - 2020-12-23 13:21:45 --> Query error: You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near 'App_Pst_Status = "Reject", 
                            App_Pst_Time = "2020-12' at line 1 - Invalid query: update trs_usulan_retur_beli_header set Status_Usulan = "Close" App_Pst_Status = "Reject", 
                            App_Pst_Time = "2020-12-23 13:21:45" where  No_Usulan = "RTR-N/MTM/51/221220/1000218"
ERROR - 2020-12-23 13:23:28 --> Cabang
ERROR - 2020-12-23 13:27:13 --> Cabang
ERROR - 2020-12-23 13:27:37 --> Cabang
ERROR - 2020-12-23 13:29:29 --> 404 Page Not Found: /index
ERROR - 2020-12-23 13:29:44 --> Cabang
ERROR - 2020-12-23 13:44:11 --> Cabang
ERROR - 2020-12-23 13:44:28 --> Cabang
ERROR - 2020-12-23 13:44:46 --> Cabang
ERROR - 2020-12-23 13:46:25 --> Cabang
ERROR - 2020-12-23 13:47:20 --> Cabang
ERROR - 2020-12-23 13:47:43 --> Cabang
ERROR - 2020-12-23 13:47:57 --> Cabang
ERROR - 2020-12-23 13:49:04 --> Cabang
ERROR - 2020-12-23 14:14:31 --> 404 Page Not Found: /index
ERROR - 2020-12-23 14:27:00 --> 404 Page Not Found: /index
ERROR - 2020-12-23 14:27:14 --> Severity: Warning --> session_destroy(): Trying to destroy uninitialized session D:\xampp70\htdocs\sstcabang\application\controllers\Auth.php 74
ERROR - 2020-12-23 14:27:19 --> 404 Page Not Found: /index
ERROR - 2020-12-23 14:27:51 --> 404 Page Not Found: /index
ERROR - 2020-12-23 14:27:52 --> 404 Page Not Found: /index
ERROR - 2020-12-23 14:27:57 --> 404 Page Not Found: /index
ERROR - 2020-12-23 14:27:57 --> 404 Page Not Found: /index
ERROR - 2020-12-23 14:28:03 --> Query error: Unknown column 'App_Pst_Status' in 'field list' - Invalid query: INSERT INTO `trs_usulan_retur_beli_detail` (`Cabang`, `No_Usulan`, `noline`, `Kategori`, `Produk`, `Nama_Produk`, `Satuan`, `Keterangan`, `Qty`, `Bonus`, `BatchNo`, `BatchDoc`, `Qty_Rec`, `ExpDate`, `Harga_Deal`, `Disc`, `Disc_Cab`, `Harga_Beli_Cab`, `Value_Usulan`, `UnitCOGS`, `TotalCOGS`, `HPC`, `HPC1`, `Gross`, `Potongan`, `Value`, `PPN`, `Total`, `Disc_Pst`, `Harga_Beli_Pst`, `HPP`, `UserAdd`, `TimeAdd`, `UserEdit`, `TimeEdit`, `sisa_qty`, `GudangPusat`, `tanggal`, `time_retur`, `Status_Usulan`, `TipeRetur_2`, `App_Pst_Status`, `App_Pst_Time`) VALUES ('Mataram', 'RTR-N/MTM/18/231220/1000219', '1', NULL, 'SLRDS1', 'REDUSEC KAPSUL', 'BOX', '', '-1', '0', 'KRW 3', 'BPB/MTM/18/101220/1001394', '101', '2023-11-01', '14625', '0.0', '0.0', '14625', '-14625', '14625', '14625', NULL, '0', '-14625', '0', '-14625', '-1463', '-16088', '0', '13900', '13900', 'cabang', '2020-12-23 14:26:43', NULL, NULL, '-1', NULL, '2020-12-23', '2020-12-23 14:26:43', 'Open', 'Retur Admin', NULL, NULL)
ERROR - 2020-12-23 14:29:14 --> Query error: Unknown column 'trs_usulan_retur_beli_header.App_Pst_Status' in 'where clause' - Invalid query: SELECT NoDokumen AS 'NoDoc',
                                          CONCAT('Terima dari ',Prinsipal,' - ',Supplier) AS 'Dokumen',
                                          TglDokumen AS 'TglDoc',
                                          TimeDokumen as 'TimeDoc',
                                          Produk AS 'Kode',
                                          NamaProduk AS 'NamaProduk',
                                          Satuan AS 'Unit',
                                          (ifnull(Qty,'') + ifnull(Bonus,'')) AS 'qty_in',
                                          0 AS 'qty_out',
                                          BatchNo,
                                          ExpDate
                                  FROM trs_terima_barang_detail
                                  WHERE trs_terima_barang_detail.Produk = 'SLRDS1' and 
                                        Status not in ('pending','Batal') and
                                        ifnull(Tipe,'') not in  ('BKB','Tolakan') and
                                        TglDokumen between '2020-12-01 00:00:00' and '2020-12-23 23:59:59'
                                  
                                  UNION ALL

                                  SELECT NoDokumen AS 'NoDoc',
                                          CONCAT('Retur Ke ',Prinsipal,' - ',Supplier) AS 'Dokumen',
                                          TglDokumen AS 'TglDoc',
                                          TimeDokumen as 'TimeDoc',
                                          Produk AS 'Kode',
                                          NamaProduk AS 'NamaProduk',
                                          Satuan AS 'Unit',
                                          0 AS 'qty_in',
                                          (((ifnull(Qty,'') + ifnull(Bonus,'')))*-1) AS 'qty_out',
                                          BatchNo,
                                          ExpDate
                                  FROM trs_terima_barang_detail
                                  where   ifnull(Tipe,'') = 'BKB' and Produk = 'SLRDS1' and 
                                        TglDokumen between '2020-12-01 00:00:00' and '2020-12-23 23:59:59'
                                  
                                  UNION ALL
                                  SELECT NoDokumen AS 'NoDoc',
                                          CONCAT('Tolakan Retur ',Prinsipal,' - ',Supplier,' ~ Qty : ', (ifnull(Qty,'') + ifnull(Bonus,''))*-1) AS 'Dokumen',
                                          TglDokumen AS 'TglDoc',
                                          TimeDokumen as 'TimeDoc',
                                          Produk AS 'Kode',
                                          NamaProduk AS 'NamaProduk',
                                          Satuan AS 'Unit',
                                          0 AS 'qty_in',
                                          0 AS 'qty_out',
                                          BatchNo,
                                          ExpDate
                                  FROM trs_terima_barang_detail
                                  where   ifnull(Tipe,'') = 'Tolakan' and Produk = 'SLRDS1' and 
                                        TglDokumen between '2020-12-01 00:00:00' and '2020-12-23 23:59:59'

                                  UNION ALL
                                  SELECT no_koreksi AS 'NoDoc', 
                                         CONCAT('Usulan Adjusment (+) : ', catatan) AS 'Dokumen',
                                         tanggal AS 'TglDoc',
                                         trs_mutasi_koreksi.created_at as 'TimeDoc',
                                         trs_mutasi_koreksi.produk AS 'Kode' ,
                                         trs_mutasi_koreksi.nama_produk AS 'NamaProduk' ,
                                         Satuan AS 'Unit',
                                         qty AS 'qty_in',
                                         0 AS 'qty_out',
                                         batch AS 'BatchNo',
                                         exp_date AS 'ExpDate'
                                  FROM  trs_mutasi_koreksi INNER JOIN mst_produk ON mst_produk.`Kode_Produk` = trs_mutasi_koreksi.`produk`
                                  WHERE   qty > 0 AND trs_mutasi_koreksi.status IN ('Open','Approve') and
                                    trs_mutasi_koreksi.`produk` = 'SLRDS1' and 
                                        CASE WHEN trs_mutasi_koreksi.`Status` = 'Open' THEN
                                          tanggal
                                       ELSE
                                          IFNULL(DATE(tgl_approve),tanggal)
                                       END between '2020-12-01 00:00:00' and '2020-12-23 23:59:59'
                                  UNION ALL
                                  SELECT NoDokumen AS 'NoDoc', 
                                         CONCAT('Mutasi Gudang dari Gudang : ', gudang_awal,' Ke Gudang : ',gudang_akhir,' ~ QTY = ',qty) AS 'Dokumen',
                                         tanggal AS 'TglDoc',
                                         trs_mutasi_gudang.create_date as 'TimeDoc',
                                         trs_mutasi_gudang.produk AS 'Kode' ,
                                         trs_mutasi_gudang.namaproduk AS 'NamaProduk' ,
                                         '' AS 'Unit',
                                         0 AS 'qty_in',
                                         0 AS 'qty_out',
                                         batchno_awal AS 'BatchNo',
                                         expdate_awal AS 'ExpDate'
                                  FROM  trs_mutasi_gudang INNER JOIN mst_produk ON mst_produk.`Kode_Produk` = trs_mutasi_gudang.`produk`
                                  WHERE   qty > 0 AND trs_mutasi_gudang.status IN ('Open','Approve') and
                                    trs_mutasi_gudang.`produk` = 'SLRDS1' and 
                                        tanggal between '2020-12-01 00:00:00' and '2020-12-23 23:59:59'
                                  UNION ALL

                                  SELECT no_koreksi AS 'NoDoc', 
                                         CONCAT('Adjusment (+) : QTY = ',qty,' ', catatan) AS 'Dokumen',
                                         IFNULL(DATE(tgl_approve),tanggal) AS 'TglDoc',
                                         trs_mutasi_koreksi.created_at as 'TimeDoc',
                                         trs_mutasi_koreksi.produk AS 'Kode' ,
                                         trs_mutasi_koreksi.nama_produk AS 'NamaProduk' ,
                                         Satuan AS 'Unit',
                                         0 AS 'qty_in',
                                         0 AS 'qty_out',
                                         batch AS 'BatchNo',
                                         exp_date AS 'ExpDate'
                                  FROM  trs_mutasi_koreksi INNER JOIN mst_produk ON mst_produk.`Kode_Produk` = trs_mutasi_koreksi.`produk`
                                  WHERE   qty > 0 AND trs_mutasi_koreksi.status = 'Approve' and
                                    trs_mutasi_koreksi.`produk` = 'SLRDS1' and 
                                        IFNULL(DATE(tgl_approve),tanggal) between '2020-12-01 00:00:00' and '2020-12-23 23:59:59'
                                  UNION ALL

                                  SELECT No_Terima AS 'NoDoc', 
                                         CONCAT('Relokasi Dari Cabang  : ', Cabang_Pengirim) AS 'Dokumen',
                                         Tgl_terima AS 'TglDoc',
                                         Time_terima as 'TimeDoc',
                                         Produk AS 'Kode' ,
                                         NamaProduk AS 'NamaProduk' ,
                                         Satuan AS 'Unit',
                                         (Qty+Bonus) AS 'qty_in',
                                         0 AS 'qty_out',
                                         BatchNo AS 'BatchNo',
                                         ExpDate AS 'ExpDate'
                                  FROM  trs_relokasi_terima_detail 
                                  WHERE   (Qty > 0 or Bonus > 0) AND
                                        Status = 'Terima' and
                                        Produk = 'SLRDS1' and 
                                        Tgl_terima between '2020-12-01 00:00:00' and '2020-12-23 23:59:59'
                                    
                                  UNION ALL 

                                  SELECT NoFaktur AS 'NoDoc',
                                        CONCAT('Terima dari ',Pelanggan, ' - ' ,NamaPelanggan) AS 'Dokumen',
                                        TglFaktur AS 'TglDoc',
                                        TimeFaktur as 'TimeDoc',
                                        KodeProduk AS 'Kode', 
                                        NamaProduk AS 'NamaProduk',
                                        UOM AS 'Unit',
                                        (QtyFaktur+BonusFaktur) AS 'qty_in',
                                        0 AS 'qty_out',
                                        BatchNo,
                                        ExpDate
                                  FROM trs_faktur_detail 
                                  WHERE TipeDokumen ='Retur' AND 
                                        ifnull(status,'') != 'Batal' and
                                        KodeProduk = 'SLRDS1' and 
                                        TglFaktur between '2020-12-01 00:00:00' and '2020-12-23 23:59:59'

                                  UNION ALL


                                  SELECT NoDO AS 'NoDoc',
                                    CONCAT('Kirim ke ',Pelanggan, ' - ' ,NamaPelanggan) AS 'Dokumen',  
                                    TglDO AS 'TglDoc',
                                    TimeDO AS 'TimeDoc',
                                    KodeProduk AS 'Kode',
                                    NamaProduk AS 'NamaProduk',
                                    UOM AS 'Unit',
                                    0 AS 'qty_in', 
                                    (QtyDO+BonusDO) AS 'qty_out',
                                    BatchNo,ExpDate
                                  FROM trs_delivery_order_sales_detail 
                                  WHERE KodeProduk = 'SLRDS1'  
                                    AND TglDO BETWEEN '2020-12-01 00:00:00' and '2020-12-23 23:59:59' and tipedokumen ='DO'
                                  UNION ALL
                                  SELECT NoDO AS 'NoDoc',
                                    CONCAT('Batal Kirim ke ',Pelanggan, ' - ' ,NamaPelanggan) AS 'Dokumen',  
                                    TglDO AS 'TglDoc',
                                    TimeDO AS 'TimeDoc',
                                    KodeProduk AS 'Kode',
                                    NamaProduk AS 'NamaProduk',
                                    UOM AS 'Unit',
                                    (QtyDO+BonusDO) AS 'qty_in', 
                                    0 AS 'qty_out',
                                    BatchNo,ExpDate
                                  FROM trs_delivery_order_sales_detail 
                                  WHERE KodeProduk = 'SLRDS1' 
                                    AND Status = 'Batal' 
                                    AND date(ifnull(time_batal,'')) BETWEEN '2020-12-01 00:00:00' and '2020-12-23 23:59:59'
                                  UNION ALL
                                  SELECT NoDO AS 'NoDoc',
                                    CONCAT('Retur Kirim dari ',Pelanggan, ' - ' ,NamaPelanggan) AS 'Dokumen',  
                                    TglDO AS 'TglDoc',
                                    TimeDO AS 'TimeDoc',
                                    KodeProduk AS 'Kode',
                                    NamaProduk AS 'NamaProduk',
                                    UOM AS 'Unit',
                                    (QtyDO+BonusDO) AS 'qty_in', 
                                    0 AS 'qty_out',
                                    BatchNo,ExpDate
                                  FROM trs_delivery_order_sales_detail 
                                  WHERE KodeProduk = 'SLRDS1' and 
                                        TipeDokumen ='Retur' and Status = 'Retur' 
                                    AND TglDO BETWEEN '2020-12-01 00:00:00' and '2020-12-23 23:59:59'
                                  UNION ALL

                                  SELECT trs_relokasi_kirim_detail.No_Relokasi AS 'NoDoc', 
                                        CASE WHEN Status = 'ApproveLog' THEN
                                         CONCAT('Relokasi ke Cabang  : ', trs_relokasi_kirim_detail.Cabang_Penerima)
                                        ELSE
                                          CONCAT('Relokasi ke Cabang  : ', trs_relokasi_kirim_detail.Cabang_Penerima)
                                        END
                                         AS 'Dokumen',
                                         CASE WHEN tgl_app IS NULL THEN trs_relokasi_kirim_detail.Tgl_kirim ELSE trs_relokasi_kirim_detail.tgl_app END AS 'TglDoc',
                                         CASE WHEN tgl_app IS NULL THEN trs_relokasi_kirim_detail.Time_kirim ELSE trs_relokasi_kirim_detail.App_BM_Time END  'TimeDoc',
                                         Produk AS 'Kode' ,
                                         NamaProduk AS 'NamaProduk' ,
                                         Satuan AS 'Unit',
                                         0 AS 'qty_in',
                                         CASE WHEN Status = 'ApproveLog' THEN
                                         0
                                         ELSE
                                         (Qty+Bonus)
                                         END AS 'qty_out',
                                         BatchNo AS 'BatchNo',
                                         ExpDate AS 'ExpDate'
                                  FROM  trs_relokasi_kirim_detail
                                  WHERE trs_relokasi_kirim_detail.Status IN ('Kirim','Reject','RejectPusat','RejectCabPenerima','ApproveLog') and
                                        trs_relokasi_kirim_detail.Produk = 'SLRDS1' and 
                                          CASE WHEN tgl_app IS NULL THEN trs_relokasi_kirim_detail.Tgl_kirim ELSE trs_relokasi_kirim_detail.tgl_app END
                                         between '2020-12-01 00:00:00' and '2020-12-23 23:59:59' 

                                  UNION ALL

                                  SELECT trs_relokasi_kirim_detail.No_Relokasi AS 'NoDoc', 
                                         CASE WHEN Keterangan_reject LIKE '%Penerima%' THEN
                                          'Relokasi Reject Cabang Penerima'
                                         ELSE 
                                           'Relokasi Reject Pusat'
                                         END AS 'Dokumen',
                                         trs_relokasi_kirim_detail.tgl_reject AS 'TglDoc',
                                         trs_relokasi_kirim_detail.Time_kirim 'TimeDoc',
                                         Produk AS 'Kode' ,
                                         NamaProduk AS 'NamaProduk' ,
                                         Satuan AS 'Unit',
                                         (Qty+Bonus) AS 'qty_in',
                                         0 AS 'qty_out',
                                         BatchNo AS 'BatchNo',
                                         ExpDate AS 'ExpDate'
                                  FROM  trs_relokasi_kirim_detail
                                  WHERE trs_relokasi_kirim_detail.Status = 'Reject' and
                                        trs_relokasi_kirim_detail.Produk = 'SLRDS1' and 
                                        trs_relokasi_kirim_detail.Tgl_reject between '2020-12-01 00:00:00' and '2020-12-23 23:59:59'

                                  UNION ALL

                                  SELECT trs_usulan_retur_beli_header.No_Usulan AS 'NoDoc', 
                                        CONCAT('Usulan Retur Beli : QTY = ',((trs_usulan_retur_beli_detail.Qty+trs_usulan_retur_beli_detail.Bonus) * -1),'  ~ Ke : ',trs_usulan_retur_beli_header.Prinsipal) AS 'Dokumen',
                                        trs_usulan_retur_beli_header.Tanggal AS 'TglDoc',
                                        trs_usulan_retur_beli_header.added_time as 'TimeDoc',
                                        trs_usulan_retur_beli_detail.Produk AS 'Kode' ,
                                        trs_usulan_retur_beli_detail.Nama_produk AS 'NamaProduk' ,
                                        trs_usulan_retur_beli_detail.Satuan AS 'Unit',
                                        0 AS 'qty_in',
                                        0 AS 'qty_out',
                                        trs_usulan_retur_beli_detail.BatchNo AS 'BatchNo',
                                        trs_usulan_retur_beli_detail.ExpDate AS 'ExpDate'
                                  FROM  trs_usulan_retur_beli_header INNER JOIN trs_usulan_retur_beli_detail ON trs_usulan_retur_beli_header.No_Usulan = trs_usulan_retur_beli_detail.No_Usulan 
                                  WHERE ifnull(trs_usulan_retur_beli_header.App_BM_Status,'') <> 'R' and
                                    trs_usulan_retur_beli_detail.Produk = 'SLRDS1'and 
                                        trs_usulan_retur_beli_header.tanggal between '2020-12-01 00:00:00' and '2020-12-23 23:59:59'

                                  UNION ALL

                                  SELECT trs_usulan_retur_beli_header.No_Usulan AS 'NoDoc', 
                                        CONCAT('Reject Usulan Beli Pusat : QTY = ',((trs_usulan_retur_beli_detail.Qty+trs_usulan_retur_beli_detail.Bonus) * -1),'  ~ Ke : ',trs_usulan_retur_beli_header.Prinsipal) AS 'Dokumen',
                                        trs_usulan_retur_beli_header.Tanggal AS 'TglDoc',
                                        trs_usulan_retur_beli_header.added_time as 'TimeDoc',
                                        trs_usulan_retur_beli_detail.Produk AS 'Kode' ,
                                        trs_usulan_retur_beli_detail.Nama_produk AS 'NamaProduk' ,
                                        trs_usulan_retur_beli_detail.Satuan AS 'Unit',
                                        0 AS 'qty_in',
                                        0 AS 'qty_out',
                                        trs_usulan_retur_beli_detail.BatchNo AS 'BatchNo',
                                        trs_usulan_retur_beli_detail.ExpDate AS 'ExpDate'
                                  FROM  trs_usulan_retur_beli_header INNER JOIN trs_usulan_retur_beli_detail ON trs_usulan_retur_beli_header.No_Usulan = trs_usulan_retur_beli_detail.No_Usulan 
                                  WHERE ifnull(trs_usulan_retur_beli_header.App_BM_Status,'') <> 'R' and ifnull(trs_usulan_retur_beli_header.App_Pst_Status,'') = 'Reject' and
                                    trs_usulan_retur_beli_detail.Produk = 'SLRDS1'and 
                                        trs_usulan_retur_beli_header.tanggal between '2020-12-01 00:00:00' and '2020-12-23 23:59:59'
                                  
                                  UNION ALL

                                  SELECT no_koreksi AS 'NoDoc', 
                                        CONCAT('Usulan Adjusment (-): QTY = ',(qty * -1),' ',catatan) AS 'Dokumen',
                                        tanggal AS 'TglDoc',
                                        trs_mutasi_koreksi.created_at as 'TimeDoc',
                                        trs_mutasi_koreksi.produk AS 'Kode' ,
                                        trs_mutasi_koreksi.nama_produk AS 'NamaProduk' ,
                                        Satuan AS 'Unit',
                                        0 AS 'qty_in',
                                        0 AS 'qty_out',
                                        batch AS 'BatchNo',
                                        exp_date AS 'ExpDate'
                                  FROM  trs_mutasi_koreksi INNER JOIN mst_produk ON mst_produk.`Kode_Produk` = trs_mutasi_koreksi.`produk`
                                  WHERE   qty < 0 AND trs_mutasi_koreksi.status IN ('Open','Approve') and
                                    trs_mutasi_koreksi.`produk` = 'SLRDS1'and 
                                        CASE WHEN trs_mutasi_koreksi.`Status` = 'Open' THEN
                                            tanggal
                                         ELSE
                                            IFNULL(DATE(tgl_approve),tanggal)
                                         END between '2020-12-01 00:00:00' and '2020-12-23 23:59:59'
                                        
                                  UNION ALL

                                  SELECT no_koreksi AS 'NoDoc', 
                                        CONCAT('Adjusment (-): ',catatan) AS 'Dokumen',
                                        IFNULL(DATE(tgl_approve),tanggal) AS 'TglDoc',
                                        trs_mutasi_koreksi.created_at as 'TimeDoc',
                                        trs_mutasi_koreksi.produk AS 'Kode' ,
                                        trs_mutasi_koreksi.nama_produk AS 'NamaProduk' ,
                                        Satuan AS 'Unit',
                                        0 AS 'qty_in',
                                        (qty * -1) AS 'qty_out',
                                        batch AS 'BatchNo',
                                        exp_date AS 'ExpDate'
                                  FROM  trs_mutasi_koreksi INNER JOIN mst_produk ON mst_produk.`Kode_Produk` = trs_mutasi_koreksi.`produk`
                                  WHERE   qty < 0 AND trs_mutasi_koreksi.status = 'Approve' and
                                    trs_mutasi_koreksi.`produk` = 'SLRDS1'and 
                                        IFNULL(DATE(tgl_approve),tanggal) between '2020-12-01 00:00:00' and '2020-12-23 23:59:59'
                                  
                                  UNION ALL 

                                  SELECT nodokumen AS 'NoDoc', 
                                        CONCAT('Mutasi Batch Dari Batch ',batchno_awal,' ke Batch ',batchno_akhir,' : QTY = ',qty) AS 'Dokumen',
                                        DATE(tanggal) AS 'TglDoc',
                                        create_date AS 'TimeDoc',
                                        trs_mutasi_batch.produk AS 'Kode' ,
                                        namaproduk AS 'NamaProduk' ,
                                        '' AS 'Unit',
                                        0 AS 'qty_in',
                                        0 AS 'qty_out',
                                        batchno_akhir AS 'BatchNo',
                                        expdate_akhir AS 'ExpDate'
                                  FROM  trs_mutasi_batch INNER JOIN mst_produk ON mst_produk.`Kode_Produk` = trs_mutasi_batch.`produk`
                                  WHERE    trs_mutasi_batch.status = 'Approve' AND
                                    trs_mutasi_batch.`produk` = 'SLRDS1'AND 
                                        DATE(tanggal) BETWEEN '2020-12-01 00:00:00' and '2020-12-23 23:59:59'
                                        
                                  ORDER BY TglDoc,TimeDoc,NoDoc ASC;
ERROR - 2020-12-23 14:29:14 --> Severity: error --> Exception: Call to a member function result() on boolean D:\xampp70\htdocs\sstcabang\application\models\pembelian\Model_inventori.php 1083
ERROR - 2020-12-23 14:29:14 --> Cabang
ERROR - 2020-12-23 14:29:15 --> Query error: Unknown column 'trs_usulan_retur_beli_header.App_Pst_Status' in 'where clause' - Invalid query: SELECT NoDokumen AS 'NoDoc',
                                          CONCAT('Terima dari ',Prinsipal,' - ',Supplier) AS 'Dokumen',
                                          TglDokumen AS 'TglDoc',
                                          TimeDokumen as 'TimeDoc',
                                          Produk AS 'Kode',
                                          NamaProduk AS 'NamaProduk',
                                          Satuan AS 'Unit',
                                          (ifnull(Qty,'') + ifnull(Bonus,'')) AS 'qty_in',
                                          0 AS 'qty_out',
                                          BatchNo,
                                          ExpDate
                                  FROM trs_terima_barang_detail
                                  WHERE trs_terima_barang_detail.Produk = 'SLRDS1' and 
                                        Status not in ('pending','Batal') and
                                        ifnull(Tipe,'') not in  ('BKB','Tolakan') and
                                        TglDokumen between '2020-12-01 00:00:00' and '2020-12-23 23:59:59'
                                  
                                  UNION ALL

                                  SELECT NoDokumen AS 'NoDoc',
                                          CONCAT('Retur Ke ',Prinsipal,' - ',Supplier) AS 'Dokumen',
                                          TglDokumen AS 'TglDoc',
                                          TimeDokumen as 'TimeDoc',
                                          Produk AS 'Kode',
                                          NamaProduk AS 'NamaProduk',
                                          Satuan AS 'Unit',
                                          0 AS 'qty_in',
                                          (((ifnull(Qty,'') + ifnull(Bonus,'')))*-1) AS 'qty_out',
                                          BatchNo,
                                          ExpDate
                                  FROM trs_terima_barang_detail
                                  where   ifnull(Tipe,'') = 'BKB' and Produk = 'SLRDS1' and 
                                        TglDokumen between '2020-12-01 00:00:00' and '2020-12-23 23:59:59'
                                  
                                  UNION ALL
                                  SELECT NoDokumen AS 'NoDoc',
                                          CONCAT('Tolakan Retur ',Prinsipal,' - ',Supplier,' ~ Qty : ', (ifnull(Qty,'') + ifnull(Bonus,''))*-1) AS 'Dokumen',
                                          TglDokumen AS 'TglDoc',
                                          TimeDokumen as 'TimeDoc',
                                          Produk AS 'Kode',
                                          NamaProduk AS 'NamaProduk',
                                          Satuan AS 'Unit',
                                          0 AS 'qty_in',
                                          0 AS 'qty_out',
                                          BatchNo,
                                          ExpDate
                                  FROM trs_terima_barang_detail
                                  where   ifnull(Tipe,'') = 'Tolakan' and Produk = 'SLRDS1' and 
                                        TglDokumen between '2020-12-01 00:00:00' and '2020-12-23 23:59:59'

                                  UNION ALL
                                  SELECT no_koreksi AS 'NoDoc', 
                                         CONCAT('Usulan Adjusment (+) : ', catatan) AS 'Dokumen',
                                         tanggal AS 'TglDoc',
                                         trs_mutasi_koreksi.created_at as 'TimeDoc',
                                         trs_mutasi_koreksi.produk AS 'Kode' ,
                                         trs_mutasi_koreksi.nama_produk AS 'NamaProduk' ,
                                         Satuan AS 'Unit',
                                         qty AS 'qty_in',
                                         0 AS 'qty_out',
                                         batch AS 'BatchNo',
                                         exp_date AS 'ExpDate'
                                  FROM  trs_mutasi_koreksi INNER JOIN mst_produk ON mst_produk.`Kode_Produk` = trs_mutasi_koreksi.`produk`
                                  WHERE   qty > 0 AND trs_mutasi_koreksi.status IN ('Open','Approve') and
                                    trs_mutasi_koreksi.`produk` = 'SLRDS1' and 
                                        CASE WHEN trs_mutasi_koreksi.`Status` = 'Open' THEN
                                          tanggal
                                       ELSE
                                          IFNULL(DATE(tgl_approve),tanggal)
                                       END between '2020-12-01 00:00:00' and '2020-12-23 23:59:59'
                                  UNION ALL
                                  SELECT NoDokumen AS 'NoDoc', 
                                         CONCAT('Mutasi Gudang dari Gudang : ', gudang_awal,' Ke Gudang : ',gudang_akhir,' ~ QTY = ',qty) AS 'Dokumen',
                                         tanggal AS 'TglDoc',
                                         trs_mutasi_gudang.create_date as 'TimeDoc',
                                         trs_mutasi_gudang.produk AS 'Kode' ,
                                         trs_mutasi_gudang.namaproduk AS 'NamaProduk' ,
                                         '' AS 'Unit',
                                         0 AS 'qty_in',
                                         0 AS 'qty_out',
                                         batchno_awal AS 'BatchNo',
                                         expdate_awal AS 'ExpDate'
                                  FROM  trs_mutasi_gudang INNER JOIN mst_produk ON mst_produk.`Kode_Produk` = trs_mutasi_gudang.`produk`
                                  WHERE   qty > 0 AND trs_mutasi_gudang.status IN ('Open','Approve') and
                                    trs_mutasi_gudang.`produk` = 'SLRDS1' and 
                                        tanggal between '2020-12-01 00:00:00' and '2020-12-23 23:59:59'
                                  UNION ALL

                                  SELECT no_koreksi AS 'NoDoc', 
                                         CONCAT('Adjusment (+) : QTY = ',qty,' ', catatan) AS 'Dokumen',
                                         IFNULL(DATE(tgl_approve),tanggal) AS 'TglDoc',
                                         trs_mutasi_koreksi.created_at as 'TimeDoc',
                                         trs_mutasi_koreksi.produk AS 'Kode' ,
                                         trs_mutasi_koreksi.nama_produk AS 'NamaProduk' ,
                                         Satuan AS 'Unit',
                                         0 AS 'qty_in',
                                         0 AS 'qty_out',
                                         batch AS 'BatchNo',
                                         exp_date AS 'ExpDate'
                                  FROM  trs_mutasi_koreksi INNER JOIN mst_produk ON mst_produk.`Kode_Produk` = trs_mutasi_koreksi.`produk`
                                  WHERE   qty > 0 AND trs_mutasi_koreksi.status = 'Approve' and
                                    trs_mutasi_koreksi.`produk` = 'SLRDS1' and 
                                        IFNULL(DATE(tgl_approve),tanggal) between '2020-12-01 00:00:00' and '2020-12-23 23:59:59'
                                  UNION ALL

                                  SELECT No_Terima AS 'NoDoc', 
                                         CONCAT('Relokasi Dari Cabang  : ', Cabang_Pengirim) AS 'Dokumen',
                                         Tgl_terima AS 'TglDoc',
                                         Time_terima as 'TimeDoc',
                                         Produk AS 'Kode' ,
                                         NamaProduk AS 'NamaProduk' ,
                                         Satuan AS 'Unit',
                                         (Qty+Bonus) AS 'qty_in',
                                         0 AS 'qty_out',
                                         BatchNo AS 'BatchNo',
                                         ExpDate AS 'ExpDate'
                                  FROM  trs_relokasi_terima_detail 
                                  WHERE   (Qty > 0 or Bonus > 0) AND
                                        Status = 'Terima' and
                                        Produk = 'SLRDS1' and 
                                        Tgl_terima between '2020-12-01 00:00:00' and '2020-12-23 23:59:59'
                                    
                                  UNION ALL 

                                  SELECT NoFaktur AS 'NoDoc',
                                        CONCAT('Terima dari ',Pelanggan, ' - ' ,NamaPelanggan) AS 'Dokumen',
                                        TglFaktur AS 'TglDoc',
                                        TimeFaktur as 'TimeDoc',
                                        KodeProduk AS 'Kode', 
                                        NamaProduk AS 'NamaProduk',
                                        UOM AS 'Unit',
                                        (QtyFaktur+BonusFaktur) AS 'qty_in',
                                        0 AS 'qty_out',
                                        BatchNo,
                                        ExpDate
                                  FROM trs_faktur_detail 
                                  WHERE TipeDokumen ='Retur' AND 
                                        ifnull(status,'') != 'Batal' and
                                        KodeProduk = 'SLRDS1' and 
                                        TglFaktur between '2020-12-01 00:00:00' and '2020-12-23 23:59:59'

                                  UNION ALL


                                  SELECT NoDO AS 'NoDoc',
                                    CONCAT('Kirim ke ',Pelanggan, ' - ' ,NamaPelanggan) AS 'Dokumen',  
                                    TglDO AS 'TglDoc',
                                    TimeDO AS 'TimeDoc',
                                    KodeProduk AS 'Kode',
                                    NamaProduk AS 'NamaProduk',
                                    UOM AS 'Unit',
                                    0 AS 'qty_in', 
                                    (QtyDO+BonusDO) AS 'qty_out',
                                    BatchNo,ExpDate
                                  FROM trs_delivery_order_sales_detail 
                                  WHERE KodeProduk = 'SLRDS1'  
                                    AND TglDO BETWEEN '2020-12-01 00:00:00' and '2020-12-23 23:59:59' and tipedokumen ='DO'
                                  UNION ALL
                                  SELECT NoDO AS 'NoDoc',
                                    CONCAT('Batal Kirim ke ',Pelanggan, ' - ' ,NamaPelanggan) AS 'Dokumen',  
                                    TglDO AS 'TglDoc',
                                    TimeDO AS 'TimeDoc',
                                    KodeProduk AS 'Kode',
                                    NamaProduk AS 'NamaProduk',
                                    UOM AS 'Unit',
                                    (QtyDO+BonusDO) AS 'qty_in', 
                                    0 AS 'qty_out',
                                    BatchNo,ExpDate
                                  FROM trs_delivery_order_sales_detail 
                                  WHERE KodeProduk = 'SLRDS1' 
                                    AND Status = 'Batal' 
                                    AND date(ifnull(time_batal,'')) BETWEEN '2020-12-01 00:00:00' and '2020-12-23 23:59:59'
                                  UNION ALL
                                  SELECT NoDO AS 'NoDoc',
                                    CONCAT('Retur Kirim dari ',Pelanggan, ' - ' ,NamaPelanggan) AS 'Dokumen',  
                                    TglDO AS 'TglDoc',
                                    TimeDO AS 'TimeDoc',
                                    KodeProduk AS 'Kode',
                                    NamaProduk AS 'NamaProduk',
                                    UOM AS 'Unit',
                                    (QtyDO+BonusDO) AS 'qty_in', 
                                    0 AS 'qty_out',
                                    BatchNo,ExpDate
                                  FROM trs_delivery_order_sales_detail 
                                  WHERE KodeProduk = 'SLRDS1' and 
                                        TipeDokumen ='Retur' and Status = 'Retur' 
                                    AND TglDO BETWEEN '2020-12-01 00:00:00' and '2020-12-23 23:59:59'
                                  UNION ALL

                                  SELECT trs_relokasi_kirim_detail.No_Relokasi AS 'NoDoc', 
                                        CASE WHEN Status = 'ApproveLog' THEN
                                         CONCAT('Relokasi ke Cabang  : ', trs_relokasi_kirim_detail.Cabang_Penerima)
                                        ELSE
                                          CONCAT('Relokasi ke Cabang  : ', trs_relokasi_kirim_detail.Cabang_Penerima)
                                        END
                                         AS 'Dokumen',
                                         CASE WHEN tgl_app IS NULL THEN trs_relokasi_kirim_detail.Tgl_kirim ELSE trs_relokasi_kirim_detail.tgl_app END AS 'TglDoc',
                                         CASE WHEN tgl_app IS NULL THEN trs_relokasi_kirim_detail.Time_kirim ELSE trs_relokasi_kirim_detail.App_BM_Time END  'TimeDoc',
                                         Produk AS 'Kode' ,
                                         NamaProduk AS 'NamaProduk' ,
                                         Satuan AS 'Unit',
                                         0 AS 'qty_in',
                                         CASE WHEN Status = 'ApproveLog' THEN
                                         0
                                         ELSE
                                         (Qty+Bonus)
                                         END AS 'qty_out',
                                         BatchNo AS 'BatchNo',
                                         ExpDate AS 'ExpDate'
                                  FROM  trs_relokasi_kirim_detail
                                  WHERE trs_relokasi_kirim_detail.Status IN ('Kirim','Reject','RejectPusat','RejectCabPenerima','ApproveLog') and
                                        trs_relokasi_kirim_detail.Produk = 'SLRDS1' and 
                                          CASE WHEN tgl_app IS NULL THEN trs_relokasi_kirim_detail.Tgl_kirim ELSE trs_relokasi_kirim_detail.tgl_app END
                                         between '2020-12-01 00:00:00' and '2020-12-23 23:59:59' 

                                  UNION ALL

                                  SELECT trs_relokasi_kirim_detail.No_Relokasi AS 'NoDoc', 
                                         CASE WHEN Keterangan_reject LIKE '%Penerima%' THEN
                                          'Relokasi Reject Cabang Penerima'
                                         ELSE 
                                           'Relokasi Reject Pusat'
                                         END AS 'Dokumen',
                                         trs_relokasi_kirim_detail.tgl_reject AS 'TglDoc',
                                         trs_relokasi_kirim_detail.Time_kirim 'TimeDoc',
                                         Produk AS 'Kode' ,
                                         NamaProduk AS 'NamaProduk' ,
                                         Satuan AS 'Unit',
                                         (Qty+Bonus) AS 'qty_in',
                                         0 AS 'qty_out',
                                         BatchNo AS 'BatchNo',
                                         ExpDate AS 'ExpDate'
                                  FROM  trs_relokasi_kirim_detail
                                  WHERE trs_relokasi_kirim_detail.Status = 'Reject' and
                                        trs_relokasi_kirim_detail.Produk = 'SLRDS1' and 
                                        trs_relokasi_kirim_detail.Tgl_reject between '2020-12-01 00:00:00' and '2020-12-23 23:59:59'

                                  UNION ALL

                                  SELECT trs_usulan_retur_beli_header.No_Usulan AS 'NoDoc', 
                                        CONCAT('Usulan Retur Beli : QTY = ',((trs_usulan_retur_beli_detail.Qty+trs_usulan_retur_beli_detail.Bonus) * -1),'  ~ Ke : ',trs_usulan_retur_beli_header.Prinsipal) AS 'Dokumen',
                                        trs_usulan_retur_beli_header.Tanggal AS 'TglDoc',
                                        trs_usulan_retur_beli_header.added_time as 'TimeDoc',
                                        trs_usulan_retur_beli_detail.Produk AS 'Kode' ,
                                        trs_usulan_retur_beli_detail.Nama_produk AS 'NamaProduk' ,
                                        trs_usulan_retur_beli_detail.Satuan AS 'Unit',
                                        0 AS 'qty_in',
                                        0 AS 'qty_out',
                                        trs_usulan_retur_beli_detail.BatchNo AS 'BatchNo',
                                        trs_usulan_retur_beli_detail.ExpDate AS 'ExpDate'
                                  FROM  trs_usulan_retur_beli_header INNER JOIN trs_usulan_retur_beli_detail ON trs_usulan_retur_beli_header.No_Usulan = trs_usulan_retur_beli_detail.No_Usulan 
                                  WHERE ifnull(trs_usulan_retur_beli_header.App_BM_Status,'') <> 'R' and
                                    trs_usulan_retur_beli_detail.Produk = 'SLRDS1'and 
                                        trs_usulan_retur_beli_header.tanggal between '2020-12-01 00:00:00' and '2020-12-23 23:59:59'

                                  UNION ALL

                                  SELECT trs_usulan_retur_beli_header.No_Usulan AS 'NoDoc', 
                                        CONCAT('Reject Usulan Beli Pusat : QTY = ',((trs_usulan_retur_beli_detail.Qty+trs_usulan_retur_beli_detail.Bonus) * -1),'  ~ Ke : ',trs_usulan_retur_beli_header.Prinsipal) AS 'Dokumen',
                                        trs_usulan_retur_beli_header.Tanggal AS 'TglDoc',
                                        trs_usulan_retur_beli_header.added_time as 'TimeDoc',
                                        trs_usulan_retur_beli_detail.Produk AS 'Kode' ,
                                        trs_usulan_retur_beli_detail.Nama_produk AS 'NamaProduk' ,
                                        trs_usulan_retur_beli_detail.Satuan AS 'Unit',
                                        0 AS 'qty_in',
                                        0 AS 'qty_out',
                                        trs_usulan_retur_beli_detail.BatchNo AS 'BatchNo',
                                        trs_usulan_retur_beli_detail.ExpDate AS 'ExpDate'
                                  FROM  trs_usulan_retur_beli_header INNER JOIN trs_usulan_retur_beli_detail ON trs_usulan_retur_beli_header.No_Usulan = trs_usulan_retur_beli_detail.No_Usulan 
                                  WHERE ifnull(trs_usulan_retur_beli_header.App_BM_Status,'') <> 'R' and ifnull(trs_usulan_retur_beli_header.App_Pst_Status,'') = 'Reject' and
                                    trs_usulan_retur_beli_detail.Produk = 'SLRDS1'and 
                                        trs_usulan_retur_beli_header.tanggal between '2020-12-01 00:00:00' and '2020-12-23 23:59:59'
                                  
                                  UNION ALL

                                  SELECT no_koreksi AS 'NoDoc', 
                                        CONCAT('Usulan Adjusment (-): QTY = ',(qty * -1),' ',catatan) AS 'Dokumen',
                                        tanggal AS 'TglDoc',
                                        trs_mutasi_koreksi.created_at as 'TimeDoc',
                                        trs_mutasi_koreksi.produk AS 'Kode' ,
                                        trs_mutasi_koreksi.nama_produk AS 'NamaProduk' ,
                                        Satuan AS 'Unit',
                                        0 AS 'qty_in',
                                        0 AS 'qty_out',
                                        batch AS 'BatchNo',
                                        exp_date AS 'ExpDate'
                                  FROM  trs_mutasi_koreksi INNER JOIN mst_produk ON mst_produk.`Kode_Produk` = trs_mutasi_koreksi.`produk`
                                  WHERE   qty < 0 AND trs_mutasi_koreksi.status IN ('Open','Approve') and
                                    trs_mutasi_koreksi.`produk` = 'SLRDS1'and 
                                        CASE WHEN trs_mutasi_koreksi.`Status` = 'Open' THEN
                                            tanggal
                                         ELSE
                                            IFNULL(DATE(tgl_approve),tanggal)
                                         END between '2020-12-01 00:00:00' and '2020-12-23 23:59:59'
                                        
                                  UNION ALL

                                  SELECT no_koreksi AS 'NoDoc', 
                                        CONCAT('Adjusment (-): ',catatan) AS 'Dokumen',
                                        IFNULL(DATE(tgl_approve),tanggal) AS 'TglDoc',
                                        trs_mutasi_koreksi.created_at as 'TimeDoc',
                                        trs_mutasi_koreksi.produk AS 'Kode' ,
                                        trs_mutasi_koreksi.nama_produk AS 'NamaProduk' ,
                                        Satuan AS 'Unit',
                                        0 AS 'qty_in',
                                        (qty * -1) AS 'qty_out',
                                        batch AS 'BatchNo',
                                        exp_date AS 'ExpDate'
                                  FROM  trs_mutasi_koreksi INNER JOIN mst_produk ON mst_produk.`Kode_Produk` = trs_mutasi_koreksi.`produk`
                                  WHERE   qty < 0 AND trs_mutasi_koreksi.status = 'Approve' and
                                    trs_mutasi_koreksi.`produk` = 'SLRDS1'and 
                                        IFNULL(DATE(tgl_approve),tanggal) between '2020-12-01 00:00:00' and '2020-12-23 23:59:59'
                                  
                                  UNION ALL 

                                  SELECT nodokumen AS 'NoDoc', 
                                        CONCAT('Mutasi Batch Dari Batch ',batchno_awal,' ke Batch ',batchno_akhir,' : QTY = ',qty) AS 'Dokumen',
                                        DATE(tanggal) AS 'TglDoc',
                                        create_date AS 'TimeDoc',
                                        trs_mutasi_batch.produk AS 'Kode' ,
                                        namaproduk AS 'NamaProduk' ,
                                        '' AS 'Unit',
                                        0 AS 'qty_in',
                                        0 AS 'qty_out',
                                        batchno_akhir AS 'BatchNo',
                                        expdate_akhir AS 'ExpDate'
                                  FROM  trs_mutasi_batch INNER JOIN mst_produk ON mst_produk.`Kode_Produk` = trs_mutasi_batch.`produk`
                                  WHERE    trs_mutasi_batch.status = 'Approve' AND
                                    trs_mutasi_batch.`produk` = 'SLRDS1'AND 
                                        DATE(tanggal) BETWEEN '2020-12-01 00:00:00' and '2020-12-23 23:59:59'
                                        
                                  ORDER BY TglDoc,TimeDoc,NoDoc ASC;
ERROR - 2020-12-23 14:29:15 --> Severity: error --> Exception: Call to a member function result() on boolean D:\xampp70\htdocs\sstcabang\application\models\pembelian\Model_inventori.php 1083
ERROR - 2020-12-23 14:29:18 --> 404 Page Not Found: /index
ERROR - 2020-12-23 14:29:38 --> Query error: Unknown column 'trs_usulan_retur_beli_header.App_Pst_Status' in 'where clause' - Invalid query: SELECT NoDokumen AS 'NoDoc',
                                          CONCAT('Terima dari ',Prinsipal,' - ',Supplier) AS 'Dokumen',
                                          TglDokumen AS 'TglDoc',
                                          TimeDokumen as 'TimeDoc',
                                          Produk AS 'Kode',
                                          NamaProduk AS 'NamaProduk',
                                          Satuan AS 'Unit',
                                          (ifnull(Qty,'') + ifnull(Bonus,'')) AS 'qty_in',
                                          0 AS 'qty_out',
                                          BatchNo,
                                          ExpDate
                                  FROM trs_terima_barang_detail
                                  WHERE trs_terima_barang_detail.Produk = 'SLRDS1' and 
                                        Status not in ('pending','Batal') and
                                        ifnull(Tipe,'') not in  ('BKB','Tolakan') and
                                        TglDokumen between '2020-12-01 00:00:00' and '2020-12-23 23:59:59'
                                  
                                  UNION ALL

                                  SELECT NoDokumen AS 'NoDoc',
                                          CONCAT('Retur Ke ',Prinsipal,' - ',Supplier) AS 'Dokumen',
                                          TglDokumen AS 'TglDoc',
                                          TimeDokumen as 'TimeDoc',
                                          Produk AS 'Kode',
                                          NamaProduk AS 'NamaProduk',
                                          Satuan AS 'Unit',
                                          0 AS 'qty_in',
                                          (((ifnull(Qty,'') + ifnull(Bonus,'')))*-1) AS 'qty_out',
                                          BatchNo,
                                          ExpDate
                                  FROM trs_terima_barang_detail
                                  where   ifnull(Tipe,'') = 'BKB' and Produk = 'SLRDS1' and 
                                        TglDokumen between '2020-12-01 00:00:00' and '2020-12-23 23:59:59'
                                  
                                  UNION ALL
                                  SELECT NoDokumen AS 'NoDoc',
                                          CONCAT('Tolakan Retur ',Prinsipal,' - ',Supplier,' ~ Qty : ', (ifnull(Qty,'') + ifnull(Bonus,''))*-1) AS 'Dokumen',
                                          TglDokumen AS 'TglDoc',
                                          TimeDokumen as 'TimeDoc',
                                          Produk AS 'Kode',
                                          NamaProduk AS 'NamaProduk',
                                          Satuan AS 'Unit',
                                          0 AS 'qty_in',
                                          0 AS 'qty_out',
                                          BatchNo,
                                          ExpDate
                                  FROM trs_terima_barang_detail
                                  where   ifnull(Tipe,'') = 'Tolakan' and Produk = 'SLRDS1' and 
                                        TglDokumen between '2020-12-01 00:00:00' and '2020-12-23 23:59:59'

                                  UNION ALL
                                  SELECT no_koreksi AS 'NoDoc', 
                                         CONCAT('Usulan Adjusment (+) : ', catatan) AS 'Dokumen',
                                         tanggal AS 'TglDoc',
                                         trs_mutasi_koreksi.created_at as 'TimeDoc',
                                         trs_mutasi_koreksi.produk AS 'Kode' ,
                                         trs_mutasi_koreksi.nama_produk AS 'NamaProduk' ,
                                         Satuan AS 'Unit',
                                         qty AS 'qty_in',
                                         0 AS 'qty_out',
                                         batch AS 'BatchNo',
                                         exp_date AS 'ExpDate'
                                  FROM  trs_mutasi_koreksi INNER JOIN mst_produk ON mst_produk.`Kode_Produk` = trs_mutasi_koreksi.`produk`
                                  WHERE   qty > 0 AND trs_mutasi_koreksi.status IN ('Open','Approve') and
                                    trs_mutasi_koreksi.`produk` = 'SLRDS1' and 
                                        CASE WHEN trs_mutasi_koreksi.`Status` = 'Open' THEN
                                          tanggal
                                       ELSE
                                          IFNULL(DATE(tgl_approve),tanggal)
                                       END between '2020-12-01 00:00:00' and '2020-12-23 23:59:59'
                                  UNION ALL
                                  SELECT NoDokumen AS 'NoDoc', 
                                         CONCAT('Mutasi Gudang dari Gudang : ', gudang_awal,' Ke Gudang : ',gudang_akhir,' ~ QTY = ',qty) AS 'Dokumen',
                                         tanggal AS 'TglDoc',
                                         trs_mutasi_gudang.create_date as 'TimeDoc',
                                         trs_mutasi_gudang.produk AS 'Kode' ,
                                         trs_mutasi_gudang.namaproduk AS 'NamaProduk' ,
                                         '' AS 'Unit',
                                         0 AS 'qty_in',
                                         0 AS 'qty_out',
                                         batchno_awal AS 'BatchNo',
                                         expdate_awal AS 'ExpDate'
                                  FROM  trs_mutasi_gudang INNER JOIN mst_produk ON mst_produk.`Kode_Produk` = trs_mutasi_gudang.`produk`
                                  WHERE   qty > 0 AND trs_mutasi_gudang.status IN ('Open','Approve') and
                                    trs_mutasi_gudang.`produk` = 'SLRDS1' and 
                                        tanggal between '2020-12-01 00:00:00' and '2020-12-23 23:59:59'
                                  UNION ALL

                                  SELECT no_koreksi AS 'NoDoc', 
                                         CONCAT('Adjusment (+) : QTY = ',qty,' ', catatan) AS 'Dokumen',
                                         IFNULL(DATE(tgl_approve),tanggal) AS 'TglDoc',
                                         trs_mutasi_koreksi.created_at as 'TimeDoc',
                                         trs_mutasi_koreksi.produk AS 'Kode' ,
                                         trs_mutasi_koreksi.nama_produk AS 'NamaProduk' ,
                                         Satuan AS 'Unit',
                                         0 AS 'qty_in',
                                         0 AS 'qty_out',
                                         batch AS 'BatchNo',
                                         exp_date AS 'ExpDate'
                                  FROM  trs_mutasi_koreksi INNER JOIN mst_produk ON mst_produk.`Kode_Produk` = trs_mutasi_koreksi.`produk`
                                  WHERE   qty > 0 AND trs_mutasi_koreksi.status = 'Approve' and
                                    trs_mutasi_koreksi.`produk` = 'SLRDS1' and 
                                        IFNULL(DATE(tgl_approve),tanggal) between '2020-12-01 00:00:00' and '2020-12-23 23:59:59'
                                  UNION ALL

                                  SELECT No_Terima AS 'NoDoc', 
                                         CONCAT('Relokasi Dari Cabang  : ', Cabang_Pengirim) AS 'Dokumen',
                                         Tgl_terima AS 'TglDoc',
                                         Time_terima as 'TimeDoc',
                                         Produk AS 'Kode' ,
                                         NamaProduk AS 'NamaProduk' ,
                                         Satuan AS 'Unit',
                                         (Qty+Bonus) AS 'qty_in',
                                         0 AS 'qty_out',
                                         BatchNo AS 'BatchNo',
                                         ExpDate AS 'ExpDate'
                                  FROM  trs_relokasi_terima_detail 
                                  WHERE   (Qty > 0 or Bonus > 0) AND
                                        Status = 'Terima' and
                                        Produk = 'SLRDS1' and 
                                        Tgl_terima between '2020-12-01 00:00:00' and '2020-12-23 23:59:59'
                                    
                                  UNION ALL 

                                  SELECT NoFaktur AS 'NoDoc',
                                        CONCAT('Terima dari ',Pelanggan, ' - ' ,NamaPelanggan) AS 'Dokumen',
                                        TglFaktur AS 'TglDoc',
                                        TimeFaktur as 'TimeDoc',
                                        KodeProduk AS 'Kode', 
                                        NamaProduk AS 'NamaProduk',
                                        UOM AS 'Unit',
                                        (QtyFaktur+BonusFaktur) AS 'qty_in',
                                        0 AS 'qty_out',
                                        BatchNo,
                                        ExpDate
                                  FROM trs_faktur_detail 
                                  WHERE TipeDokumen ='Retur' AND 
                                        ifnull(status,'') != 'Batal' and
                                        KodeProduk = 'SLRDS1' and 
                                        TglFaktur between '2020-12-01 00:00:00' and '2020-12-23 23:59:59'

                                  UNION ALL


                                  SELECT NoDO AS 'NoDoc',
                                    CONCAT('Kirim ke ',Pelanggan, ' - ' ,NamaPelanggan) AS 'Dokumen',  
                                    TglDO AS 'TglDoc',
                                    TimeDO AS 'TimeDoc',
                                    KodeProduk AS 'Kode',
                                    NamaProduk AS 'NamaProduk',
                                    UOM AS 'Unit',
                                    0 AS 'qty_in', 
                                    (QtyDO+BonusDO) AS 'qty_out',
                                    BatchNo,ExpDate
                                  FROM trs_delivery_order_sales_detail 
                                  WHERE KodeProduk = 'SLRDS1'  
                                    AND TglDO BETWEEN '2020-12-01 00:00:00' and '2020-12-23 23:59:59' and tipedokumen ='DO'
                                  UNION ALL
                                  SELECT NoDO AS 'NoDoc',
                                    CONCAT('Batal Kirim ke ',Pelanggan, ' - ' ,NamaPelanggan) AS 'Dokumen',  
                                    TglDO AS 'TglDoc',
                                    TimeDO AS 'TimeDoc',
                                    KodeProduk AS 'Kode',
                                    NamaProduk AS 'NamaProduk',
                                    UOM AS 'Unit',
                                    (QtyDO+BonusDO) AS 'qty_in', 
                                    0 AS 'qty_out',
                                    BatchNo,ExpDate
                                  FROM trs_delivery_order_sales_detail 
                                  WHERE KodeProduk = 'SLRDS1' 
                                    AND Status = 'Batal' 
                                    AND date(ifnull(time_batal,'')) BETWEEN '2020-12-01 00:00:00' and '2020-12-23 23:59:59'
                                  UNION ALL
                                  SELECT NoDO AS 'NoDoc',
                                    CONCAT('Retur Kirim dari ',Pelanggan, ' - ' ,NamaPelanggan) AS 'Dokumen',  
                                    TglDO AS 'TglDoc',
                                    TimeDO AS 'TimeDoc',
                                    KodeProduk AS 'Kode',
                                    NamaProduk AS 'NamaProduk',
                                    UOM AS 'Unit',
                                    (QtyDO+BonusDO) AS 'qty_in', 
                                    0 AS 'qty_out',
                                    BatchNo,ExpDate
                                  FROM trs_delivery_order_sales_detail 
                                  WHERE KodeProduk = 'SLRDS1' and 
                                        TipeDokumen ='Retur' and Status = 'Retur' 
                                    AND TglDO BETWEEN '2020-12-01 00:00:00' and '2020-12-23 23:59:59'
                                  UNION ALL

                                  SELECT trs_relokasi_kirim_detail.No_Relokasi AS 'NoDoc', 
                                        CASE WHEN Status = 'ApproveLog' THEN
                                         CONCAT('Relokasi ke Cabang  : ', trs_relokasi_kirim_detail.Cabang_Penerima)
                                        ELSE
                                          CONCAT('Relokasi ke Cabang  : ', trs_relokasi_kirim_detail.Cabang_Penerima)
                                        END
                                         AS 'Dokumen',
                                         CASE WHEN tgl_app IS NULL THEN trs_relokasi_kirim_detail.Tgl_kirim ELSE trs_relokasi_kirim_detail.tgl_app END AS 'TglDoc',
                                         CASE WHEN tgl_app IS NULL THEN trs_relokasi_kirim_detail.Time_kirim ELSE trs_relokasi_kirim_detail.App_BM_Time END  'TimeDoc',
                                         Produk AS 'Kode' ,
                                         NamaProduk AS 'NamaProduk' ,
                                         Satuan AS 'Unit',
                                         0 AS 'qty_in',
                                         CASE WHEN Status = 'ApproveLog' THEN
                                         0
                                         ELSE
                                         (Qty+Bonus)
                                         END AS 'qty_out',
                                         BatchNo AS 'BatchNo',
                                         ExpDate AS 'ExpDate'
                                  FROM  trs_relokasi_kirim_detail
                                  WHERE trs_relokasi_kirim_detail.Status IN ('Kirim','Reject','RejectPusat','RejectCabPenerima','ApproveLog') and
                                        trs_relokasi_kirim_detail.Produk = 'SLRDS1' and 
                                          CASE WHEN tgl_app IS NULL THEN trs_relokasi_kirim_detail.Tgl_kirim ELSE trs_relokasi_kirim_detail.tgl_app END
                                         between '2020-12-01 00:00:00' and '2020-12-23 23:59:59' 

                                  UNION ALL

                                  SELECT trs_relokasi_kirim_detail.No_Relokasi AS 'NoDoc', 
                                         CASE WHEN Keterangan_reject LIKE '%Penerima%' THEN
                                          'Relokasi Reject Cabang Penerima'
                                         ELSE 
                                           'Relokasi Reject Pusat'
                                         END AS 'Dokumen',
                                         trs_relokasi_kirim_detail.tgl_reject AS 'TglDoc',
                                         trs_relokasi_kirim_detail.Time_kirim 'TimeDoc',
                                         Produk AS 'Kode' ,
                                         NamaProduk AS 'NamaProduk' ,
                                         Satuan AS 'Unit',
                                         (Qty+Bonus) AS 'qty_in',
                                         0 AS 'qty_out',
                                         BatchNo AS 'BatchNo',
                                         ExpDate AS 'ExpDate'
                                  FROM  trs_relokasi_kirim_detail
                                  WHERE trs_relokasi_kirim_detail.Status = 'Reject' and
                                        trs_relokasi_kirim_detail.Produk = 'SLRDS1' and 
                                        trs_relokasi_kirim_detail.Tgl_reject between '2020-12-01 00:00:00' and '2020-12-23 23:59:59'

                                  UNION ALL

                                  SELECT trs_usulan_retur_beli_header.No_Usulan AS 'NoDoc', 
                                        CONCAT('Usulan Retur Beli : QTY = ',((trs_usulan_retur_beli_detail.Qty+trs_usulan_retur_beli_detail.Bonus) * -1),'  ~ Ke : ',trs_usulan_retur_beli_header.Prinsipal) AS 'Dokumen',
                                        trs_usulan_retur_beli_header.Tanggal AS 'TglDoc',
                                        trs_usulan_retur_beli_header.added_time as 'TimeDoc',
                                        trs_usulan_retur_beli_detail.Produk AS 'Kode' ,
                                        trs_usulan_retur_beli_detail.Nama_produk AS 'NamaProduk' ,
                                        trs_usulan_retur_beli_detail.Satuan AS 'Unit',
                                        0 AS 'qty_in',
                                        0 AS 'qty_out',
                                        trs_usulan_retur_beli_detail.BatchNo AS 'BatchNo',
                                        trs_usulan_retur_beli_detail.ExpDate AS 'ExpDate'
                                  FROM  trs_usulan_retur_beli_header INNER JOIN trs_usulan_retur_beli_detail ON trs_usulan_retur_beli_header.No_Usulan = trs_usulan_retur_beli_detail.No_Usulan 
                                  WHERE ifnull(trs_usulan_retur_beli_header.App_BM_Status,'') <> 'R' and
                                    trs_usulan_retur_beli_detail.Produk = 'SLRDS1'and 
                                        trs_usulan_retur_beli_header.tanggal between '2020-12-01 00:00:00' and '2020-12-23 23:59:59'

                                  UNION ALL

                                  SELECT trs_usulan_retur_beli_header.No_Usulan AS 'NoDoc', 
                                        CONCAT('Reject Usulan Beli Pusat : QTY = ',((trs_usulan_retur_beli_detail.Qty+trs_usulan_retur_beli_detail.Bonus) * -1),'  ~ Ke : ',trs_usulan_retur_beli_header.Prinsipal) AS 'Dokumen',
                                        trs_usulan_retur_beli_header.Tanggal AS 'TglDoc',
                                        trs_usulan_retur_beli_header.added_time as 'TimeDoc',
                                        trs_usulan_retur_beli_detail.Produk AS 'Kode' ,
                                        trs_usulan_retur_beli_detail.Nama_produk AS 'NamaProduk' ,
                                        trs_usulan_retur_beli_detail.Satuan AS 'Unit',
                                        0 AS 'qty_in',
                                        0 AS 'qty_out',
                                        trs_usulan_retur_beli_detail.BatchNo AS 'BatchNo',
                                        trs_usulan_retur_beli_detail.ExpDate AS 'ExpDate'
                                  FROM  trs_usulan_retur_beli_header INNER JOIN trs_usulan_retur_beli_detail ON trs_usulan_retur_beli_header.No_Usulan = trs_usulan_retur_beli_detail.No_Usulan 
                                  WHERE ifnull(trs_usulan_retur_beli_header.App_BM_Status,'') <> 'R' and ifnull(trs_usulan_retur_beli_header.App_Pst_Status,'') = 'Reject' and
                                    trs_usulan_retur_beli_detail.Produk = 'SLRDS1'and 
                                        trs_usulan_retur_beli_header.tanggal between '2020-12-01 00:00:00' and '2020-12-23 23:59:59'
                                  
                                  UNION ALL

                                  SELECT no_koreksi AS 'NoDoc', 
                                        CONCAT('Usulan Adjusment (-): QTY = ',(qty * -1),' ',catatan) AS 'Dokumen',
                                        tanggal AS 'TglDoc',
                                        trs_mutasi_koreksi.created_at as 'TimeDoc',
                                        trs_mutasi_koreksi.produk AS 'Kode' ,
                                        trs_mutasi_koreksi.nama_produk AS 'NamaProduk' ,
                                        Satuan AS 'Unit',
                                        0 AS 'qty_in',
                                        0 AS 'qty_out',
                                        batch AS 'BatchNo',
                                        exp_date AS 'ExpDate'
                                  FROM  trs_mutasi_koreksi INNER JOIN mst_produk ON mst_produk.`Kode_Produk` = trs_mutasi_koreksi.`produk`
                                  WHERE   qty < 0 AND trs_mutasi_koreksi.status IN ('Open','Approve') and
                                    trs_mutasi_koreksi.`produk` = 'SLRDS1'and 
                                        CASE WHEN trs_mutasi_koreksi.`Status` = 'Open' THEN
                                            tanggal
                                         ELSE
                                            IFNULL(DATE(tgl_approve),tanggal)
                                         END between '2020-12-01 00:00:00' and '2020-12-23 23:59:59'
                                        
                                  UNION ALL

                                  SELECT no_koreksi AS 'NoDoc', 
                                        CONCAT('Adjusment (-): ',catatan) AS 'Dokumen',
                                        IFNULL(DATE(tgl_approve),tanggal) AS 'TglDoc',
                                        trs_mutasi_koreksi.created_at as 'TimeDoc',
                                        trs_mutasi_koreksi.produk AS 'Kode' ,
                                        trs_mutasi_koreksi.nama_produk AS 'NamaProduk' ,
                                        Satuan AS 'Unit',
                                        0 AS 'qty_in',
                                        (qty * -1) AS 'qty_out',
                                        batch AS 'BatchNo',
                                        exp_date AS 'ExpDate'
                                  FROM  trs_mutasi_koreksi INNER JOIN mst_produk ON mst_produk.`Kode_Produk` = trs_mutasi_koreksi.`produk`
                                  WHERE   qty < 0 AND trs_mutasi_koreksi.status = 'Approve' and
                                    trs_mutasi_koreksi.`produk` = 'SLRDS1'and 
                                        IFNULL(DATE(tgl_approve),tanggal) between '2020-12-01 00:00:00' and '2020-12-23 23:59:59'
                                  
                                  UNION ALL 

                                  SELECT nodokumen AS 'NoDoc', 
                                        CONCAT('Mutasi Batch Dari Batch ',batchno_awal,' ke Batch ',batchno_akhir,' : QTY = ',qty) AS 'Dokumen',
                                        DATE(tanggal) AS 'TglDoc',
                                        create_date AS 'TimeDoc',
                                        trs_mutasi_batch.produk AS 'Kode' ,
                                        namaproduk AS 'NamaProduk' ,
                                        '' AS 'Unit',
                                        0 AS 'qty_in',
                                        0 AS 'qty_out',
                                        batchno_akhir AS 'BatchNo',
                                        expdate_akhir AS 'ExpDate'
                                  FROM  trs_mutasi_batch INNER JOIN mst_produk ON mst_produk.`Kode_Produk` = trs_mutasi_batch.`produk`
                                  WHERE    trs_mutasi_batch.status = 'Approve' AND
                                    trs_mutasi_batch.`produk` = 'SLRDS1'AND 
                                        DATE(tanggal) BETWEEN '2020-12-01 00:00:00' and '2020-12-23 23:59:59'
                                        
                                  ORDER BY TglDoc,TimeDoc,NoDoc ASC;
ERROR - 2020-12-23 14:29:38 --> Severity: error --> Exception: Call to a member function result() on boolean D:\xampp70\htdocs\sstcabang\application\models\pembelian\Model_inventori.php 1083
ERROR - 2020-12-23 14:29:38 --> Cabang
ERROR - 2020-12-23 14:29:39 --> Query error: Unknown column 'trs_usulan_retur_beli_header.App_Pst_Status' in 'where clause' - Invalid query: SELECT NoDokumen AS 'NoDoc',
                                          CONCAT('Terima dari ',Prinsipal,' - ',Supplier) AS 'Dokumen',
                                          TglDokumen AS 'TglDoc',
                                          TimeDokumen as 'TimeDoc',
                                          Produk AS 'Kode',
                                          NamaProduk AS 'NamaProduk',
                                          Satuan AS 'Unit',
                                          (ifnull(Qty,'') + ifnull(Bonus,'')) AS 'qty_in',
                                          0 AS 'qty_out',
                                          BatchNo,
                                          ExpDate
                                  FROM trs_terima_barang_detail
                                  WHERE trs_terima_barang_detail.Produk = 'SLRDS1' and 
                                        Status not in ('pending','Batal') and
                                        ifnull(Tipe,'') not in  ('BKB','Tolakan') and
                                        TglDokumen between '2020-12-01 00:00:00' and '2020-12-23 23:59:59'
                                  
                                  UNION ALL

                                  SELECT NoDokumen AS 'NoDoc',
                                          CONCAT('Retur Ke ',Prinsipal,' - ',Supplier) AS 'Dokumen',
                                          TglDokumen AS 'TglDoc',
                                          TimeDokumen as 'TimeDoc',
                                          Produk AS 'Kode',
                                          NamaProduk AS 'NamaProduk',
                                          Satuan AS 'Unit',
                                          0 AS 'qty_in',
                                          (((ifnull(Qty,'') + ifnull(Bonus,'')))*-1) AS 'qty_out',
                                          BatchNo,
                                          ExpDate
                                  FROM trs_terima_barang_detail
                                  where   ifnull(Tipe,'') = 'BKB' and Produk = 'SLRDS1' and 
                                        TglDokumen between '2020-12-01 00:00:00' and '2020-12-23 23:59:59'
                                  
                                  UNION ALL
                                  SELECT NoDokumen AS 'NoDoc',
                                          CONCAT('Tolakan Retur ',Prinsipal,' - ',Supplier,' ~ Qty : ', (ifnull(Qty,'') + ifnull(Bonus,''))*-1) AS 'Dokumen',
                                          TglDokumen AS 'TglDoc',
                                          TimeDokumen as 'TimeDoc',
                                          Produk AS 'Kode',
                                          NamaProduk AS 'NamaProduk',
                                          Satuan AS 'Unit',
                                          0 AS 'qty_in',
                                          0 AS 'qty_out',
                                          BatchNo,
                                          ExpDate
                                  FROM trs_terima_barang_detail
                                  where   ifnull(Tipe,'') = 'Tolakan' and Produk = 'SLRDS1' and 
                                        TglDokumen between '2020-12-01 00:00:00' and '2020-12-23 23:59:59'

                                  UNION ALL
                                  SELECT no_koreksi AS 'NoDoc', 
                                         CONCAT('Usulan Adjusment (+) : ', catatan) AS 'Dokumen',
                                         tanggal AS 'TglDoc',
                                         trs_mutasi_koreksi.created_at as 'TimeDoc',
                                         trs_mutasi_koreksi.produk AS 'Kode' ,
                                         trs_mutasi_koreksi.nama_produk AS 'NamaProduk' ,
                                         Satuan AS 'Unit',
                                         qty AS 'qty_in',
                                         0 AS 'qty_out',
                                         batch AS 'BatchNo',
                                         exp_date AS 'ExpDate'
                                  FROM  trs_mutasi_koreksi INNER JOIN mst_produk ON mst_produk.`Kode_Produk` = trs_mutasi_koreksi.`produk`
                                  WHERE   qty > 0 AND trs_mutasi_koreksi.status IN ('Open','Approve') and
                                    trs_mutasi_koreksi.`produk` = 'SLRDS1' and 
                                        CASE WHEN trs_mutasi_koreksi.`Status` = 'Open' THEN
                                          tanggal
                                       ELSE
                                          IFNULL(DATE(tgl_approve),tanggal)
                                       END between '2020-12-01 00:00:00' and '2020-12-23 23:59:59'
                                  UNION ALL
                                  SELECT NoDokumen AS 'NoDoc', 
                                         CONCAT('Mutasi Gudang dari Gudang : ', gudang_awal,' Ke Gudang : ',gudang_akhir,' ~ QTY = ',qty) AS 'Dokumen',
                                         tanggal AS 'TglDoc',
                                         trs_mutasi_gudang.create_date as 'TimeDoc',
                                         trs_mutasi_gudang.produk AS 'Kode' ,
                                         trs_mutasi_gudang.namaproduk AS 'NamaProduk' ,
                                         '' AS 'Unit',
                                         0 AS 'qty_in',
                                         0 AS 'qty_out',
                                         batchno_awal AS 'BatchNo',
                                         expdate_awal AS 'ExpDate'
                                  FROM  trs_mutasi_gudang INNER JOIN mst_produk ON mst_produk.`Kode_Produk` = trs_mutasi_gudang.`produk`
                                  WHERE   qty > 0 AND trs_mutasi_gudang.status IN ('Open','Approve') and
                                    trs_mutasi_gudang.`produk` = 'SLRDS1' and 
                                        tanggal between '2020-12-01 00:00:00' and '2020-12-23 23:59:59'
                                  UNION ALL

                                  SELECT no_koreksi AS 'NoDoc', 
                                         CONCAT('Adjusment (+) : QTY = ',qty,' ', catatan) AS 'Dokumen',
                                         IFNULL(DATE(tgl_approve),tanggal) AS 'TglDoc',
                                         trs_mutasi_koreksi.created_at as 'TimeDoc',
                                         trs_mutasi_koreksi.produk AS 'Kode' ,
                                         trs_mutasi_koreksi.nama_produk AS 'NamaProduk' ,
                                         Satuan AS 'Unit',
                                         0 AS 'qty_in',
                                         0 AS 'qty_out',
                                         batch AS 'BatchNo',
                                         exp_date AS 'ExpDate'
                                  FROM  trs_mutasi_koreksi INNER JOIN mst_produk ON mst_produk.`Kode_Produk` = trs_mutasi_koreksi.`produk`
                                  WHERE   qty > 0 AND trs_mutasi_koreksi.status = 'Approve' and
                                    trs_mutasi_koreksi.`produk` = 'SLRDS1' and 
                                        IFNULL(DATE(tgl_approve),tanggal) between '2020-12-01 00:00:00' and '2020-12-23 23:59:59'
                                  UNION ALL

                                  SELECT No_Terima AS 'NoDoc', 
                                         CONCAT('Relokasi Dari Cabang  : ', Cabang_Pengirim) AS 'Dokumen',
                                         Tgl_terima AS 'TglDoc',
                                         Time_terima as 'TimeDoc',
                                         Produk AS 'Kode' ,
                                         NamaProduk AS 'NamaProduk' ,
                                         Satuan AS 'Unit',
                                         (Qty+Bonus) AS 'qty_in',
                                         0 AS 'qty_out',
                                         BatchNo AS 'BatchNo',
                                         ExpDate AS 'ExpDate'
                                  FROM  trs_relokasi_terima_detail 
                                  WHERE   (Qty > 0 or Bonus > 0) AND
                                        Status = 'Terima' and
                                        Produk = 'SLRDS1' and 
                                        Tgl_terima between '2020-12-01 00:00:00' and '2020-12-23 23:59:59'
                                    
                                  UNION ALL 

                                  SELECT NoFaktur AS 'NoDoc',
                                        CONCAT('Terima dari ',Pelanggan, ' - ' ,NamaPelanggan) AS 'Dokumen',
                                        TglFaktur AS 'TglDoc',
                                        TimeFaktur as 'TimeDoc',
                                        KodeProduk AS 'Kode', 
                                        NamaProduk AS 'NamaProduk',
                                        UOM AS 'Unit',
                                        (QtyFaktur+BonusFaktur) AS 'qty_in',
                                        0 AS 'qty_out',
                                        BatchNo,
                                        ExpDate
                                  FROM trs_faktur_detail 
                                  WHERE TipeDokumen ='Retur' AND 
                                        ifnull(status,'') != 'Batal' and
                                        KodeProduk = 'SLRDS1' and 
                                        TglFaktur between '2020-12-01 00:00:00' and '2020-12-23 23:59:59'

                                  UNION ALL


                                  SELECT NoDO AS 'NoDoc',
                                    CONCAT('Kirim ke ',Pelanggan, ' - ' ,NamaPelanggan) AS 'Dokumen',  
                                    TglDO AS 'TglDoc',
                                    TimeDO AS 'TimeDoc',
                                    KodeProduk AS 'Kode',
                                    NamaProduk AS 'NamaProduk',
                                    UOM AS 'Unit',
                                    0 AS 'qty_in', 
                                    (QtyDO+BonusDO) AS 'qty_out',
                                    BatchNo,ExpDate
                                  FROM trs_delivery_order_sales_detail 
                                  WHERE KodeProduk = 'SLRDS1'  
                                    AND TglDO BETWEEN '2020-12-01 00:00:00' and '2020-12-23 23:59:59' and tipedokumen ='DO'
                                  UNION ALL
                                  SELECT NoDO AS 'NoDoc',
                                    CONCAT('Batal Kirim ke ',Pelanggan, ' - ' ,NamaPelanggan) AS 'Dokumen',  
                                    TglDO AS 'TglDoc',
                                    TimeDO AS 'TimeDoc',
                                    KodeProduk AS 'Kode',
                                    NamaProduk AS 'NamaProduk',
                                    UOM AS 'Unit',
                                    (QtyDO+BonusDO) AS 'qty_in', 
                                    0 AS 'qty_out',
                                    BatchNo,ExpDate
                                  FROM trs_delivery_order_sales_detail 
                                  WHERE KodeProduk = 'SLRDS1' 
                                    AND Status = 'Batal' 
                                    AND date(ifnull(time_batal,'')) BETWEEN '2020-12-01 00:00:00' and '2020-12-23 23:59:59'
                                  UNION ALL
                                  SELECT NoDO AS 'NoDoc',
                                    CONCAT('Retur Kirim dari ',Pelanggan, ' - ' ,NamaPelanggan) AS 'Dokumen',  
                                    TglDO AS 'TglDoc',
                                    TimeDO AS 'TimeDoc',
                                    KodeProduk AS 'Kode',
                                    NamaProduk AS 'NamaProduk',
                                    UOM AS 'Unit',
                                    (QtyDO+BonusDO) AS 'qty_in', 
                                    0 AS 'qty_out',
                                    BatchNo,ExpDate
                                  FROM trs_delivery_order_sales_detail 
                                  WHERE KodeProduk = 'SLRDS1' and 
                                        TipeDokumen ='Retur' and Status = 'Retur' 
                                    AND TglDO BETWEEN '2020-12-01 00:00:00' and '2020-12-23 23:59:59'
                                  UNION ALL

                                  SELECT trs_relokasi_kirim_detail.No_Relokasi AS 'NoDoc', 
                                        CASE WHEN Status = 'ApproveLog' THEN
                                         CONCAT('Relokasi ke Cabang  : ', trs_relokasi_kirim_detail.Cabang_Penerima)
                                        ELSE
                                          CONCAT('Relokasi ke Cabang  : ', trs_relokasi_kirim_detail.Cabang_Penerima)
                                        END
                                         AS 'Dokumen',
                                         CASE WHEN tgl_app IS NULL THEN trs_relokasi_kirim_detail.Tgl_kirim ELSE trs_relokasi_kirim_detail.tgl_app END AS 'TglDoc',
                                         CASE WHEN tgl_app IS NULL THEN trs_relokasi_kirim_detail.Time_kirim ELSE trs_relokasi_kirim_detail.App_BM_Time END  'TimeDoc',
                                         Produk AS 'Kode' ,
                                         NamaProduk AS 'NamaProduk' ,
                                         Satuan AS 'Unit',
                                         0 AS 'qty_in',
                                         CASE WHEN Status = 'ApproveLog' THEN
                                         0
                                         ELSE
                                         (Qty+Bonus)
                                         END AS 'qty_out',
                                         BatchNo AS 'BatchNo',
                                         ExpDate AS 'ExpDate'
                                  FROM  trs_relokasi_kirim_detail
                                  WHERE trs_relokasi_kirim_detail.Status IN ('Kirim','Reject','RejectPusat','RejectCabPenerima','ApproveLog') and
                                        trs_relokasi_kirim_detail.Produk = 'SLRDS1' and 
                                          CASE WHEN tgl_app IS NULL THEN trs_relokasi_kirim_detail.Tgl_kirim ELSE trs_relokasi_kirim_detail.tgl_app END
                                         between '2020-12-01 00:00:00' and '2020-12-23 23:59:59' 

                                  UNION ALL

                                  SELECT trs_relokasi_kirim_detail.No_Relokasi AS 'NoDoc', 
                                         CASE WHEN Keterangan_reject LIKE '%Penerima%' THEN
                                          'Relokasi Reject Cabang Penerima'
                                         ELSE 
                                           'Relokasi Reject Pusat'
                                         END AS 'Dokumen',
                                         trs_relokasi_kirim_detail.tgl_reject AS 'TglDoc',
                                         trs_relokasi_kirim_detail.Time_kirim 'TimeDoc',
                                         Produk AS 'Kode' ,
                                         NamaProduk AS 'NamaProduk' ,
                                         Satuan AS 'Unit',
                                         (Qty+Bonus) AS 'qty_in',
                                         0 AS 'qty_out',
                                         BatchNo AS 'BatchNo',
                                         ExpDate AS 'ExpDate'
                                  FROM  trs_relokasi_kirim_detail
                                  WHERE trs_relokasi_kirim_detail.Status = 'Reject' and
                                        trs_relokasi_kirim_detail.Produk = 'SLRDS1' and 
                                        trs_relokasi_kirim_detail.Tgl_reject between '2020-12-01 00:00:00' and '2020-12-23 23:59:59'

                                  UNION ALL

                                  SELECT trs_usulan_retur_beli_header.No_Usulan AS 'NoDoc', 
                                        CONCAT('Usulan Retur Beli : QTY = ',((trs_usulan_retur_beli_detail.Qty+trs_usulan_retur_beli_detail.Bonus) * -1),'  ~ Ke : ',trs_usulan_retur_beli_header.Prinsipal) AS 'Dokumen',
                                        trs_usulan_retur_beli_header.Tanggal AS 'TglDoc',
                                        trs_usulan_retur_beli_header.added_time as 'TimeDoc',
                                        trs_usulan_retur_beli_detail.Produk AS 'Kode' ,
                                        trs_usulan_retur_beli_detail.Nama_produk AS 'NamaProduk' ,
                                        trs_usulan_retur_beli_detail.Satuan AS 'Unit',
                                        0 AS 'qty_in',
                                        0 AS 'qty_out',
                                        trs_usulan_retur_beli_detail.BatchNo AS 'BatchNo',
                                        trs_usulan_retur_beli_detail.ExpDate AS 'ExpDate'
                                  FROM  trs_usulan_retur_beli_header INNER JOIN trs_usulan_retur_beli_detail ON trs_usulan_retur_beli_header.No_Usulan = trs_usulan_retur_beli_detail.No_Usulan 
                                  WHERE ifnull(trs_usulan_retur_beli_header.App_BM_Status,'') <> 'R' and
                                    trs_usulan_retur_beli_detail.Produk = 'SLRDS1'and 
                                        trs_usulan_retur_beli_header.tanggal between '2020-12-01 00:00:00' and '2020-12-23 23:59:59'

                                  UNION ALL

                                  SELECT trs_usulan_retur_beli_header.No_Usulan AS 'NoDoc', 
                                        CONCAT('Reject Usulan Beli Pusat : QTY = ',((trs_usulan_retur_beli_detail.Qty+trs_usulan_retur_beli_detail.Bonus) * -1),'  ~ Ke : ',trs_usulan_retur_beli_header.Prinsipal) AS 'Dokumen',
                                        trs_usulan_retur_beli_header.Tanggal AS 'TglDoc',
                                        trs_usulan_retur_beli_header.added_time as 'TimeDoc',
                                        trs_usulan_retur_beli_detail.Produk AS 'Kode' ,
                                        trs_usulan_retur_beli_detail.Nama_produk AS 'NamaProduk' ,
                                        trs_usulan_retur_beli_detail.Satuan AS 'Unit',
                                        0 AS 'qty_in',
                                        0 AS 'qty_out',
                                        trs_usulan_retur_beli_detail.BatchNo AS 'BatchNo',
                                        trs_usulan_retur_beli_detail.ExpDate AS 'ExpDate'
                                  FROM  trs_usulan_retur_beli_header INNER JOIN trs_usulan_retur_beli_detail ON trs_usulan_retur_beli_header.No_Usulan = trs_usulan_retur_beli_detail.No_Usulan 
                                  WHERE ifnull(trs_usulan_retur_beli_header.App_BM_Status,'') <> 'R' and ifnull(trs_usulan_retur_beli_header.App_Pst_Status,'') = 'Reject' and
                                    trs_usulan_retur_beli_detail.Produk = 'SLRDS1'and 
                                        trs_usulan_retur_beli_header.tanggal between '2020-12-01 00:00:00' and '2020-12-23 23:59:59'
                                  
                                  UNION ALL

                                  SELECT no_koreksi AS 'NoDoc', 
                                        CONCAT('Usulan Adjusment (-): QTY = ',(qty * -1),' ',catatan) AS 'Dokumen',
                                        tanggal AS 'TglDoc',
                                        trs_mutasi_koreksi.created_at as 'TimeDoc',
                                        trs_mutasi_koreksi.produk AS 'Kode' ,
                                        trs_mutasi_koreksi.nama_produk AS 'NamaProduk' ,
                                        Satuan AS 'Unit',
                                        0 AS 'qty_in',
                                        0 AS 'qty_out',
                                        batch AS 'BatchNo',
                                        exp_date AS 'ExpDate'
                                  FROM  trs_mutasi_koreksi INNER JOIN mst_produk ON mst_produk.`Kode_Produk` = trs_mutasi_koreksi.`produk`
                                  WHERE   qty < 0 AND trs_mutasi_koreksi.status IN ('Open','Approve') and
                                    trs_mutasi_koreksi.`produk` = 'SLRDS1'and 
                                        CASE WHEN trs_mutasi_koreksi.`Status` = 'Open' THEN
                                            tanggal
                                         ELSE
                                            IFNULL(DATE(tgl_approve),tanggal)
                                         END between '2020-12-01 00:00:00' and '2020-12-23 23:59:59'
                                        
                                  UNION ALL

                                  SELECT no_koreksi AS 'NoDoc', 
                                        CONCAT('Adjusment (-): ',catatan) AS 'Dokumen',
                                        IFNULL(DATE(tgl_approve),tanggal) AS 'TglDoc',
                                        trs_mutasi_koreksi.created_at as 'TimeDoc',
                                        trs_mutasi_koreksi.produk AS 'Kode' ,
                                        trs_mutasi_koreksi.nama_produk AS 'NamaProduk' ,
                                        Satuan AS 'Unit',
                                        0 AS 'qty_in',
                                        (qty * -1) AS 'qty_out',
                                        batch AS 'BatchNo',
                                        exp_date AS 'ExpDate'
                                  FROM  trs_mutasi_koreksi INNER JOIN mst_produk ON mst_produk.`Kode_Produk` = trs_mutasi_koreksi.`produk`
                                  WHERE   qty < 0 AND trs_mutasi_koreksi.status = 'Approve' and
                                    trs_mutasi_koreksi.`produk` = 'SLRDS1'and 
                                        IFNULL(DATE(tgl_approve),tanggal) between '2020-12-01 00:00:00' and '2020-12-23 23:59:59'
                                  
                                  UNION ALL 

                                  SELECT nodokumen AS 'NoDoc', 
                                        CONCAT('Mutasi Batch Dari Batch ',batchno_awal,' ke Batch ',batchno_akhir,' : QTY = ',qty) AS 'Dokumen',
                                        DATE(tanggal) AS 'TglDoc',
                                        create_date AS 'TimeDoc',
                                        trs_mutasi_batch.produk AS 'Kode' ,
                                        namaproduk AS 'NamaProduk' ,
                                        '' AS 'Unit',
                                        0 AS 'qty_in',
                                        0 AS 'qty_out',
                                        batchno_akhir AS 'BatchNo',
                                        expdate_akhir AS 'ExpDate'
                                  FROM  trs_mutasi_batch INNER JOIN mst_produk ON mst_produk.`Kode_Produk` = trs_mutasi_batch.`produk`
                                  WHERE    trs_mutasi_batch.status = 'Approve' AND
                                    trs_mutasi_batch.`produk` = 'SLRDS1'AND 
                                        DATE(tanggal) BETWEEN '2020-12-01 00:00:00' and '2020-12-23 23:59:59'
                                        
                                  ORDER BY TglDoc,TimeDoc,NoDoc ASC;
ERROR - 2020-12-23 14:29:39 --> Severity: error --> Exception: Call to a member function result() on boolean D:\xampp70\htdocs\sstcabang\application\models\pembelian\Model_inventori.php 1083
ERROR - 2020-12-23 14:29:39 --> Cabang
ERROR - 2020-12-23 14:29:40 --> Query error: Unknown column 'trs_usulan_retur_beli_header.App_Pst_Status' in 'where clause' - Invalid query: SELECT NoDokumen AS 'NoDoc',
                                          CONCAT('Terima dari ',Prinsipal,' - ',Supplier) AS 'Dokumen',
                                          TglDokumen AS 'TglDoc',
                                          TimeDokumen as 'TimeDoc',
                                          Produk AS 'Kode',
                                          NamaProduk AS 'NamaProduk',
                                          Satuan AS 'Unit',
                                          (ifnull(Qty,'') + ifnull(Bonus,'')) AS 'qty_in',
                                          0 AS 'qty_out',
                                          BatchNo,
                                          ExpDate
                                  FROM trs_terima_barang_detail
                                  WHERE trs_terima_barang_detail.Produk = 'SLRDS1' and 
                                        Status not in ('pending','Batal') and
                                        ifnull(Tipe,'') not in  ('BKB','Tolakan') and
                                        TglDokumen between '2020-12-01 00:00:00' and '2020-12-23 23:59:59'
                                  
                                  UNION ALL

                                  SELECT NoDokumen AS 'NoDoc',
                                          CONCAT('Retur Ke ',Prinsipal,' - ',Supplier) AS 'Dokumen',
                                          TglDokumen AS 'TglDoc',
                                          TimeDokumen as 'TimeDoc',
                                          Produk AS 'Kode',
                                          NamaProduk AS 'NamaProduk',
                                          Satuan AS 'Unit',
                                          0 AS 'qty_in',
                                          (((ifnull(Qty,'') + ifnull(Bonus,'')))*-1) AS 'qty_out',
                                          BatchNo,
                                          ExpDate
                                  FROM trs_terima_barang_detail
                                  where   ifnull(Tipe,'') = 'BKB' and Produk = 'SLRDS1' and 
                                        TglDokumen between '2020-12-01 00:00:00' and '2020-12-23 23:59:59'
                                  
                                  UNION ALL
                                  SELECT NoDokumen AS 'NoDoc',
                                          CONCAT('Tolakan Retur ',Prinsipal,' - ',Supplier,' ~ Qty : ', (ifnull(Qty,'') + ifnull(Bonus,''))*-1) AS 'Dokumen',
                                          TglDokumen AS 'TglDoc',
                                          TimeDokumen as 'TimeDoc',
                                          Produk AS 'Kode',
                                          NamaProduk AS 'NamaProduk',
                                          Satuan AS 'Unit',
                                          0 AS 'qty_in',
                                          0 AS 'qty_out',
                                          BatchNo,
                                          ExpDate
                                  FROM trs_terima_barang_detail
                                  where   ifnull(Tipe,'') = 'Tolakan' and Produk = 'SLRDS1' and 
                                        TglDokumen between '2020-12-01 00:00:00' and '2020-12-23 23:59:59'

                                  UNION ALL
                                  SELECT no_koreksi AS 'NoDoc', 
                                         CONCAT('Usulan Adjusment (+) : ', catatan) AS 'Dokumen',
                                         tanggal AS 'TglDoc',
                                         trs_mutasi_koreksi.created_at as 'TimeDoc',
                                         trs_mutasi_koreksi.produk AS 'Kode' ,
                                         trs_mutasi_koreksi.nama_produk AS 'NamaProduk' ,
                                         Satuan AS 'Unit',
                                         qty AS 'qty_in',
                                         0 AS 'qty_out',
                                         batch AS 'BatchNo',
                                         exp_date AS 'ExpDate'
                                  FROM  trs_mutasi_koreksi INNER JOIN mst_produk ON mst_produk.`Kode_Produk` = trs_mutasi_koreksi.`produk`
                                  WHERE   qty > 0 AND trs_mutasi_koreksi.status IN ('Open','Approve') and
                                    trs_mutasi_koreksi.`produk` = 'SLRDS1' and 
                                        CASE WHEN trs_mutasi_koreksi.`Status` = 'Open' THEN
                                          tanggal
                                       ELSE
                                          IFNULL(DATE(tgl_approve),tanggal)
                                       END between '2020-12-01 00:00:00' and '2020-12-23 23:59:59'
                                  UNION ALL
                                  SELECT NoDokumen AS 'NoDoc', 
                                         CONCAT('Mutasi Gudang dari Gudang : ', gudang_awal,' Ke Gudang : ',gudang_akhir,' ~ QTY = ',qty) AS 'Dokumen',
                                         tanggal AS 'TglDoc',
                                         trs_mutasi_gudang.create_date as 'TimeDoc',
                                         trs_mutasi_gudang.produk AS 'Kode' ,
                                         trs_mutasi_gudang.namaproduk AS 'NamaProduk' ,
                                         '' AS 'Unit',
                                         0 AS 'qty_in',
                                         0 AS 'qty_out',
                                         batchno_awal AS 'BatchNo',
                                         expdate_awal AS 'ExpDate'
                                  FROM  trs_mutasi_gudang INNER JOIN mst_produk ON mst_produk.`Kode_Produk` = trs_mutasi_gudang.`produk`
                                  WHERE   qty > 0 AND trs_mutasi_gudang.status IN ('Open','Approve') and
                                    trs_mutasi_gudang.`produk` = 'SLRDS1' and 
                                        tanggal between '2020-12-01 00:00:00' and '2020-12-23 23:59:59'
                                  UNION ALL

                                  SELECT no_koreksi AS 'NoDoc', 
                                         CONCAT('Adjusment (+) : QTY = ',qty,' ', catatan) AS 'Dokumen',
                                         IFNULL(DATE(tgl_approve),tanggal) AS 'TglDoc',
                                         trs_mutasi_koreksi.created_at as 'TimeDoc',
                                         trs_mutasi_koreksi.produk AS 'Kode' ,
                                         trs_mutasi_koreksi.nama_produk AS 'NamaProduk' ,
                                         Satuan AS 'Unit',
                                         0 AS 'qty_in',
                                         0 AS 'qty_out',
                                         batch AS 'BatchNo',
                                         exp_date AS 'ExpDate'
                                  FROM  trs_mutasi_koreksi INNER JOIN mst_produk ON mst_produk.`Kode_Produk` = trs_mutasi_koreksi.`produk`
                                  WHERE   qty > 0 AND trs_mutasi_koreksi.status = 'Approve' and
                                    trs_mutasi_koreksi.`produk` = 'SLRDS1' and 
                                        IFNULL(DATE(tgl_approve),tanggal) between '2020-12-01 00:00:00' and '2020-12-23 23:59:59'
                                  UNION ALL

                                  SELECT No_Terima AS 'NoDoc', 
                                         CONCAT('Relokasi Dari Cabang  : ', Cabang_Pengirim) AS 'Dokumen',
                                         Tgl_terima AS 'TglDoc',
                                         Time_terima as 'TimeDoc',
                                         Produk AS 'Kode' ,
                                         NamaProduk AS 'NamaProduk' ,
                                         Satuan AS 'Unit',
                                         (Qty+Bonus) AS 'qty_in',
                                         0 AS 'qty_out',
                                         BatchNo AS 'BatchNo',
                                         ExpDate AS 'ExpDate'
                                  FROM  trs_relokasi_terima_detail 
                                  WHERE   (Qty > 0 or Bonus > 0) AND
                                        Status = 'Terima' and
                                        Produk = 'SLRDS1' and 
                                        Tgl_terima between '2020-12-01 00:00:00' and '2020-12-23 23:59:59'
                                    
                                  UNION ALL 

                                  SELECT NoFaktur AS 'NoDoc',
                                        CONCAT('Terima dari ',Pelanggan, ' - ' ,NamaPelanggan) AS 'Dokumen',
                                        TglFaktur AS 'TglDoc',
                                        TimeFaktur as 'TimeDoc',
                                        KodeProduk AS 'Kode', 
                                        NamaProduk AS 'NamaProduk',
                                        UOM AS 'Unit',
                                        (QtyFaktur+BonusFaktur) AS 'qty_in',
                                        0 AS 'qty_out',
                                        BatchNo,
                                        ExpDate
                                  FROM trs_faktur_detail 
                                  WHERE TipeDokumen ='Retur' AND 
                                        ifnull(status,'') != 'Batal' and
                                        KodeProduk = 'SLRDS1' and 
                                        TglFaktur between '2020-12-01 00:00:00' and '2020-12-23 23:59:59'

                                  UNION ALL


                                  SELECT NoDO AS 'NoDoc',
                                    CONCAT('Kirim ke ',Pelanggan, ' - ' ,NamaPelanggan) AS 'Dokumen',  
                                    TglDO AS 'TglDoc',
                                    TimeDO AS 'TimeDoc',
                                    KodeProduk AS 'Kode',
                                    NamaProduk AS 'NamaProduk',
                                    UOM AS 'Unit',
                                    0 AS 'qty_in', 
                                    (QtyDO+BonusDO) AS 'qty_out',
                                    BatchNo,ExpDate
                                  FROM trs_delivery_order_sales_detail 
                                  WHERE KodeProduk = 'SLRDS1'  
                                    AND TglDO BETWEEN '2020-12-01 00:00:00' and '2020-12-23 23:59:59' and tipedokumen ='DO'
                                  UNION ALL
                                  SELECT NoDO AS 'NoDoc',
                                    CONCAT('Batal Kirim ke ',Pelanggan, ' - ' ,NamaPelanggan) AS 'Dokumen',  
                                    TglDO AS 'TglDoc',
                                    TimeDO AS 'TimeDoc',
                                    KodeProduk AS 'Kode',
                                    NamaProduk AS 'NamaProduk',
                                    UOM AS 'Unit',
                                    (QtyDO+BonusDO) AS 'qty_in', 
                                    0 AS 'qty_out',
                                    BatchNo,ExpDate
                                  FROM trs_delivery_order_sales_detail 
                                  WHERE KodeProduk = 'SLRDS1' 
                                    AND Status = 'Batal' 
                                    AND date(ifnull(time_batal,'')) BETWEEN '2020-12-01 00:00:00' and '2020-12-23 23:59:59'
                                  UNION ALL
                                  SELECT NoDO AS 'NoDoc',
                                    CONCAT('Retur Kirim dari ',Pelanggan, ' - ' ,NamaPelanggan) AS 'Dokumen',  
                                    TglDO AS 'TglDoc',
                                    TimeDO AS 'TimeDoc',
                                    KodeProduk AS 'Kode',
                                    NamaProduk AS 'NamaProduk',
                                    UOM AS 'Unit',
                                    (QtyDO+BonusDO) AS 'qty_in', 
                                    0 AS 'qty_out',
                                    BatchNo,ExpDate
                                  FROM trs_delivery_order_sales_detail 
                                  WHERE KodeProduk = 'SLRDS1' and 
                                        TipeDokumen ='Retur' and Status = 'Retur' 
                                    AND TglDO BETWEEN '2020-12-01 00:00:00' and '2020-12-23 23:59:59'
                                  UNION ALL

                                  SELECT trs_relokasi_kirim_detail.No_Relokasi AS 'NoDoc', 
                                        CASE WHEN Status = 'ApproveLog' THEN
                                         CONCAT('Relokasi ke Cabang  : ', trs_relokasi_kirim_detail.Cabang_Penerima)
                                        ELSE
                                          CONCAT('Relokasi ke Cabang  : ', trs_relokasi_kirim_detail.Cabang_Penerima)
                                        END
                                         AS 'Dokumen',
                                         CASE WHEN tgl_app IS NULL THEN trs_relokasi_kirim_detail.Tgl_kirim ELSE trs_relokasi_kirim_detail.tgl_app END AS 'TglDoc',
                                         CASE WHEN tgl_app IS NULL THEN trs_relokasi_kirim_detail.Time_kirim ELSE trs_relokasi_kirim_detail.App_BM_Time END  'TimeDoc',
                                         Produk AS 'Kode' ,
                                         NamaProduk AS 'NamaProduk' ,
                                         Satuan AS 'Unit',
                                         0 AS 'qty_in',
                                         CASE WHEN Status = 'ApproveLog' THEN
                                         0
                                         ELSE
                                         (Qty+Bonus)
                                         END AS 'qty_out',
                                         BatchNo AS 'BatchNo',
                                         ExpDate AS 'ExpDate'
                                  FROM  trs_relokasi_kirim_detail
                                  WHERE trs_relokasi_kirim_detail.Status IN ('Kirim','Reject','RejectPusat','RejectCabPenerima','ApproveLog') and
                                        trs_relokasi_kirim_detail.Produk = 'SLRDS1' and 
                                          CASE WHEN tgl_app IS NULL THEN trs_relokasi_kirim_detail.Tgl_kirim ELSE trs_relokasi_kirim_detail.tgl_app END
                                         between '2020-12-01 00:00:00' and '2020-12-23 23:59:59' 

                                  UNION ALL

                                  SELECT trs_relokasi_kirim_detail.No_Relokasi AS 'NoDoc', 
                                         CASE WHEN Keterangan_reject LIKE '%Penerima%' THEN
                                          'Relokasi Reject Cabang Penerima'
                                         ELSE 
                                           'Relokasi Reject Pusat'
                                         END AS 'Dokumen',
                                         trs_relokasi_kirim_detail.tgl_reject AS 'TglDoc',
                                         trs_relokasi_kirim_detail.Time_kirim 'TimeDoc',
                                         Produk AS 'Kode' ,
                                         NamaProduk AS 'NamaProduk' ,
                                         Satuan AS 'Unit',
                                         (Qty+Bonus) AS 'qty_in',
                                         0 AS 'qty_out',
                                         BatchNo AS 'BatchNo',
                                         ExpDate AS 'ExpDate'
                                  FROM  trs_relokasi_kirim_detail
                                  WHERE trs_relokasi_kirim_detail.Status = 'Reject' and
                                        trs_relokasi_kirim_detail.Produk = 'SLRDS1' and 
                                        trs_relokasi_kirim_detail.Tgl_reject between '2020-12-01 00:00:00' and '2020-12-23 23:59:59'

                                  UNION ALL

                                  SELECT trs_usulan_retur_beli_header.No_Usulan AS 'NoDoc', 
                                        CONCAT('Usulan Retur Beli : QTY = ',((trs_usulan_retur_beli_detail.Qty+trs_usulan_retur_beli_detail.Bonus) * -1),'  ~ Ke : ',trs_usulan_retur_beli_header.Prinsipal) AS 'Dokumen',
                                        trs_usulan_retur_beli_header.Tanggal AS 'TglDoc',
                                        trs_usulan_retur_beli_header.added_time as 'TimeDoc',
                                        trs_usulan_retur_beli_detail.Produk AS 'Kode' ,
                                        trs_usulan_retur_beli_detail.Nama_produk AS 'NamaProduk' ,
                                        trs_usulan_retur_beli_detail.Satuan AS 'Unit',
                                        0 AS 'qty_in',
                                        0 AS 'qty_out',
                                        trs_usulan_retur_beli_detail.BatchNo AS 'BatchNo',
                                        trs_usulan_retur_beli_detail.ExpDate AS 'ExpDate'
                                  FROM  trs_usulan_retur_beli_header INNER JOIN trs_usulan_retur_beli_detail ON trs_usulan_retur_beli_header.No_Usulan = trs_usulan_retur_beli_detail.No_Usulan 
                                  WHERE ifnull(trs_usulan_retur_beli_header.App_BM_Status,'') <> 'R' and
                                    trs_usulan_retur_beli_detail.Produk = 'SLRDS1'and 
                                        trs_usulan_retur_beli_header.tanggal between '2020-12-01 00:00:00' and '2020-12-23 23:59:59'

                                  UNION ALL

                                  SELECT trs_usulan_retur_beli_header.No_Usulan AS 'NoDoc', 
                                        CONCAT('Reject Usulan Beli Pusat : QTY = ',((trs_usulan_retur_beli_detail.Qty+trs_usulan_retur_beli_detail.Bonus) * -1),'  ~ Ke : ',trs_usulan_retur_beli_header.Prinsipal) AS 'Dokumen',
                                        trs_usulan_retur_beli_header.Tanggal AS 'TglDoc',
                                        trs_usulan_retur_beli_header.added_time as 'TimeDoc',
                                        trs_usulan_retur_beli_detail.Produk AS 'Kode' ,
                                        trs_usulan_retur_beli_detail.Nama_produk AS 'NamaProduk' ,
                                        trs_usulan_retur_beli_detail.Satuan AS 'Unit',
                                        0 AS 'qty_in',
                                        0 AS 'qty_out',
                                        trs_usulan_retur_beli_detail.BatchNo AS 'BatchNo',
                                        trs_usulan_retur_beli_detail.ExpDate AS 'ExpDate'
                                  FROM  trs_usulan_retur_beli_header INNER JOIN trs_usulan_retur_beli_detail ON trs_usulan_retur_beli_header.No_Usulan = trs_usulan_retur_beli_detail.No_Usulan 
                                  WHERE ifnull(trs_usulan_retur_beli_header.App_BM_Status,'') <> 'R' and ifnull(trs_usulan_retur_beli_header.App_Pst_Status,'') = 'Reject' and
                                    trs_usulan_retur_beli_detail.Produk = 'SLRDS1'and 
                                        trs_usulan_retur_beli_header.tanggal between '2020-12-01 00:00:00' and '2020-12-23 23:59:59'
                                  
                                  UNION ALL

                                  SELECT no_koreksi AS 'NoDoc', 
                                        CONCAT('Usulan Adjusment (-): QTY = ',(qty * -1),' ',catatan) AS 'Dokumen',
                                        tanggal AS 'TglDoc',
                                        trs_mutasi_koreksi.created_at as 'TimeDoc',
                                        trs_mutasi_koreksi.produk AS 'Kode' ,
                                        trs_mutasi_koreksi.nama_produk AS 'NamaProduk' ,
                                        Satuan AS 'Unit',
                                        0 AS 'qty_in',
                                        0 AS 'qty_out',
                                        batch AS 'BatchNo',
                                        exp_date AS 'ExpDate'
                                  FROM  trs_mutasi_koreksi INNER JOIN mst_produk ON mst_produk.`Kode_Produk` = trs_mutasi_koreksi.`produk`
                                  WHERE   qty < 0 AND trs_mutasi_koreksi.status IN ('Open','Approve') and
                                    trs_mutasi_koreksi.`produk` = 'SLRDS1'and 
                                        CASE WHEN trs_mutasi_koreksi.`Status` = 'Open' THEN
                                            tanggal
                                         ELSE
                                            IFNULL(DATE(tgl_approve),tanggal)
                                         END between '2020-12-01 00:00:00' and '2020-12-23 23:59:59'
                                        
                                  UNION ALL

                                  SELECT no_koreksi AS 'NoDoc', 
                                        CONCAT('Adjusment (-): ',catatan) AS 'Dokumen',
                                        IFNULL(DATE(tgl_approve),tanggal) AS 'TglDoc',
                                        trs_mutasi_koreksi.created_at as 'TimeDoc',
                                        trs_mutasi_koreksi.produk AS 'Kode' ,
                                        trs_mutasi_koreksi.nama_produk AS 'NamaProduk' ,
                                        Satuan AS 'Unit',
                                        0 AS 'qty_in',
                                        (qty * -1) AS 'qty_out',
                                        batch AS 'BatchNo',
                                        exp_date AS 'ExpDate'
                                  FROM  trs_mutasi_koreksi INNER JOIN mst_produk ON mst_produk.`Kode_Produk` = trs_mutasi_koreksi.`produk`
                                  WHERE   qty < 0 AND trs_mutasi_koreksi.status = 'Approve' and
                                    trs_mutasi_koreksi.`produk` = 'SLRDS1'and 
                                        IFNULL(DATE(tgl_approve),tanggal) between '2020-12-01 00:00:00' and '2020-12-23 23:59:59'
                                  
                                  UNION ALL 

                                  SELECT nodokumen AS 'NoDoc', 
                                        CONCAT('Mutasi Batch Dari Batch ',batchno_awal,' ke Batch ',batchno_akhir,' : QTY = ',qty) AS 'Dokumen',
                                        DATE(tanggal) AS 'TglDoc',
                                        create_date AS 'TimeDoc',
                                        trs_mutasi_batch.produk AS 'Kode' ,
                                        namaproduk AS 'NamaProduk' ,
                                        '' AS 'Unit',
                                        0 AS 'qty_in',
                                        0 AS 'qty_out',
                                        batchno_akhir AS 'BatchNo',
                                        expdate_akhir AS 'ExpDate'
                                  FROM  trs_mutasi_batch INNER JOIN mst_produk ON mst_produk.`Kode_Produk` = trs_mutasi_batch.`produk`
                                  WHERE    trs_mutasi_batch.status = 'Approve' AND
                                    trs_mutasi_batch.`produk` = 'SLRDS1'AND 
                                        DATE(tanggal) BETWEEN '2020-12-01 00:00:00' and '2020-12-23 23:59:59'
                                        
                                  ORDER BY TglDoc,TimeDoc,NoDoc ASC;
ERROR - 2020-12-23 14:29:40 --> Severity: error --> Exception: Call to a member function result() on boolean D:\xampp70\htdocs\sstcabang\application\models\pembelian\Model_inventori.php 1083
ERROR - 2020-12-23 14:29:42 --> Query error: Unknown column 'trs_usulan_retur_beli_header.App_Pst_Status' in 'where clause' - Invalid query: SELECT NoDokumen AS 'NoDoc',
                                          CONCAT('Terima dari ',Prinsipal,' - ',Supplier) AS 'Dokumen',
                                          TglDokumen AS 'TglDoc',
                                          TimeDokumen as 'TimeDoc',
                                          Produk AS 'Kode',
                                          NamaProduk AS 'NamaProduk',
                                          Satuan AS 'Unit',
                                          (ifnull(Qty,'') + ifnull(Bonus,'')) AS 'qty_in',
                                          0 AS 'qty_out',
                                          BatchNo,
                                          ExpDate
                                  FROM trs_terima_barang_detail
                                  WHERE trs_terima_barang_detail.Produk = 'SLRDS1' and 
                                        Status not in ('pending','Batal') and
                                        ifnull(Tipe,'') not in  ('BKB','Tolakan') and
                                        TglDokumen between '2020-12-01 00:00:00' and '2020-12-23 23:59:59'
                                  
                                  UNION ALL

                                  SELECT NoDokumen AS 'NoDoc',
                                          CONCAT('Retur Ke ',Prinsipal,' - ',Supplier) AS 'Dokumen',
                                          TglDokumen AS 'TglDoc',
                                          TimeDokumen as 'TimeDoc',
                                          Produk AS 'Kode',
                                          NamaProduk AS 'NamaProduk',
                                          Satuan AS 'Unit',
                                          0 AS 'qty_in',
                                          (((ifnull(Qty,'') + ifnull(Bonus,'')))*-1) AS 'qty_out',
                                          BatchNo,
                                          ExpDate
                                  FROM trs_terima_barang_detail
                                  where   ifnull(Tipe,'') = 'BKB' and Produk = 'SLRDS1' and 
                                        TglDokumen between '2020-12-01 00:00:00' and '2020-12-23 23:59:59'
                                  
                                  UNION ALL
                                  SELECT NoDokumen AS 'NoDoc',
                                          CONCAT('Tolakan Retur ',Prinsipal,' - ',Supplier,' ~ Qty : ', (ifnull(Qty,'') + ifnull(Bonus,''))*-1) AS 'Dokumen',
                                          TglDokumen AS 'TglDoc',
                                          TimeDokumen as 'TimeDoc',
                                          Produk AS 'Kode',
                                          NamaProduk AS 'NamaProduk',
                                          Satuan AS 'Unit',
                                          0 AS 'qty_in',
                                          0 AS 'qty_out',
                                          BatchNo,
                                          ExpDate
                                  FROM trs_terima_barang_detail
                                  where   ifnull(Tipe,'') = 'Tolakan' and Produk = 'SLRDS1' and 
                                        TglDokumen between '2020-12-01 00:00:00' and '2020-12-23 23:59:59'

                                  UNION ALL
                                  SELECT no_koreksi AS 'NoDoc', 
                                         CONCAT('Usulan Adjusment (+) : ', catatan) AS 'Dokumen',
                                         tanggal AS 'TglDoc',
                                         trs_mutasi_koreksi.created_at as 'TimeDoc',
                                         trs_mutasi_koreksi.produk AS 'Kode' ,
                                         trs_mutasi_koreksi.nama_produk AS 'NamaProduk' ,
                                         Satuan AS 'Unit',
                                         qty AS 'qty_in',
                                         0 AS 'qty_out',
                                         batch AS 'BatchNo',
                                         exp_date AS 'ExpDate'
                                  FROM  trs_mutasi_koreksi INNER JOIN mst_produk ON mst_produk.`Kode_Produk` = trs_mutasi_koreksi.`produk`
                                  WHERE   qty > 0 AND trs_mutasi_koreksi.status IN ('Open','Approve') and
                                    trs_mutasi_koreksi.`produk` = 'SLRDS1' and 
                                        CASE WHEN trs_mutasi_koreksi.`Status` = 'Open' THEN
                                          tanggal
                                       ELSE
                                          IFNULL(DATE(tgl_approve),tanggal)
                                       END between '2020-12-01 00:00:00' and '2020-12-23 23:59:59'
                                  UNION ALL
                                  SELECT NoDokumen AS 'NoDoc', 
                                         CONCAT('Mutasi Gudang dari Gudang : ', gudang_awal,' Ke Gudang : ',gudang_akhir,' ~ QTY = ',qty) AS 'Dokumen',
                                         tanggal AS 'TglDoc',
                                         trs_mutasi_gudang.create_date as 'TimeDoc',
                                         trs_mutasi_gudang.produk AS 'Kode' ,
                                         trs_mutasi_gudang.namaproduk AS 'NamaProduk' ,
                                         '' AS 'Unit',
                                         0 AS 'qty_in',
                                         0 AS 'qty_out',
                                         batchno_awal AS 'BatchNo',
                                         expdate_awal AS 'ExpDate'
                                  FROM  trs_mutasi_gudang INNER JOIN mst_produk ON mst_produk.`Kode_Produk` = trs_mutasi_gudang.`produk`
                                  WHERE   qty > 0 AND trs_mutasi_gudang.status IN ('Open','Approve') and
                                    trs_mutasi_gudang.`produk` = 'SLRDS1' and 
                                        tanggal between '2020-12-01 00:00:00' and '2020-12-23 23:59:59'
                                  UNION ALL

                                  SELECT no_koreksi AS 'NoDoc', 
                                         CONCAT('Adjusment (+) : QTY = ',qty,' ', catatan) AS 'Dokumen',
                                         IFNULL(DATE(tgl_approve),tanggal) AS 'TglDoc',
                                         trs_mutasi_koreksi.created_at as 'TimeDoc',
                                         trs_mutasi_koreksi.produk AS 'Kode' ,
                                         trs_mutasi_koreksi.nama_produk AS 'NamaProduk' ,
                                         Satuan AS 'Unit',
                                         0 AS 'qty_in',
                                         0 AS 'qty_out',
                                         batch AS 'BatchNo',
                                         exp_date AS 'ExpDate'
                                  FROM  trs_mutasi_koreksi INNER JOIN mst_produk ON mst_produk.`Kode_Produk` = trs_mutasi_koreksi.`produk`
                                  WHERE   qty > 0 AND trs_mutasi_koreksi.status = 'Approve' and
                                    trs_mutasi_koreksi.`produk` = 'SLRDS1' and 
                                        IFNULL(DATE(tgl_approve),tanggal) between '2020-12-01 00:00:00' and '2020-12-23 23:59:59'
                                  UNION ALL

                                  SELECT No_Terima AS 'NoDoc', 
                                         CONCAT('Relokasi Dari Cabang  : ', Cabang_Pengirim) AS 'Dokumen',
                                         Tgl_terima AS 'TglDoc',
                                         Time_terima as 'TimeDoc',
                                         Produk AS 'Kode' ,
                                         NamaProduk AS 'NamaProduk' ,
                                         Satuan AS 'Unit',
                                         (Qty+Bonus) AS 'qty_in',
                                         0 AS 'qty_out',
                                         BatchNo AS 'BatchNo',
                                         ExpDate AS 'ExpDate'
                                  FROM  trs_relokasi_terima_detail 
                                  WHERE   (Qty > 0 or Bonus > 0) AND
                                        Status = 'Terima' and
                                        Produk = 'SLRDS1' and 
                                        Tgl_terima between '2020-12-01 00:00:00' and '2020-12-23 23:59:59'
                                    
                                  UNION ALL 

                                  SELECT NoFaktur AS 'NoDoc',
                                        CONCAT('Terima dari ',Pelanggan, ' - ' ,NamaPelanggan) AS 'Dokumen',
                                        TglFaktur AS 'TglDoc',
                                        TimeFaktur as 'TimeDoc',
                                        KodeProduk AS 'Kode', 
                                        NamaProduk AS 'NamaProduk',
                                        UOM AS 'Unit',
                                        (QtyFaktur+BonusFaktur) AS 'qty_in',
                                        0 AS 'qty_out',
                                        BatchNo,
                                        ExpDate
                                  FROM trs_faktur_detail 
                                  WHERE TipeDokumen ='Retur' AND 
                                        ifnull(status,'') != 'Batal' and
                                        KodeProduk = 'SLRDS1' and 
                                        TglFaktur between '2020-12-01 00:00:00' and '2020-12-23 23:59:59'

                                  UNION ALL


                                  SELECT NoDO AS 'NoDoc',
                                    CONCAT('Kirim ke ',Pelanggan, ' - ' ,NamaPelanggan) AS 'Dokumen',  
                                    TglDO AS 'TglDoc',
                                    TimeDO AS 'TimeDoc',
                                    KodeProduk AS 'Kode',
                                    NamaProduk AS 'NamaProduk',
                                    UOM AS 'Unit',
                                    0 AS 'qty_in', 
                                    (QtyDO+BonusDO) AS 'qty_out',
                                    BatchNo,ExpDate
                                  FROM trs_delivery_order_sales_detail 
                                  WHERE KodeProduk = 'SLRDS1'  
                                    AND TglDO BETWEEN '2020-12-01 00:00:00' and '2020-12-23 23:59:59' and tipedokumen ='DO'
                                  UNION ALL
                                  SELECT NoDO AS 'NoDoc',
                                    CONCAT('Batal Kirim ke ',Pelanggan, ' - ' ,NamaPelanggan) AS 'Dokumen',  
                                    TglDO AS 'TglDoc',
                                    TimeDO AS 'TimeDoc',
                                    KodeProduk AS 'Kode',
                                    NamaProduk AS 'NamaProduk',
                                    UOM AS 'Unit',
                                    (QtyDO+BonusDO) AS 'qty_in', 
                                    0 AS 'qty_out',
                                    BatchNo,ExpDate
                                  FROM trs_delivery_order_sales_detail 
                                  WHERE KodeProduk = 'SLRDS1' 
                                    AND Status = 'Batal' 
                                    AND date(ifnull(time_batal,'')) BETWEEN '2020-12-01 00:00:00' and '2020-12-23 23:59:59'
                                  UNION ALL
                                  SELECT NoDO AS 'NoDoc',
                                    CONCAT('Retur Kirim dari ',Pelanggan, ' - ' ,NamaPelanggan) AS 'Dokumen',  
                                    TglDO AS 'TglDoc',
                                    TimeDO AS 'TimeDoc',
                                    KodeProduk AS 'Kode',
                                    NamaProduk AS 'NamaProduk',
                                    UOM AS 'Unit',
                                    (QtyDO+BonusDO) AS 'qty_in', 
                                    0 AS 'qty_out',
                                    BatchNo,ExpDate
                                  FROM trs_delivery_order_sales_detail 
                                  WHERE KodeProduk = 'SLRDS1' and 
                                        TipeDokumen ='Retur' and Status = 'Retur' 
                                    AND TglDO BETWEEN '2020-12-01 00:00:00' and '2020-12-23 23:59:59'
                                  UNION ALL

                                  SELECT trs_relokasi_kirim_detail.No_Relokasi AS 'NoDoc', 
                                        CASE WHEN Status = 'ApproveLog' THEN
                                         CONCAT('Relokasi ke Cabang  : ', trs_relokasi_kirim_detail.Cabang_Penerima)
                                        ELSE
                                          CONCAT('Relokasi ke Cabang  : ', trs_relokasi_kirim_detail.Cabang_Penerima)
                                        END
                                         AS 'Dokumen',
                                         CASE WHEN tgl_app IS NULL THEN trs_relokasi_kirim_detail.Tgl_kirim ELSE trs_relokasi_kirim_detail.tgl_app END AS 'TglDoc',
                                         CASE WHEN tgl_app IS NULL THEN trs_relokasi_kirim_detail.Time_kirim ELSE trs_relokasi_kirim_detail.App_BM_Time END  'TimeDoc',
                                         Produk AS 'Kode' ,
                                         NamaProduk AS 'NamaProduk' ,
                                         Satuan AS 'Unit',
                                         0 AS 'qty_in',
                                         CASE WHEN Status = 'ApproveLog' THEN
                                         0
                                         ELSE
                                         (Qty+Bonus)
                                         END AS 'qty_out',
                                         BatchNo AS 'BatchNo',
                                         ExpDate AS 'ExpDate'
                                  FROM  trs_relokasi_kirim_detail
                                  WHERE trs_relokasi_kirim_detail.Status IN ('Kirim','Reject','RejectPusat','RejectCabPenerima','ApproveLog') and
                                        trs_relokasi_kirim_detail.Produk = 'SLRDS1' and 
                                          CASE WHEN tgl_app IS NULL THEN trs_relokasi_kirim_detail.Tgl_kirim ELSE trs_relokasi_kirim_detail.tgl_app END
                                         between '2020-12-01 00:00:00' and '2020-12-23 23:59:59' 

                                  UNION ALL

                                  SELECT trs_relokasi_kirim_detail.No_Relokasi AS 'NoDoc', 
                                         CASE WHEN Keterangan_reject LIKE '%Penerima%' THEN
                                          'Relokasi Reject Cabang Penerima'
                                         ELSE 
                                           'Relokasi Reject Pusat'
                                         END AS 'Dokumen',
                                         trs_relokasi_kirim_detail.tgl_reject AS 'TglDoc',
                                         trs_relokasi_kirim_detail.Time_kirim 'TimeDoc',
                                         Produk AS 'Kode' ,
                                         NamaProduk AS 'NamaProduk' ,
                                         Satuan AS 'Unit',
                                         (Qty+Bonus) AS 'qty_in',
                                         0 AS 'qty_out',
                                         BatchNo AS 'BatchNo',
                                         ExpDate AS 'ExpDate'
                                  FROM  trs_relokasi_kirim_detail
                                  WHERE trs_relokasi_kirim_detail.Status = 'Reject' and
                                        trs_relokasi_kirim_detail.Produk = 'SLRDS1' and 
                                        trs_relokasi_kirim_detail.Tgl_reject between '2020-12-01 00:00:00' and '2020-12-23 23:59:59'

                                  UNION ALL

                                  SELECT trs_usulan_retur_beli_header.No_Usulan AS 'NoDoc', 
                                        CONCAT('Usulan Retur Beli : QTY = ',((trs_usulan_retur_beli_detail.Qty+trs_usulan_retur_beli_detail.Bonus) * -1),'  ~ Ke : ',trs_usulan_retur_beli_header.Prinsipal) AS 'Dokumen',
                                        trs_usulan_retur_beli_header.Tanggal AS 'TglDoc',
                                        trs_usulan_retur_beli_header.added_time as 'TimeDoc',
                                        trs_usulan_retur_beli_detail.Produk AS 'Kode' ,
                                        trs_usulan_retur_beli_detail.Nama_produk AS 'NamaProduk' ,
                                        trs_usulan_retur_beli_detail.Satuan AS 'Unit',
                                        0 AS 'qty_in',
                                        0 AS 'qty_out',
                                        trs_usulan_retur_beli_detail.BatchNo AS 'BatchNo',
                                        trs_usulan_retur_beli_detail.ExpDate AS 'ExpDate'
                                  FROM  trs_usulan_retur_beli_header INNER JOIN trs_usulan_retur_beli_detail ON trs_usulan_retur_beli_header.No_Usulan = trs_usulan_retur_beli_detail.No_Usulan 
                                  WHERE ifnull(trs_usulan_retur_beli_header.App_BM_Status,'') <> 'R' and
                                    trs_usulan_retur_beli_detail.Produk = 'SLRDS1'and 
                                        trs_usulan_retur_beli_header.tanggal between '2020-12-01 00:00:00' and '2020-12-23 23:59:59'

                                  UNION ALL

                                  SELECT trs_usulan_retur_beli_header.No_Usulan AS 'NoDoc', 
                                        CONCAT('Reject Usulan Beli Pusat : QTY = ',((trs_usulan_retur_beli_detail.Qty+trs_usulan_retur_beli_detail.Bonus) * -1),'  ~ Ke : ',trs_usulan_retur_beli_header.Prinsipal) AS 'Dokumen',
                                        trs_usulan_retur_beli_header.Tanggal AS 'TglDoc',
                                        trs_usulan_retur_beli_header.added_time as 'TimeDoc',
                                        trs_usulan_retur_beli_detail.Produk AS 'Kode' ,
                                        trs_usulan_retur_beli_detail.Nama_produk AS 'NamaProduk' ,
                                        trs_usulan_retur_beli_detail.Satuan AS 'Unit',
                                        0 AS 'qty_in',
                                        0 AS 'qty_out',
                                        trs_usulan_retur_beli_detail.BatchNo AS 'BatchNo',
                                        trs_usulan_retur_beli_detail.ExpDate AS 'ExpDate'
                                  FROM  trs_usulan_retur_beli_header INNER JOIN trs_usulan_retur_beli_detail ON trs_usulan_retur_beli_header.No_Usulan = trs_usulan_retur_beli_detail.No_Usulan 
                                  WHERE ifnull(trs_usulan_retur_beli_header.App_BM_Status,'') <> 'R' and ifnull(trs_usulan_retur_beli_header.App_Pst_Status,'') = 'Reject' and
                                    trs_usulan_retur_beli_detail.Produk = 'SLRDS1'and 
                                        trs_usulan_retur_beli_header.tanggal between '2020-12-01 00:00:00' and '2020-12-23 23:59:59'
                                  
                                  UNION ALL

                                  SELECT no_koreksi AS 'NoDoc', 
                                        CONCAT('Usulan Adjusment (-): QTY = ',(qty * -1),' ',catatan) AS 'Dokumen',
                                        tanggal AS 'TglDoc',
                                        trs_mutasi_koreksi.created_at as 'TimeDoc',
                                        trs_mutasi_koreksi.produk AS 'Kode' ,
                                        trs_mutasi_koreksi.nama_produk AS 'NamaProduk' ,
                                        Satuan AS 'Unit',
                                        0 AS 'qty_in',
                                        0 AS 'qty_out',
                                        batch AS 'BatchNo',
                                        exp_date AS 'ExpDate'
                                  FROM  trs_mutasi_koreksi INNER JOIN mst_produk ON mst_produk.`Kode_Produk` = trs_mutasi_koreksi.`produk`
                                  WHERE   qty < 0 AND trs_mutasi_koreksi.status IN ('Open','Approve') and
                                    trs_mutasi_koreksi.`produk` = 'SLRDS1'and 
                                        CASE WHEN trs_mutasi_koreksi.`Status` = 'Open' THEN
                                            tanggal
                                         ELSE
                                            IFNULL(DATE(tgl_approve),tanggal)
                                         END between '2020-12-01 00:00:00' and '2020-12-23 23:59:59'
                                        
                                  UNION ALL

                                  SELECT no_koreksi AS 'NoDoc', 
                                        CONCAT('Adjusment (-): ',catatan) AS 'Dokumen',
                                        IFNULL(DATE(tgl_approve),tanggal) AS 'TglDoc',
                                        trs_mutasi_koreksi.created_at as 'TimeDoc',
                                        trs_mutasi_koreksi.produk AS 'Kode' ,
                                        trs_mutasi_koreksi.nama_produk AS 'NamaProduk' ,
                                        Satuan AS 'Unit',
                                        0 AS 'qty_in',
                                        (qty * -1) AS 'qty_out',
                                        batch AS 'BatchNo',
                                        exp_date AS 'ExpDate'
                                  FROM  trs_mutasi_koreksi INNER JOIN mst_produk ON mst_produk.`Kode_Produk` = trs_mutasi_koreksi.`produk`
                                  WHERE   qty < 0 AND trs_mutasi_koreksi.status = 'Approve' and
                                    trs_mutasi_koreksi.`produk` = 'SLRDS1'and 
                                        IFNULL(DATE(tgl_approve),tanggal) between '2020-12-01 00:00:00' and '2020-12-23 23:59:59'
                                  
                                  UNION ALL 

                                  SELECT nodokumen AS 'NoDoc', 
                                        CONCAT('Mutasi Batch Dari Batch ',batchno_awal,' ke Batch ',batchno_akhir,' : QTY = ',qty) AS 'Dokumen',
                                        DATE(tanggal) AS 'TglDoc',
                                        create_date AS 'TimeDoc',
                                        trs_mutasi_batch.produk AS 'Kode' ,
                                        namaproduk AS 'NamaProduk' ,
                                        '' AS 'Unit',
                                        0 AS 'qty_in',
                                        0 AS 'qty_out',
                                        batchno_akhir AS 'BatchNo',
                                        expdate_akhir AS 'ExpDate'
                                  FROM  trs_mutasi_batch INNER JOIN mst_produk ON mst_produk.`Kode_Produk` = trs_mutasi_batch.`produk`
                                  WHERE    trs_mutasi_batch.status = 'Approve' AND
                                    trs_mutasi_batch.`produk` = 'SLRDS1'AND 
                                        DATE(tanggal) BETWEEN '2020-12-01 00:00:00' and '2020-12-23 23:59:59'
                                        
                                  ORDER BY TglDoc,TimeDoc,NoDoc ASC;
ERROR - 2020-12-23 14:29:42 --> Severity: error --> Exception: Call to a member function result() on boolean D:\xampp70\htdocs\sstcabang\application\models\pembelian\Model_inventori.php 1083
ERROR - 2020-12-23 14:31:02 --> 404 Page Not Found: /index
ERROR - 2020-12-23 14:31:20 --> Query error: Unknown column 'trs_usulan_retur_beli_header.App_Pst_Status' in 'where clause' - Invalid query: SELECT NoDokumen AS 'NoDoc',
                                          CONCAT('Terima dari ',Prinsipal,' - ',Supplier) AS 'Dokumen',
                                          TglDokumen AS 'TglDoc',
                                          TimeDokumen as 'TimeDoc',
                                          Produk AS 'Kode',
                                          NamaProduk AS 'NamaProduk',
                                          Satuan AS 'Unit',
                                          (ifnull(Qty,'') + ifnull(Bonus,'')) AS 'qty_in',
                                          0 AS 'qty_out',
                                          BatchNo,
                                          ExpDate
                                  FROM trs_terima_barang_detail
                                  WHERE trs_terima_barang_detail.Produk = 'SLRDS1' and 
                                        Status not in ('pending','Batal') and
                                        ifnull(Tipe,'') not in  ('BKB','Tolakan') and
                                        TglDokumen between '2020-12-01 00:00:00' and '2020-12-23 23:59:59'
                                  
                                  UNION ALL

                                  SELECT NoDokumen AS 'NoDoc',
                                          CONCAT('Retur Ke ',Prinsipal,' - ',Supplier) AS 'Dokumen',
                                          TglDokumen AS 'TglDoc',
                                          TimeDokumen as 'TimeDoc',
                                          Produk AS 'Kode',
                                          NamaProduk AS 'NamaProduk',
                                          Satuan AS 'Unit',
                                          0 AS 'qty_in',
                                          (((ifnull(Qty,'') + ifnull(Bonus,'')))*-1) AS 'qty_out',
                                          BatchNo,
                                          ExpDate
                                  FROM trs_terima_barang_detail
                                  where   ifnull(Tipe,'') = 'BKB' and Produk = 'SLRDS1' and 
                                        TglDokumen between '2020-12-01 00:00:00' and '2020-12-23 23:59:59'
                                  
                                  UNION ALL
                                  SELECT NoDokumen AS 'NoDoc',
                                          CONCAT('Tolakan Retur ',Prinsipal,' - ',Supplier,' ~ Qty : ', (ifnull(Qty,'') + ifnull(Bonus,''))*-1) AS 'Dokumen',
                                          TglDokumen AS 'TglDoc',
                                          TimeDokumen as 'TimeDoc',
                                          Produk AS 'Kode',
                                          NamaProduk AS 'NamaProduk',
                                          Satuan AS 'Unit',
                                          0 AS 'qty_in',
                                          0 AS 'qty_out',
                                          BatchNo,
                                          ExpDate
                                  FROM trs_terima_barang_detail
                                  where   ifnull(Tipe,'') = 'Tolakan' and Produk = 'SLRDS1' and 
                                        TglDokumen between '2020-12-01 00:00:00' and '2020-12-23 23:59:59'

                                  UNION ALL
                                  SELECT no_koreksi AS 'NoDoc', 
                                         CONCAT('Usulan Adjusment (+) : ', catatan) AS 'Dokumen',
                                         tanggal AS 'TglDoc',
                                         trs_mutasi_koreksi.created_at as 'TimeDoc',
                                         trs_mutasi_koreksi.produk AS 'Kode' ,
                                         trs_mutasi_koreksi.nama_produk AS 'NamaProduk' ,
                                         Satuan AS 'Unit',
                                         qty AS 'qty_in',
                                         0 AS 'qty_out',
                                         batch AS 'BatchNo',
                                         exp_date AS 'ExpDate'
                                  FROM  trs_mutasi_koreksi INNER JOIN mst_produk ON mst_produk.`Kode_Produk` = trs_mutasi_koreksi.`produk`
                                  WHERE   qty > 0 AND trs_mutasi_koreksi.status IN ('Open','Approve') and
                                    trs_mutasi_koreksi.`produk` = 'SLRDS1' and 
                                        CASE WHEN trs_mutasi_koreksi.`Status` = 'Open' THEN
                                          tanggal
                                       ELSE
                                          IFNULL(DATE(tgl_approve),tanggal)
                                       END between '2020-12-01 00:00:00' and '2020-12-23 23:59:59'
                                  UNION ALL
                                  SELECT NoDokumen AS 'NoDoc', 
                                         CONCAT('Mutasi Gudang dari Gudang : ', gudang_awal,' Ke Gudang : ',gudang_akhir,' ~ QTY = ',qty) AS 'Dokumen',
                                         tanggal AS 'TglDoc',
                                         trs_mutasi_gudang.create_date as 'TimeDoc',
                                         trs_mutasi_gudang.produk AS 'Kode' ,
                                         trs_mutasi_gudang.namaproduk AS 'NamaProduk' ,
                                         '' AS 'Unit',
                                         0 AS 'qty_in',
                                         0 AS 'qty_out',
                                         batchno_awal AS 'BatchNo',
                                         expdate_awal AS 'ExpDate'
                                  FROM  trs_mutasi_gudang INNER JOIN mst_produk ON mst_produk.`Kode_Produk` = trs_mutasi_gudang.`produk`
                                  WHERE   qty > 0 AND trs_mutasi_gudang.status IN ('Open','Approve') and
                                    trs_mutasi_gudang.`produk` = 'SLRDS1' and 
                                        tanggal between '2020-12-01 00:00:00' and '2020-12-23 23:59:59'
                                  UNION ALL

                                  SELECT no_koreksi AS 'NoDoc', 
                                         CONCAT('Adjusment (+) : QTY = ',qty,' ', catatan) AS 'Dokumen',
                                         IFNULL(DATE(tgl_approve),tanggal) AS 'TglDoc',
                                         trs_mutasi_koreksi.created_at as 'TimeDoc',
                                         trs_mutasi_koreksi.produk AS 'Kode' ,
                                         trs_mutasi_koreksi.nama_produk AS 'NamaProduk' ,
                                         Satuan AS 'Unit',
                                         0 AS 'qty_in',
                                         0 AS 'qty_out',
                                         batch AS 'BatchNo',
                                         exp_date AS 'ExpDate'
                                  FROM  trs_mutasi_koreksi INNER JOIN mst_produk ON mst_produk.`Kode_Produk` = trs_mutasi_koreksi.`produk`
                                  WHERE   qty > 0 AND trs_mutasi_koreksi.status = 'Approve' and
                                    trs_mutasi_koreksi.`produk` = 'SLRDS1' and 
                                        IFNULL(DATE(tgl_approve),tanggal) between '2020-12-01 00:00:00' and '2020-12-23 23:59:59'
                                  UNION ALL

                                  SELECT No_Terima AS 'NoDoc', 
                                         CONCAT('Relokasi Dari Cabang  : ', Cabang_Pengirim) AS 'Dokumen',
                                         Tgl_terima AS 'TglDoc',
                                         Time_terima as 'TimeDoc',
                                         Produk AS 'Kode' ,
                                         NamaProduk AS 'NamaProduk' ,
                                         Satuan AS 'Unit',
                                         (Qty+Bonus) AS 'qty_in',
                                         0 AS 'qty_out',
                                         BatchNo AS 'BatchNo',
                                         ExpDate AS 'ExpDate'
                                  FROM  trs_relokasi_terima_detail 
                                  WHERE   (Qty > 0 or Bonus > 0) AND
                                        Status = 'Terima' and
                                        Produk = 'SLRDS1' and 
                                        Tgl_terima between '2020-12-01 00:00:00' and '2020-12-23 23:59:59'
                                    
                                  UNION ALL 

                                  SELECT NoFaktur AS 'NoDoc',
                                        CONCAT('Terima dari ',Pelanggan, ' - ' ,NamaPelanggan) AS 'Dokumen',
                                        TglFaktur AS 'TglDoc',
                                        TimeFaktur as 'TimeDoc',
                                        KodeProduk AS 'Kode', 
                                        NamaProduk AS 'NamaProduk',
                                        UOM AS 'Unit',
                                        (QtyFaktur+BonusFaktur) AS 'qty_in',
                                        0 AS 'qty_out',
                                        BatchNo,
                                        ExpDate
                                  FROM trs_faktur_detail 
                                  WHERE TipeDokumen ='Retur' AND 
                                        ifnull(status,'') != 'Batal' and
                                        KodeProduk = 'SLRDS1' and 
                                        TglFaktur between '2020-12-01 00:00:00' and '2020-12-23 23:59:59'

                                  UNION ALL


                                  SELECT NoDO AS 'NoDoc',
                                    CONCAT('Kirim ke ',Pelanggan, ' - ' ,NamaPelanggan) AS 'Dokumen',  
                                    TglDO AS 'TglDoc',
                                    TimeDO AS 'TimeDoc',
                                    KodeProduk AS 'Kode',
                                    NamaProduk AS 'NamaProduk',
                                    UOM AS 'Unit',
                                    0 AS 'qty_in', 
                                    (QtyDO+BonusDO) AS 'qty_out',
                                    BatchNo,ExpDate
                                  FROM trs_delivery_order_sales_detail 
                                  WHERE KodeProduk = 'SLRDS1'  
                                    AND TglDO BETWEEN '2020-12-01 00:00:00' and '2020-12-23 23:59:59' and tipedokumen ='DO'
                                  UNION ALL
                                  SELECT NoDO AS 'NoDoc',
                                    CONCAT('Batal Kirim ke ',Pelanggan, ' - ' ,NamaPelanggan) AS 'Dokumen',  
                                    TglDO AS 'TglDoc',
                                    TimeDO AS 'TimeDoc',
                                    KodeProduk AS 'Kode',
                                    NamaProduk AS 'NamaProduk',
                                    UOM AS 'Unit',
                                    (QtyDO+BonusDO) AS 'qty_in', 
                                    0 AS 'qty_out',
                                    BatchNo,ExpDate
                                  FROM trs_delivery_order_sales_detail 
                                  WHERE KodeProduk = 'SLRDS1' 
                                    AND Status = 'Batal' 
                                    AND date(ifnull(time_batal,'')) BETWEEN '2020-12-01 00:00:00' and '2020-12-23 23:59:59'
                                  UNION ALL
                                  SELECT NoDO AS 'NoDoc',
                                    CONCAT('Retur Kirim dari ',Pelanggan, ' - ' ,NamaPelanggan) AS 'Dokumen',  
                                    TglDO AS 'TglDoc',
                                    TimeDO AS 'TimeDoc',
                                    KodeProduk AS 'Kode',
                                    NamaProduk AS 'NamaProduk',
                                    UOM AS 'Unit',
                                    (QtyDO+BonusDO) AS 'qty_in', 
                                    0 AS 'qty_out',
                                    BatchNo,ExpDate
                                  FROM trs_delivery_order_sales_detail 
                                  WHERE KodeProduk = 'SLRDS1' and 
                                        TipeDokumen ='Retur' and Status = 'Retur' 
                                    AND TglDO BETWEEN '2020-12-01 00:00:00' and '2020-12-23 23:59:59'
                                  UNION ALL

                                  SELECT trs_relokasi_kirim_detail.No_Relokasi AS 'NoDoc', 
                                        CASE WHEN Status = 'ApproveLog' THEN
                                         CONCAT('Relokasi ke Cabang  : ', trs_relokasi_kirim_detail.Cabang_Penerima)
                                        ELSE
                                          CONCAT('Relokasi ke Cabang  : ', trs_relokasi_kirim_detail.Cabang_Penerima)
                                        END
                                         AS 'Dokumen',
                                         CASE WHEN tgl_app IS NULL THEN trs_relokasi_kirim_detail.Tgl_kirim ELSE trs_relokasi_kirim_detail.tgl_app END AS 'TglDoc',
                                         CASE WHEN tgl_app IS NULL THEN trs_relokasi_kirim_detail.Time_kirim ELSE trs_relokasi_kirim_detail.App_BM_Time END  'TimeDoc',
                                         Produk AS 'Kode' ,
                                         NamaProduk AS 'NamaProduk' ,
                                         Satuan AS 'Unit',
                                         0 AS 'qty_in',
                                         CASE WHEN Status = 'ApproveLog' THEN
                                         0
                                         ELSE
                                         (Qty+Bonus)
                                         END AS 'qty_out',
                                         BatchNo AS 'BatchNo',
                                         ExpDate AS 'ExpDate'
                                  FROM  trs_relokasi_kirim_detail
                                  WHERE trs_relokasi_kirim_detail.Status IN ('Kirim','Reject','RejectPusat','RejectCabPenerima','ApproveLog') and
                                        trs_relokasi_kirim_detail.Produk = 'SLRDS1' and 
                                          CASE WHEN tgl_app IS NULL THEN trs_relokasi_kirim_detail.Tgl_kirim ELSE trs_relokasi_kirim_detail.tgl_app END
                                         between '2020-12-01 00:00:00' and '2020-12-23 23:59:59' 

                                  UNION ALL

                                  SELECT trs_relokasi_kirim_detail.No_Relokasi AS 'NoDoc', 
                                         CASE WHEN Keterangan_reject LIKE '%Penerima%' THEN
                                          'Relokasi Reject Cabang Penerima'
                                         ELSE 
                                           'Relokasi Reject Pusat'
                                         END AS 'Dokumen',
                                         trs_relokasi_kirim_detail.tgl_reject AS 'TglDoc',
                                         trs_relokasi_kirim_detail.Time_kirim 'TimeDoc',
                                         Produk AS 'Kode' ,
                                         NamaProduk AS 'NamaProduk' ,
                                         Satuan AS 'Unit',
                                         (Qty+Bonus) AS 'qty_in',
                                         0 AS 'qty_out',
                                         BatchNo AS 'BatchNo',
                                         ExpDate AS 'ExpDate'
                                  FROM  trs_relokasi_kirim_detail
                                  WHERE trs_relokasi_kirim_detail.Status = 'Reject' and
                                        trs_relokasi_kirim_detail.Produk = 'SLRDS1' and 
                                        trs_relokasi_kirim_detail.Tgl_reject between '2020-12-01 00:00:00' and '2020-12-23 23:59:59'

                                  UNION ALL

                                  SELECT trs_usulan_retur_beli_header.No_Usulan AS 'NoDoc', 
                                        CONCAT('Usulan Retur Beli : QTY = ',((trs_usulan_retur_beli_detail.Qty+trs_usulan_retur_beli_detail.Bonus) * -1),'  ~ Ke : ',trs_usulan_retur_beli_header.Prinsipal) AS 'Dokumen',
                                        trs_usulan_retur_beli_header.Tanggal AS 'TglDoc',
                                        trs_usulan_retur_beli_header.added_time as 'TimeDoc',
                                        trs_usulan_retur_beli_detail.Produk AS 'Kode' ,
                                        trs_usulan_retur_beli_detail.Nama_produk AS 'NamaProduk' ,
                                        trs_usulan_retur_beli_detail.Satuan AS 'Unit',
                                        0 AS 'qty_in',
                                        0 AS 'qty_out',
                                        trs_usulan_retur_beli_detail.BatchNo AS 'BatchNo',
                                        trs_usulan_retur_beli_detail.ExpDate AS 'ExpDate'
                                  FROM  trs_usulan_retur_beli_header INNER JOIN trs_usulan_retur_beli_detail ON trs_usulan_retur_beli_header.No_Usulan = trs_usulan_retur_beli_detail.No_Usulan 
                                  WHERE ifnull(trs_usulan_retur_beli_header.App_BM_Status,'') <> 'R' and
                                    trs_usulan_retur_beli_detail.Produk = 'SLRDS1'and 
                                        trs_usulan_retur_beli_header.tanggal between '2020-12-01 00:00:00' and '2020-12-23 23:59:59'

                                  UNION ALL

                                  SELECT trs_usulan_retur_beli_header.No_Usulan AS 'NoDoc', 
                                        CONCAT('Reject Usulan Beli Pusat : QTY = ',((trs_usulan_retur_beli_detail.Qty+trs_usulan_retur_beli_detail.Bonus) * -1),'  ~ Ke : ',trs_usulan_retur_beli_header.Prinsipal) AS 'Dokumen',
                                        trs_usulan_retur_beli_header.Tanggal AS 'TglDoc',
                                        trs_usulan_retur_beli_header.added_time as 'TimeDoc',
                                        trs_usulan_retur_beli_detail.Produk AS 'Kode' ,
                                        trs_usulan_retur_beli_detail.Nama_produk AS 'NamaProduk' ,
                                        trs_usulan_retur_beli_detail.Satuan AS 'Unit',
                                        0 AS 'qty_in',
                                        0 AS 'qty_out',
                                        trs_usulan_retur_beli_detail.BatchNo AS 'BatchNo',
                                        trs_usulan_retur_beli_detail.ExpDate AS 'ExpDate'
                                  FROM  trs_usulan_retur_beli_header INNER JOIN trs_usulan_retur_beli_detail ON trs_usulan_retur_beli_header.No_Usulan = trs_usulan_retur_beli_detail.No_Usulan 
                                  WHERE ifnull(trs_usulan_retur_beli_header.App_BM_Status,'') <> 'R' and ifnull(trs_usulan_retur_beli_header.App_Pst_Status,'') = 'Reject' and
                                    trs_usulan_retur_beli_detail.Produk = 'SLRDS1'and 
                                        trs_usulan_retur_beli_header.tanggal between '2020-12-01 00:00:00' and '2020-12-23 23:59:59'
                                  
                                  UNION ALL

                                  SELECT no_koreksi AS 'NoDoc', 
                                        CONCAT('Usulan Adjusment (-): QTY = ',(qty * -1),' ',catatan) AS 'Dokumen',
                                        tanggal AS 'TglDoc',
                                        trs_mutasi_koreksi.created_at as 'TimeDoc',
                                        trs_mutasi_koreksi.produk AS 'Kode' ,
                                        trs_mutasi_koreksi.nama_produk AS 'NamaProduk' ,
                                        Satuan AS 'Unit',
                                        0 AS 'qty_in',
                                        0 AS 'qty_out',
                                        batch AS 'BatchNo',
                                        exp_date AS 'ExpDate'
                                  FROM  trs_mutasi_koreksi INNER JOIN mst_produk ON mst_produk.`Kode_Produk` = trs_mutasi_koreksi.`produk`
                                  WHERE   qty < 0 AND trs_mutasi_koreksi.status IN ('Open','Approve') and
                                    trs_mutasi_koreksi.`produk` = 'SLRDS1'and 
                                        CASE WHEN trs_mutasi_koreksi.`Status` = 'Open' THEN
                                            tanggal
                                         ELSE
                                            IFNULL(DATE(tgl_approve),tanggal)
                                         END between '2020-12-01 00:00:00' and '2020-12-23 23:59:59'
                                        
                                  UNION ALL

                                  SELECT no_koreksi AS 'NoDoc', 
                                        CONCAT('Adjusment (-): ',catatan) AS 'Dokumen',
                                        IFNULL(DATE(tgl_approve),tanggal) AS 'TglDoc',
                                        trs_mutasi_koreksi.created_at as 'TimeDoc',
                                        trs_mutasi_koreksi.produk AS 'Kode' ,
                                        trs_mutasi_koreksi.nama_produk AS 'NamaProduk' ,
                                        Satuan AS 'Unit',
                                        0 AS 'qty_in',
                                        (qty * -1) AS 'qty_out',
                                        batch AS 'BatchNo',
                                        exp_date AS 'ExpDate'
                                  FROM  trs_mutasi_koreksi INNER JOIN mst_produk ON mst_produk.`Kode_Produk` = trs_mutasi_koreksi.`produk`
                                  WHERE   qty < 0 AND trs_mutasi_koreksi.status = 'Approve' and
                                    trs_mutasi_koreksi.`produk` = 'SLRDS1'and 
                                        IFNULL(DATE(tgl_approve),tanggal) between '2020-12-01 00:00:00' and '2020-12-23 23:59:59'
                                  
                                  UNION ALL 

                                  SELECT nodokumen AS 'NoDoc', 
                                        CONCAT('Mutasi Batch Dari Batch ',batchno_awal,' ke Batch ',batchno_akhir,' : QTY = ',qty) AS 'Dokumen',
                                        DATE(tanggal) AS 'TglDoc',
                                        create_date AS 'TimeDoc',
                                        trs_mutasi_batch.produk AS 'Kode' ,
                                        namaproduk AS 'NamaProduk' ,
                                        '' AS 'Unit',
                                        0 AS 'qty_in',
                                        0 AS 'qty_out',
                                        batchno_akhir AS 'BatchNo',
                                        expdate_akhir AS 'ExpDate'
                                  FROM  trs_mutasi_batch INNER JOIN mst_produk ON mst_produk.`Kode_Produk` = trs_mutasi_batch.`produk`
                                  WHERE    trs_mutasi_batch.status = 'Approve' AND
                                    trs_mutasi_batch.`produk` = 'SLRDS1'AND 
                                        DATE(tanggal) BETWEEN '2020-12-01 00:00:00' and '2020-12-23 23:59:59'
                                        
                                  ORDER BY TglDoc,TimeDoc,NoDoc ASC;
ERROR - 2020-12-23 14:31:20 --> Severity: error --> Exception: Call to a member function result() on boolean D:\xampp70\htdocs\sstcabang\application\models\pembelian\Model_inventori.php 1083
ERROR - 2020-12-23 14:31:20 --> Cabang
ERROR - 2020-12-23 14:31:21 --> Query error: Unknown column 'trs_usulan_retur_beli_header.App_Pst_Status' in 'where clause' - Invalid query: SELECT NoDokumen AS 'NoDoc',
                                          CONCAT('Terima dari ',Prinsipal,' - ',Supplier) AS 'Dokumen',
                                          TglDokumen AS 'TglDoc',
                                          TimeDokumen as 'TimeDoc',
                                          Produk AS 'Kode',
                                          NamaProduk AS 'NamaProduk',
                                          Satuan AS 'Unit',
                                          (ifnull(Qty,'') + ifnull(Bonus,'')) AS 'qty_in',
                                          0 AS 'qty_out',
                                          BatchNo,
                                          ExpDate
                                  FROM trs_terima_barang_detail
                                  WHERE trs_terima_barang_detail.Produk = 'SLRDS1' and 
                                        Status not in ('pending','Batal') and
                                        ifnull(Tipe,'') not in  ('BKB','Tolakan') and
                                        TglDokumen between '2020-12-01 00:00:00' and '2020-12-23 23:59:59'
                                  
                                  UNION ALL

                                  SELECT NoDokumen AS 'NoDoc',
                                          CONCAT('Retur Ke ',Prinsipal,' - ',Supplier) AS 'Dokumen',
                                          TglDokumen AS 'TglDoc',
                                          TimeDokumen as 'TimeDoc',
                                          Produk AS 'Kode',
                                          NamaProduk AS 'NamaProduk',
                                          Satuan AS 'Unit',
                                          0 AS 'qty_in',
                                          (((ifnull(Qty,'') + ifnull(Bonus,'')))*-1) AS 'qty_out',
                                          BatchNo,
                                          ExpDate
                                  FROM trs_terima_barang_detail
                                  where   ifnull(Tipe,'') = 'BKB' and Produk = 'SLRDS1' and 
                                        TglDokumen between '2020-12-01 00:00:00' and '2020-12-23 23:59:59'
                                  
                                  UNION ALL
                                  SELECT NoDokumen AS 'NoDoc',
                                          CONCAT('Tolakan Retur ',Prinsipal,' - ',Supplier,' ~ Qty : ', (ifnull(Qty,'') + ifnull(Bonus,''))*-1) AS 'Dokumen',
                                          TglDokumen AS 'TglDoc',
                                          TimeDokumen as 'TimeDoc',
                                          Produk AS 'Kode',
                                          NamaProduk AS 'NamaProduk',
                                          Satuan AS 'Unit',
                                          0 AS 'qty_in',
                                          0 AS 'qty_out',
                                          BatchNo,
                                          ExpDate
                                  FROM trs_terima_barang_detail
                                  where   ifnull(Tipe,'') = 'Tolakan' and Produk = 'SLRDS1' and 
                                        TglDokumen between '2020-12-01 00:00:00' and '2020-12-23 23:59:59'

                                  UNION ALL
                                  SELECT no_koreksi AS 'NoDoc', 
                                         CONCAT('Usulan Adjusment (+) : ', catatan) AS 'Dokumen',
                                         tanggal AS 'TglDoc',
                                         trs_mutasi_koreksi.created_at as 'TimeDoc',
                                         trs_mutasi_koreksi.produk AS 'Kode' ,
                                         trs_mutasi_koreksi.nama_produk AS 'NamaProduk' ,
                                         Satuan AS 'Unit',
                                         qty AS 'qty_in',
                                         0 AS 'qty_out',
                                         batch AS 'BatchNo',
                                         exp_date AS 'ExpDate'
                                  FROM  trs_mutasi_koreksi INNER JOIN mst_produk ON mst_produk.`Kode_Produk` = trs_mutasi_koreksi.`produk`
                                  WHERE   qty > 0 AND trs_mutasi_koreksi.status IN ('Open','Approve') and
                                    trs_mutasi_koreksi.`produk` = 'SLRDS1' and 
                                        CASE WHEN trs_mutasi_koreksi.`Status` = 'Open' THEN
                                          tanggal
                                       ELSE
                                          IFNULL(DATE(tgl_approve),tanggal)
                                       END between '2020-12-01 00:00:00' and '2020-12-23 23:59:59'
                                  UNION ALL
                                  SELECT NoDokumen AS 'NoDoc', 
                                         CONCAT('Mutasi Gudang dari Gudang : ', gudang_awal,' Ke Gudang : ',gudang_akhir,' ~ QTY = ',qty) AS 'Dokumen',
                                         tanggal AS 'TglDoc',
                                         trs_mutasi_gudang.create_date as 'TimeDoc',
                                         trs_mutasi_gudang.produk AS 'Kode' ,
                                         trs_mutasi_gudang.namaproduk AS 'NamaProduk' ,
                                         '' AS 'Unit',
                                         0 AS 'qty_in',
                                         0 AS 'qty_out',
                                         batchno_awal AS 'BatchNo',
                                         expdate_awal AS 'ExpDate'
                                  FROM  trs_mutasi_gudang INNER JOIN mst_produk ON mst_produk.`Kode_Produk` = trs_mutasi_gudang.`produk`
                                  WHERE   qty > 0 AND trs_mutasi_gudang.status IN ('Open','Approve') and
                                    trs_mutasi_gudang.`produk` = 'SLRDS1' and 
                                        tanggal between '2020-12-01 00:00:00' and '2020-12-23 23:59:59'
                                  UNION ALL

                                  SELECT no_koreksi AS 'NoDoc', 
                                         CONCAT('Adjusment (+) : QTY = ',qty,' ', catatan) AS 'Dokumen',
                                         IFNULL(DATE(tgl_approve),tanggal) AS 'TglDoc',
                                         trs_mutasi_koreksi.created_at as 'TimeDoc',
                                         trs_mutasi_koreksi.produk AS 'Kode' ,
                                         trs_mutasi_koreksi.nama_produk AS 'NamaProduk' ,
                                         Satuan AS 'Unit',
                                         0 AS 'qty_in',
                                         0 AS 'qty_out',
                                         batch AS 'BatchNo',
                                         exp_date AS 'ExpDate'
                                  FROM  trs_mutasi_koreksi INNER JOIN mst_produk ON mst_produk.`Kode_Produk` = trs_mutasi_koreksi.`produk`
                                  WHERE   qty > 0 AND trs_mutasi_koreksi.status = 'Approve' and
                                    trs_mutasi_koreksi.`produk` = 'SLRDS1' and 
                                        IFNULL(DATE(tgl_approve),tanggal) between '2020-12-01 00:00:00' and '2020-12-23 23:59:59'
                                  UNION ALL

                                  SELECT No_Terima AS 'NoDoc', 
                                         CONCAT('Relokasi Dari Cabang  : ', Cabang_Pengirim) AS 'Dokumen',
                                         Tgl_terima AS 'TglDoc',
                                         Time_terima as 'TimeDoc',
                                         Produk AS 'Kode' ,
                                         NamaProduk AS 'NamaProduk' ,
                                         Satuan AS 'Unit',
                                         (Qty+Bonus) AS 'qty_in',
                                         0 AS 'qty_out',
                                         BatchNo AS 'BatchNo',
                                         ExpDate AS 'ExpDate'
                                  FROM  trs_relokasi_terima_detail 
                                  WHERE   (Qty > 0 or Bonus > 0) AND
                                        Status = 'Terima' and
                                        Produk = 'SLRDS1' and 
                                        Tgl_terima between '2020-12-01 00:00:00' and '2020-12-23 23:59:59'
                                    
                                  UNION ALL 

                                  SELECT NoFaktur AS 'NoDoc',
                                        CONCAT('Terima dari ',Pelanggan, ' - ' ,NamaPelanggan) AS 'Dokumen',
                                        TglFaktur AS 'TglDoc',
                                        TimeFaktur as 'TimeDoc',
                                        KodeProduk AS 'Kode', 
                                        NamaProduk AS 'NamaProduk',
                                        UOM AS 'Unit',
                                        (QtyFaktur+BonusFaktur) AS 'qty_in',
                                        0 AS 'qty_out',
                                        BatchNo,
                                        ExpDate
                                  FROM trs_faktur_detail 
                                  WHERE TipeDokumen ='Retur' AND 
                                        ifnull(status,'') != 'Batal' and
                                        KodeProduk = 'SLRDS1' and 
                                        TglFaktur between '2020-12-01 00:00:00' and '2020-12-23 23:59:59'

                                  UNION ALL


                                  SELECT NoDO AS 'NoDoc',
                                    CONCAT('Kirim ke ',Pelanggan, ' - ' ,NamaPelanggan) AS 'Dokumen',  
                                    TglDO AS 'TglDoc',
                                    TimeDO AS 'TimeDoc',
                                    KodeProduk AS 'Kode',
                                    NamaProduk AS 'NamaProduk',
                                    UOM AS 'Unit',
                                    0 AS 'qty_in', 
                                    (QtyDO+BonusDO) AS 'qty_out',
                                    BatchNo,ExpDate
                                  FROM trs_delivery_order_sales_detail 
                                  WHERE KodeProduk = 'SLRDS1'  
                                    AND TglDO BETWEEN '2020-12-01 00:00:00' and '2020-12-23 23:59:59' and tipedokumen ='DO'
                                  UNION ALL
                                  SELECT NoDO AS 'NoDoc',
                                    CONCAT('Batal Kirim ke ',Pelanggan, ' - ' ,NamaPelanggan) AS 'Dokumen',  
                                    TglDO AS 'TglDoc',
                                    TimeDO AS 'TimeDoc',
                                    KodeProduk AS 'Kode',
                                    NamaProduk AS 'NamaProduk',
                                    UOM AS 'Unit',
                                    (QtyDO+BonusDO) AS 'qty_in', 
                                    0 AS 'qty_out',
                                    BatchNo,ExpDate
                                  FROM trs_delivery_order_sales_detail 
                                  WHERE KodeProduk = 'SLRDS1' 
                                    AND Status = 'Batal' 
                                    AND date(ifnull(time_batal,'')) BETWEEN '2020-12-01 00:00:00' and '2020-12-23 23:59:59'
                                  UNION ALL
                                  SELECT NoDO AS 'NoDoc',
                                    CONCAT('Retur Kirim dari ',Pelanggan, ' - ' ,NamaPelanggan) AS 'Dokumen',  
                                    TglDO AS 'TglDoc',
                                    TimeDO AS 'TimeDoc',
                                    KodeProduk AS 'Kode',
                                    NamaProduk AS 'NamaProduk',
                                    UOM AS 'Unit',
                                    (QtyDO+BonusDO) AS 'qty_in', 
                                    0 AS 'qty_out',
                                    BatchNo,ExpDate
                                  FROM trs_delivery_order_sales_detail 
                                  WHERE KodeProduk = 'SLRDS1' and 
                                        TipeDokumen ='Retur' and Status = 'Retur' 
                                    AND TglDO BETWEEN '2020-12-01 00:00:00' and '2020-12-23 23:59:59'
                                  UNION ALL

                                  SELECT trs_relokasi_kirim_detail.No_Relokasi AS 'NoDoc', 
                                        CASE WHEN Status = 'ApproveLog' THEN
                                         CONCAT('Relokasi ke Cabang  : ', trs_relokasi_kirim_detail.Cabang_Penerima)
                                        ELSE
                                          CONCAT('Relokasi ke Cabang  : ', trs_relokasi_kirim_detail.Cabang_Penerima)
                                        END
                                         AS 'Dokumen',
                                         CASE WHEN tgl_app IS NULL THEN trs_relokasi_kirim_detail.Tgl_kirim ELSE trs_relokasi_kirim_detail.tgl_app END AS 'TglDoc',
                                         CASE WHEN tgl_app IS NULL THEN trs_relokasi_kirim_detail.Time_kirim ELSE trs_relokasi_kirim_detail.App_BM_Time END  'TimeDoc',
                                         Produk AS 'Kode' ,
                                         NamaProduk AS 'NamaProduk' ,
                                         Satuan AS 'Unit',
                                         0 AS 'qty_in',
                                         CASE WHEN Status = 'ApproveLog' THEN
                                         0
                                         ELSE
                                         (Qty+Bonus)
                                         END AS 'qty_out',
                                         BatchNo AS 'BatchNo',
                                         ExpDate AS 'ExpDate'
                                  FROM  trs_relokasi_kirim_detail
                                  WHERE trs_relokasi_kirim_detail.Status IN ('Kirim','Reject','RejectPusat','RejectCabPenerima','ApproveLog') and
                                        trs_relokasi_kirim_detail.Produk = 'SLRDS1' and 
                                          CASE WHEN tgl_app IS NULL THEN trs_relokasi_kirim_detail.Tgl_kirim ELSE trs_relokasi_kirim_detail.tgl_app END
                                         between '2020-12-01 00:00:00' and '2020-12-23 23:59:59' 

                                  UNION ALL

                                  SELECT trs_relokasi_kirim_detail.No_Relokasi AS 'NoDoc', 
                                         CASE WHEN Keterangan_reject LIKE '%Penerima%' THEN
                                          'Relokasi Reject Cabang Penerima'
                                         ELSE 
                                           'Relokasi Reject Pusat'
                                         END AS 'Dokumen',
                                         trs_relokasi_kirim_detail.tgl_reject AS 'TglDoc',
                                         trs_relokasi_kirim_detail.Time_kirim 'TimeDoc',
                                         Produk AS 'Kode' ,
                                         NamaProduk AS 'NamaProduk' ,
                                         Satuan AS 'Unit',
                                         (Qty+Bonus) AS 'qty_in',
                                         0 AS 'qty_out',
                                         BatchNo AS 'BatchNo',
                                         ExpDate AS 'ExpDate'
                                  FROM  trs_relokasi_kirim_detail
                                  WHERE trs_relokasi_kirim_detail.Status = 'Reject' and
                                        trs_relokasi_kirim_detail.Produk = 'SLRDS1' and 
                                        trs_relokasi_kirim_detail.Tgl_reject between '2020-12-01 00:00:00' and '2020-12-23 23:59:59'

                                  UNION ALL

                                  SELECT trs_usulan_retur_beli_header.No_Usulan AS 'NoDoc', 
                                        CONCAT('Usulan Retur Beli : QTY = ',((trs_usulan_retur_beli_detail.Qty+trs_usulan_retur_beli_detail.Bonus) * -1),'  ~ Ke : ',trs_usulan_retur_beli_header.Prinsipal) AS 'Dokumen',
                                        trs_usulan_retur_beli_header.Tanggal AS 'TglDoc',
                                        trs_usulan_retur_beli_header.added_time as 'TimeDoc',
                                        trs_usulan_retur_beli_detail.Produk AS 'Kode' ,
                                        trs_usulan_retur_beli_detail.Nama_produk AS 'NamaProduk' ,
                                        trs_usulan_retur_beli_detail.Satuan AS 'Unit',
                                        0 AS 'qty_in',
                                        0 AS 'qty_out',
                                        trs_usulan_retur_beli_detail.BatchNo AS 'BatchNo',
                                        trs_usulan_retur_beli_detail.ExpDate AS 'ExpDate'
                                  FROM  trs_usulan_retur_beli_header INNER JOIN trs_usulan_retur_beli_detail ON trs_usulan_retur_beli_header.No_Usulan = trs_usulan_retur_beli_detail.No_Usulan 
                                  WHERE ifnull(trs_usulan_retur_beli_header.App_BM_Status,'') <> 'R' and
                                    trs_usulan_retur_beli_detail.Produk = 'SLRDS1'and 
                                        trs_usulan_retur_beli_header.tanggal between '2020-12-01 00:00:00' and '2020-12-23 23:59:59'

                                  UNION ALL

                                  SELECT trs_usulan_retur_beli_header.No_Usulan AS 'NoDoc', 
                                        CONCAT('Reject Usulan Beli Pusat : QTY = ',((trs_usulan_retur_beli_detail.Qty+trs_usulan_retur_beli_detail.Bonus) * -1),'  ~ Ke : ',trs_usulan_retur_beli_header.Prinsipal) AS 'Dokumen',
                                        trs_usulan_retur_beli_header.Tanggal AS 'TglDoc',
                                        trs_usulan_retur_beli_header.added_time as 'TimeDoc',
                                        trs_usulan_retur_beli_detail.Produk AS 'Kode' ,
                                        trs_usulan_retur_beli_detail.Nama_produk AS 'NamaProduk' ,
                                        trs_usulan_retur_beli_detail.Satuan AS 'Unit',
                                        0 AS 'qty_in',
                                        0 AS 'qty_out',
                                        trs_usulan_retur_beli_detail.BatchNo AS 'BatchNo',
                                        trs_usulan_retur_beli_detail.ExpDate AS 'ExpDate'
                                  FROM  trs_usulan_retur_beli_header INNER JOIN trs_usulan_retur_beli_detail ON trs_usulan_retur_beli_header.No_Usulan = trs_usulan_retur_beli_detail.No_Usulan 
                                  WHERE ifnull(trs_usulan_retur_beli_header.App_BM_Status,'') <> 'R' and ifnull(trs_usulan_retur_beli_header.App_Pst_Status,'') = 'Reject' and
                                    trs_usulan_retur_beli_detail.Produk = 'SLRDS1'and 
                                        trs_usulan_retur_beli_header.tanggal between '2020-12-01 00:00:00' and '2020-12-23 23:59:59'
                                  
                                  UNION ALL

                                  SELECT no_koreksi AS 'NoDoc', 
                                        CONCAT('Usulan Adjusment (-): QTY = ',(qty * -1),' ',catatan) AS 'Dokumen',
                                        tanggal AS 'TglDoc',
                                        trs_mutasi_koreksi.created_at as 'TimeDoc',
                                        trs_mutasi_koreksi.produk AS 'Kode' ,
                                        trs_mutasi_koreksi.nama_produk AS 'NamaProduk' ,
                                        Satuan AS 'Unit',
                                        0 AS 'qty_in',
                                        0 AS 'qty_out',
                                        batch AS 'BatchNo',
                                        exp_date AS 'ExpDate'
                                  FROM  trs_mutasi_koreksi INNER JOIN mst_produk ON mst_produk.`Kode_Produk` = trs_mutasi_koreksi.`produk`
                                  WHERE   qty < 0 AND trs_mutasi_koreksi.status IN ('Open','Approve') and
                                    trs_mutasi_koreksi.`produk` = 'SLRDS1'and 
                                        CASE WHEN trs_mutasi_koreksi.`Status` = 'Open' THEN
                                            tanggal
                                         ELSE
                                            IFNULL(DATE(tgl_approve),tanggal)
                                         END between '2020-12-01 00:00:00' and '2020-12-23 23:59:59'
                                        
                                  UNION ALL

                                  SELECT no_koreksi AS 'NoDoc', 
                                        CONCAT('Adjusment (-): ',catatan) AS 'Dokumen',
                                        IFNULL(DATE(tgl_approve),tanggal) AS 'TglDoc',
                                        trs_mutasi_koreksi.created_at as 'TimeDoc',
                                        trs_mutasi_koreksi.produk AS 'Kode' ,
                                        trs_mutasi_koreksi.nama_produk AS 'NamaProduk' ,
                                        Satuan AS 'Unit',
                                        0 AS 'qty_in',
                                        (qty * -1) AS 'qty_out',
                                        batch AS 'BatchNo',
                                        exp_date AS 'ExpDate'
                                  FROM  trs_mutasi_koreksi INNER JOIN mst_produk ON mst_produk.`Kode_Produk` = trs_mutasi_koreksi.`produk`
                                  WHERE   qty < 0 AND trs_mutasi_koreksi.status = 'Approve' and
                                    trs_mutasi_koreksi.`produk` = 'SLRDS1'and 
                                        IFNULL(DATE(tgl_approve),tanggal) between '2020-12-01 00:00:00' and '2020-12-23 23:59:59'
                                  
                                  UNION ALL 

                                  SELECT nodokumen AS 'NoDoc', 
                                        CONCAT('Mutasi Batch Dari Batch ',batchno_awal,' ke Batch ',batchno_akhir,' : QTY = ',qty) AS 'Dokumen',
                                        DATE(tanggal) AS 'TglDoc',
                                        create_date AS 'TimeDoc',
                                        trs_mutasi_batch.produk AS 'Kode' ,
                                        namaproduk AS 'NamaProduk' ,
                                        '' AS 'Unit',
                                        0 AS 'qty_in',
                                        0 AS 'qty_out',
                                        batchno_akhir AS 'BatchNo',
                                        expdate_akhir AS 'ExpDate'
                                  FROM  trs_mutasi_batch INNER JOIN mst_produk ON mst_produk.`Kode_Produk` = trs_mutasi_batch.`produk`
                                  WHERE    trs_mutasi_batch.status = 'Approve' AND
                                    trs_mutasi_batch.`produk` = 'SLRDS1'AND 
                                        DATE(tanggal) BETWEEN '2020-12-01 00:00:00' and '2020-12-23 23:59:59'
                                        
                                  ORDER BY TglDoc,TimeDoc,NoDoc ASC;
ERROR - 2020-12-23 14:31:21 --> Severity: error --> Exception: Call to a member function result() on boolean D:\xampp70\htdocs\sstcabang\application\models\pembelian\Model_inventori.php 1083
ERROR - 2020-12-23 14:32:28 --> Query error: Unknown column 'trs_usulan_retur_beli_header.App_Pst_Status' in 'where clause' - Invalid query: SELECT NoDokumen AS 'NoDoc',
                                          CONCAT('Terima dari ',Prinsipal,' - ',Supplier) AS 'Dokumen',
                                          TglDokumen AS 'TglDoc',
                                          TimeDokumen as 'TimeDoc',
                                          Produk AS 'Kode',
                                          NamaProduk AS 'NamaProduk',
                                          Satuan AS 'Unit',
                                          (ifnull(Qty,'') + ifnull(Bonus,'')) AS 'qty_in',
                                          0 AS 'qty_out',
                                          BatchNo,
                                          ExpDate
                                  FROM trs_terima_barang_detail
                                  WHERE trs_terima_barang_detail.Produk = 'SLRDS1' and 
                                        Status not in ('pending','Batal') and
                                        ifnull(Tipe,'') not in  ('BKB','Tolakan') and
                                        TglDokumen between '2020-12-01 00:00:00' and '2020-12-23 23:59:59'
                                  
                                  UNION ALL

                                  SELECT NoDokumen AS 'NoDoc',
                                          CONCAT('Retur Ke ',Prinsipal,' - ',Supplier) AS 'Dokumen',
                                          TglDokumen AS 'TglDoc',
                                          TimeDokumen as 'TimeDoc',
                                          Produk AS 'Kode',
                                          NamaProduk AS 'NamaProduk',
                                          Satuan AS 'Unit',
                                          0 AS 'qty_in',
                                          (((ifnull(Qty,'') + ifnull(Bonus,'')))*-1) AS 'qty_out',
                                          BatchNo,
                                          ExpDate
                                  FROM trs_terima_barang_detail
                                  where   ifnull(Tipe,'') = 'BKB' and Produk = 'SLRDS1' and 
                                        TglDokumen between '2020-12-01 00:00:00' and '2020-12-23 23:59:59'
                                  
                                  UNION ALL
                                  SELECT NoDokumen AS 'NoDoc',
                                          CONCAT('Tolakan Retur ',Prinsipal,' - ',Supplier,' ~ Qty : ', (ifnull(Qty,'') + ifnull(Bonus,''))*-1) AS 'Dokumen',
                                          TglDokumen AS 'TglDoc',
                                          TimeDokumen as 'TimeDoc',
                                          Produk AS 'Kode',
                                          NamaProduk AS 'NamaProduk',
                                          Satuan AS 'Unit',
                                          0 AS 'qty_in',
                                          0 AS 'qty_out',
                                          BatchNo,
                                          ExpDate
                                  FROM trs_terima_barang_detail
                                  where   ifnull(Tipe,'') = 'Tolakan' and Produk = 'SLRDS1' and 
                                        TglDokumen between '2020-12-01 00:00:00' and '2020-12-23 23:59:59'

                                  UNION ALL
                                  SELECT no_koreksi AS 'NoDoc', 
                                         CONCAT('Usulan Adjusment (+) : ', catatan) AS 'Dokumen',
                                         tanggal AS 'TglDoc',
                                         trs_mutasi_koreksi.created_at as 'TimeDoc',
                                         trs_mutasi_koreksi.produk AS 'Kode' ,
                                         trs_mutasi_koreksi.nama_produk AS 'NamaProduk' ,
                                         Satuan AS 'Unit',
                                         qty AS 'qty_in',
                                         0 AS 'qty_out',
                                         batch AS 'BatchNo',
                                         exp_date AS 'ExpDate'
                                  FROM  trs_mutasi_koreksi INNER JOIN mst_produk ON mst_produk.`Kode_Produk` = trs_mutasi_koreksi.`produk`
                                  WHERE   qty > 0 AND trs_mutasi_koreksi.status IN ('Open','Approve') and
                                    trs_mutasi_koreksi.`produk` = 'SLRDS1' and 
                                        CASE WHEN trs_mutasi_koreksi.`Status` = 'Open' THEN
                                          tanggal
                                       ELSE
                                          IFNULL(DATE(tgl_approve),tanggal)
                                       END between '2020-12-01 00:00:00' and '2020-12-23 23:59:59'
                                  UNION ALL
                                  SELECT NoDokumen AS 'NoDoc', 
                                         CONCAT('Mutasi Gudang dari Gudang : ', gudang_awal,' Ke Gudang : ',gudang_akhir,' ~ QTY = ',qty) AS 'Dokumen',
                                         tanggal AS 'TglDoc',
                                         trs_mutasi_gudang.create_date as 'TimeDoc',
                                         trs_mutasi_gudang.produk AS 'Kode' ,
                                         trs_mutasi_gudang.namaproduk AS 'NamaProduk' ,
                                         '' AS 'Unit',
                                         0 AS 'qty_in',
                                         0 AS 'qty_out',
                                         batchno_awal AS 'BatchNo',
                                         expdate_awal AS 'ExpDate'
                                  FROM  trs_mutasi_gudang INNER JOIN mst_produk ON mst_produk.`Kode_Produk` = trs_mutasi_gudang.`produk`
                                  WHERE   qty > 0 AND trs_mutasi_gudang.status IN ('Open','Approve') and
                                    trs_mutasi_gudang.`produk` = 'SLRDS1' and 
                                        tanggal between '2020-12-01 00:00:00' and '2020-12-23 23:59:59'
                                  UNION ALL

                                  SELECT no_koreksi AS 'NoDoc', 
                                         CONCAT('Adjusment (+) : QTY = ',qty,' ', catatan) AS 'Dokumen',
                                         IFNULL(DATE(tgl_approve),tanggal) AS 'TglDoc',
                                         trs_mutasi_koreksi.created_at as 'TimeDoc',
                                         trs_mutasi_koreksi.produk AS 'Kode' ,
                                         trs_mutasi_koreksi.nama_produk AS 'NamaProduk' ,
                                         Satuan AS 'Unit',
                                         0 AS 'qty_in',
                                         0 AS 'qty_out',
                                         batch AS 'BatchNo',
                                         exp_date AS 'ExpDate'
                                  FROM  trs_mutasi_koreksi INNER JOIN mst_produk ON mst_produk.`Kode_Produk` = trs_mutasi_koreksi.`produk`
                                  WHERE   qty > 0 AND trs_mutasi_koreksi.status = 'Approve' and
                                    trs_mutasi_koreksi.`produk` = 'SLRDS1' and 
                                        IFNULL(DATE(tgl_approve),tanggal) between '2020-12-01 00:00:00' and '2020-12-23 23:59:59'
                                  UNION ALL

                                  SELECT No_Terima AS 'NoDoc', 
                                         CONCAT('Relokasi Dari Cabang  : ', Cabang_Pengirim) AS 'Dokumen',
                                         Tgl_terima AS 'TglDoc',
                                         Time_terima as 'TimeDoc',
                                         Produk AS 'Kode' ,
                                         NamaProduk AS 'NamaProduk' ,
                                         Satuan AS 'Unit',
                                         (Qty+Bonus) AS 'qty_in',
                                         0 AS 'qty_out',
                                         BatchNo AS 'BatchNo',
                                         ExpDate AS 'ExpDate'
                                  FROM  trs_relokasi_terima_detail 
                                  WHERE   (Qty > 0 or Bonus > 0) AND
                                        Status = 'Terima' and
                                        Produk = 'SLRDS1' and 
                                        Tgl_terima between '2020-12-01 00:00:00' and '2020-12-23 23:59:59'
                                    
                                  UNION ALL 

                                  SELECT NoFaktur AS 'NoDoc',
                                        CONCAT('Terima dari ',Pelanggan, ' - ' ,NamaPelanggan) AS 'Dokumen',
                                        TglFaktur AS 'TglDoc',
                                        TimeFaktur as 'TimeDoc',
                                        KodeProduk AS 'Kode', 
                                        NamaProduk AS 'NamaProduk',
                                        UOM AS 'Unit',
                                        (QtyFaktur+BonusFaktur) AS 'qty_in',
                                        0 AS 'qty_out',
                                        BatchNo,
                                        ExpDate
                                  FROM trs_faktur_detail 
                                  WHERE TipeDokumen ='Retur' AND 
                                        ifnull(status,'') != 'Batal' and
                                        KodeProduk = 'SLRDS1' and 
                                        TglFaktur between '2020-12-01 00:00:00' and '2020-12-23 23:59:59'

                                  UNION ALL


                                  SELECT NoDO AS 'NoDoc',
                                    CONCAT('Kirim ke ',Pelanggan, ' - ' ,NamaPelanggan) AS 'Dokumen',  
                                    TglDO AS 'TglDoc',
                                    TimeDO AS 'TimeDoc',
                                    KodeProduk AS 'Kode',
                                    NamaProduk AS 'NamaProduk',
                                    UOM AS 'Unit',
                                    0 AS 'qty_in', 
                                    (QtyDO+BonusDO) AS 'qty_out',
                                    BatchNo,ExpDate
                                  FROM trs_delivery_order_sales_detail 
                                  WHERE KodeProduk = 'SLRDS1'  
                                    AND TglDO BETWEEN '2020-12-01 00:00:00' and '2020-12-23 23:59:59' and tipedokumen ='DO'
                                  UNION ALL
                                  SELECT NoDO AS 'NoDoc',
                                    CONCAT('Batal Kirim ke ',Pelanggan, ' - ' ,NamaPelanggan) AS 'Dokumen',  
                                    TglDO AS 'TglDoc',
                                    TimeDO AS 'TimeDoc',
                                    KodeProduk AS 'Kode',
                                    NamaProduk AS 'NamaProduk',
                                    UOM AS 'Unit',
                                    (QtyDO+BonusDO) AS 'qty_in', 
                                    0 AS 'qty_out',
                                    BatchNo,ExpDate
                                  FROM trs_delivery_order_sales_detail 
                                  WHERE KodeProduk = 'SLRDS1' 
                                    AND Status = 'Batal' 
                                    AND date(ifnull(time_batal,'')) BETWEEN '2020-12-01 00:00:00' and '2020-12-23 23:59:59'
                                  UNION ALL
                                  SELECT NoDO AS 'NoDoc',
                                    CONCAT('Retur Kirim dari ',Pelanggan, ' - ' ,NamaPelanggan) AS 'Dokumen',  
                                    TglDO AS 'TglDoc',
                                    TimeDO AS 'TimeDoc',
                                    KodeProduk AS 'Kode',
                                    NamaProduk AS 'NamaProduk',
                                    UOM AS 'Unit',
                                    (QtyDO+BonusDO) AS 'qty_in', 
                                    0 AS 'qty_out',
                                    BatchNo,ExpDate
                                  FROM trs_delivery_order_sales_detail 
                                  WHERE KodeProduk = 'SLRDS1' and 
                                        TipeDokumen ='Retur' and Status = 'Retur' 
                                    AND TglDO BETWEEN '2020-12-01 00:00:00' and '2020-12-23 23:59:59'
                                  UNION ALL

                                  SELECT trs_relokasi_kirim_detail.No_Relokasi AS 'NoDoc', 
                                        CASE WHEN Status = 'ApproveLog' THEN
                                         CONCAT('Relokasi ke Cabang  : ', trs_relokasi_kirim_detail.Cabang_Penerima)
                                        ELSE
                                          CONCAT('Relokasi ke Cabang  : ', trs_relokasi_kirim_detail.Cabang_Penerima)
                                        END
                                         AS 'Dokumen',
                                         CASE WHEN tgl_app IS NULL THEN trs_relokasi_kirim_detail.Tgl_kirim ELSE trs_relokasi_kirim_detail.tgl_app END AS 'TglDoc',
                                         CASE WHEN tgl_app IS NULL THEN trs_relokasi_kirim_detail.Time_kirim ELSE trs_relokasi_kirim_detail.App_BM_Time END  'TimeDoc',
                                         Produk AS 'Kode' ,
                                         NamaProduk AS 'NamaProduk' ,
                                         Satuan AS 'Unit',
                                         0 AS 'qty_in',
                                         CASE WHEN Status = 'ApproveLog' THEN
                                         0
                                         ELSE
                                         (Qty+Bonus)
                                         END AS 'qty_out',
                                         BatchNo AS 'BatchNo',
                                         ExpDate AS 'ExpDate'
                                  FROM  trs_relokasi_kirim_detail
                                  WHERE trs_relokasi_kirim_detail.Status IN ('Kirim','Reject','RejectPusat','RejectCabPenerima','ApproveLog') and
                                        trs_relokasi_kirim_detail.Produk = 'SLRDS1' and 
                                          CASE WHEN tgl_app IS NULL THEN trs_relokasi_kirim_detail.Tgl_kirim ELSE trs_relokasi_kirim_detail.tgl_app END
                                         between '2020-12-01 00:00:00' and '2020-12-23 23:59:59' 

                                  UNION ALL

                                  SELECT trs_relokasi_kirim_detail.No_Relokasi AS 'NoDoc', 
                                         CASE WHEN Keterangan_reject LIKE '%Penerima%' THEN
                                          'Relokasi Reject Cabang Penerima'
                                         ELSE 
                                           'Relokasi Reject Pusat'
                                         END AS 'Dokumen',
                                         trs_relokasi_kirim_detail.tgl_reject AS 'TglDoc',
                                         trs_relokasi_kirim_detail.Time_kirim 'TimeDoc',
                                         Produk AS 'Kode' ,
                                         NamaProduk AS 'NamaProduk' ,
                                         Satuan AS 'Unit',
                                         (Qty+Bonus) AS 'qty_in',
                                         0 AS 'qty_out',
                                         BatchNo AS 'BatchNo',
                                         ExpDate AS 'ExpDate'
                                  FROM  trs_relokasi_kirim_detail
                                  WHERE trs_relokasi_kirim_detail.Status = 'Reject' and
                                        trs_relokasi_kirim_detail.Produk = 'SLRDS1' and 
                                        trs_relokasi_kirim_detail.Tgl_reject between '2020-12-01 00:00:00' and '2020-12-23 23:59:59'

                                  UNION ALL

                                  SELECT trs_usulan_retur_beli_header.No_Usulan AS 'NoDoc', 
                                        CONCAT('Usulan Retur Beli : QTY = ',((trs_usulan_retur_beli_detail.Qty+trs_usulan_retur_beli_detail.Bonus) * -1),'  ~ Ke : ',trs_usulan_retur_beli_header.Prinsipal) AS 'Dokumen',
                                        trs_usulan_retur_beli_header.Tanggal AS 'TglDoc',
                                        trs_usulan_retur_beli_header.added_time as 'TimeDoc',
                                        trs_usulan_retur_beli_detail.Produk AS 'Kode' ,
                                        trs_usulan_retur_beli_detail.Nama_produk AS 'NamaProduk' ,
                                        trs_usulan_retur_beli_detail.Satuan AS 'Unit',
                                        0 AS 'qty_in',
                                        0 AS 'qty_out',
                                        trs_usulan_retur_beli_detail.BatchNo AS 'BatchNo',
                                        trs_usulan_retur_beli_detail.ExpDate AS 'ExpDate'
                                  FROM  trs_usulan_retur_beli_header INNER JOIN trs_usulan_retur_beli_detail ON trs_usulan_retur_beli_header.No_Usulan = trs_usulan_retur_beli_detail.No_Usulan 
                                  WHERE ifnull(trs_usulan_retur_beli_header.App_BM_Status,'') <> 'R' and
                                    trs_usulan_retur_beli_detail.Produk = 'SLRDS1'and 
                                        trs_usulan_retur_beli_header.tanggal between '2020-12-01 00:00:00' and '2020-12-23 23:59:59'

                                  UNION ALL

                                  SELECT trs_usulan_retur_beli_header.No_Usulan AS 'NoDoc', 
                                        CONCAT('Reject Usulan Beli Pusat : QTY = ',((trs_usulan_retur_beli_detail.Qty+trs_usulan_retur_beli_detail.Bonus) * -1),'  ~ Ke : ',trs_usulan_retur_beli_header.Prinsipal) AS 'Dokumen',
                                        trs_usulan_retur_beli_header.Tanggal AS 'TglDoc',
                                        trs_usulan_retur_beli_header.added_time as 'TimeDoc',
                                        trs_usulan_retur_beli_detail.Produk AS 'Kode' ,
                                        trs_usulan_retur_beli_detail.Nama_produk AS 'NamaProduk' ,
                                        trs_usulan_retur_beli_detail.Satuan AS 'Unit',
                                        0 AS 'qty_in',
                                        0 AS 'qty_out',
                                        trs_usulan_retur_beli_detail.BatchNo AS 'BatchNo',
                                        trs_usulan_retur_beli_detail.ExpDate AS 'ExpDate'
                                  FROM  trs_usulan_retur_beli_header INNER JOIN trs_usulan_retur_beli_detail ON trs_usulan_retur_beli_header.No_Usulan = trs_usulan_retur_beli_detail.No_Usulan 
                                  WHERE ifnull(trs_usulan_retur_beli_header.App_BM_Status,'') <> 'R' and ifnull(trs_usulan_retur_beli_header.App_Pst_Status,'') = 'Reject' and
                                    trs_usulan_retur_beli_detail.Produk = 'SLRDS1'and 
                                        trs_usulan_retur_beli_header.tanggal between '2020-12-01 00:00:00' and '2020-12-23 23:59:59'
                                  
                                  UNION ALL

                                  SELECT no_koreksi AS 'NoDoc', 
                                        CONCAT('Usulan Adjusment (-): QTY = ',(qty * -1),' ',catatan) AS 'Dokumen',
                                        tanggal AS 'TglDoc',
                                        trs_mutasi_koreksi.created_at as 'TimeDoc',
                                        trs_mutasi_koreksi.produk AS 'Kode' ,
                                        trs_mutasi_koreksi.nama_produk AS 'NamaProduk' ,
                                        Satuan AS 'Unit',
                                        0 AS 'qty_in',
                                        0 AS 'qty_out',
                                        batch AS 'BatchNo',
                                        exp_date AS 'ExpDate'
                                  FROM  trs_mutasi_koreksi INNER JOIN mst_produk ON mst_produk.`Kode_Produk` = trs_mutasi_koreksi.`produk`
                                  WHERE   qty < 0 AND trs_mutasi_koreksi.status IN ('Open','Approve') and
                                    trs_mutasi_koreksi.`produk` = 'SLRDS1'and 
                                        CASE WHEN trs_mutasi_koreksi.`Status` = 'Open' THEN
                                            tanggal
                                         ELSE
                                            IFNULL(DATE(tgl_approve),tanggal)
                                         END between '2020-12-01 00:00:00' and '2020-12-23 23:59:59'
                                        
                                  UNION ALL

                                  SELECT no_koreksi AS 'NoDoc', 
                                        CONCAT('Adjusment (-): ',catatan) AS 'Dokumen',
                                        IFNULL(DATE(tgl_approve),tanggal) AS 'TglDoc',
                                        trs_mutasi_koreksi.created_at as 'TimeDoc',
                                        trs_mutasi_koreksi.produk AS 'Kode' ,
                                        trs_mutasi_koreksi.nama_produk AS 'NamaProduk' ,
                                        Satuan AS 'Unit',
                                        0 AS 'qty_in',
                                        (qty * -1) AS 'qty_out',
                                        batch AS 'BatchNo',
                                        exp_date AS 'ExpDate'
                                  FROM  trs_mutasi_koreksi INNER JOIN mst_produk ON mst_produk.`Kode_Produk` = trs_mutasi_koreksi.`produk`
                                  WHERE   qty < 0 AND trs_mutasi_koreksi.status = 'Approve' and
                                    trs_mutasi_koreksi.`produk` = 'SLRDS1'and 
                                        IFNULL(DATE(tgl_approve),tanggal) between '2020-12-01 00:00:00' and '2020-12-23 23:59:59'
                                  
                                  UNION ALL 

                                  SELECT nodokumen AS 'NoDoc', 
                                        CONCAT('Mutasi Batch Dari Batch ',batchno_awal,' ke Batch ',batchno_akhir,' : QTY = ',qty) AS 'Dokumen',
                                        DATE(tanggal) AS 'TglDoc',
                                        create_date AS 'TimeDoc',
                                        trs_mutasi_batch.produk AS 'Kode' ,
                                        namaproduk AS 'NamaProduk' ,
                                        '' AS 'Unit',
                                        0 AS 'qty_in',
                                        0 AS 'qty_out',
                                        batchno_akhir AS 'BatchNo',
                                        expdate_akhir AS 'ExpDate'
                                  FROM  trs_mutasi_batch INNER JOIN mst_produk ON mst_produk.`Kode_Produk` = trs_mutasi_batch.`produk`
                                  WHERE    trs_mutasi_batch.status = 'Approve' AND
                                    trs_mutasi_batch.`produk` = 'SLRDS1'AND 
                                        DATE(tanggal) BETWEEN '2020-12-01 00:00:00' and '2020-12-23 23:59:59'
                                        
                                  ORDER BY TglDoc,TimeDoc,NoDoc ASC;
ERROR - 2020-12-23 14:32:28 --> Cabang
ERROR - 2020-12-23 14:32:29 --> Query error: Unknown column 'trs_usulan_retur_beli_header.App_Pst_Status' in 'where clause' - Invalid query: SELECT NoDokumen AS 'NoDoc',
                                          CONCAT('Terima dari ',Prinsipal,' - ',Supplier) AS 'Dokumen',
                                          TglDokumen AS 'TglDoc',
                                          TimeDokumen as 'TimeDoc',
                                          Produk AS 'Kode',
                                          NamaProduk AS 'NamaProduk',
                                          Satuan AS 'Unit',
                                          (ifnull(Qty,'') + ifnull(Bonus,'')) AS 'qty_in',
                                          0 AS 'qty_out',
                                          BatchNo,
                                          ExpDate
                                  FROM trs_terima_barang_detail
                                  WHERE trs_terima_barang_detail.Produk = 'SLRDS1' and 
                                        Status not in ('pending','Batal') and
                                        ifnull(Tipe,'') not in  ('BKB','Tolakan') and
                                        TglDokumen between '2020-12-01 00:00:00' and '2020-12-23 23:59:59'
                                  
                                  UNION ALL

                                  SELECT NoDokumen AS 'NoDoc',
                                          CONCAT('Retur Ke ',Prinsipal,' - ',Supplier) AS 'Dokumen',
                                          TglDokumen AS 'TglDoc',
                                          TimeDokumen as 'TimeDoc',
                                          Produk AS 'Kode',
                                          NamaProduk AS 'NamaProduk',
                                          Satuan AS 'Unit',
                                          0 AS 'qty_in',
                                          (((ifnull(Qty,'') + ifnull(Bonus,'')))*-1) AS 'qty_out',
                                          BatchNo,
                                          ExpDate
                                  FROM trs_terima_barang_detail
                                  where   ifnull(Tipe,'') = 'BKB' and Produk = 'SLRDS1' and 
                                        TglDokumen between '2020-12-01 00:00:00' and '2020-12-23 23:59:59'
                                  
                                  UNION ALL
                                  SELECT NoDokumen AS 'NoDoc',
                                          CONCAT('Tolakan Retur ',Prinsipal,' - ',Supplier,' ~ Qty : ', (ifnull(Qty,'') + ifnull(Bonus,''))*-1) AS 'Dokumen',
                                          TglDokumen AS 'TglDoc',
                                          TimeDokumen as 'TimeDoc',
                                          Produk AS 'Kode',
                                          NamaProduk AS 'NamaProduk',
                                          Satuan AS 'Unit',
                                          0 AS 'qty_in',
                                          0 AS 'qty_out',
                                          BatchNo,
                                          ExpDate
                                  FROM trs_terima_barang_detail
                                  where   ifnull(Tipe,'') = 'Tolakan' and Produk = 'SLRDS1' and 
                                        TglDokumen between '2020-12-01 00:00:00' and '2020-12-23 23:59:59'

                                  UNION ALL
                                  SELECT no_koreksi AS 'NoDoc', 
                                         CONCAT('Usulan Adjusment (+) : ', catatan) AS 'Dokumen',
                                         tanggal AS 'TglDoc',
                                         trs_mutasi_koreksi.created_at as 'TimeDoc',
                                         trs_mutasi_koreksi.produk AS 'Kode' ,
                                         trs_mutasi_koreksi.nama_produk AS 'NamaProduk' ,
                                         Satuan AS 'Unit',
                                         qty AS 'qty_in',
                                         0 AS 'qty_out',
                                         batch AS 'BatchNo',
                                         exp_date AS 'ExpDate'
                                  FROM  trs_mutasi_koreksi INNER JOIN mst_produk ON mst_produk.`Kode_Produk` = trs_mutasi_koreksi.`produk`
                                  WHERE   qty > 0 AND trs_mutasi_koreksi.status IN ('Open','Approve') and
                                    trs_mutasi_koreksi.`produk` = 'SLRDS1' and 
                                        CASE WHEN trs_mutasi_koreksi.`Status` = 'Open' THEN
                                          tanggal
                                       ELSE
                                          IFNULL(DATE(tgl_approve),tanggal)
                                       END between '2020-12-01 00:00:00' and '2020-12-23 23:59:59'
                                  UNION ALL
                                  SELECT NoDokumen AS 'NoDoc', 
                                         CONCAT('Mutasi Gudang dari Gudang : ', gudang_awal,' Ke Gudang : ',gudang_akhir,' ~ QTY = ',qty) AS 'Dokumen',
                                         tanggal AS 'TglDoc',
                                         trs_mutasi_gudang.create_date as 'TimeDoc',
                                         trs_mutasi_gudang.produk AS 'Kode' ,
                                         trs_mutasi_gudang.namaproduk AS 'NamaProduk' ,
                                         '' AS 'Unit',
                                         0 AS 'qty_in',
                                         0 AS 'qty_out',
                                         batchno_awal AS 'BatchNo',
                                         expdate_awal AS 'ExpDate'
                                  FROM  trs_mutasi_gudang INNER JOIN mst_produk ON mst_produk.`Kode_Produk` = trs_mutasi_gudang.`produk`
                                  WHERE   qty > 0 AND trs_mutasi_gudang.status IN ('Open','Approve') and
                                    trs_mutasi_gudang.`produk` = 'SLRDS1' and 
                                        tanggal between '2020-12-01 00:00:00' and '2020-12-23 23:59:59'
                                  UNION ALL

                                  SELECT no_koreksi AS 'NoDoc', 
                                         CONCAT('Adjusment (+) : QTY = ',qty,' ', catatan) AS 'Dokumen',
                                         IFNULL(DATE(tgl_approve),tanggal) AS 'TglDoc',
                                         trs_mutasi_koreksi.created_at as 'TimeDoc',
                                         trs_mutasi_koreksi.produk AS 'Kode' ,
                                         trs_mutasi_koreksi.nama_produk AS 'NamaProduk' ,
                                         Satuan AS 'Unit',
                                         0 AS 'qty_in',
                                         0 AS 'qty_out',
                                         batch AS 'BatchNo',
                                         exp_date AS 'ExpDate'
                                  FROM  trs_mutasi_koreksi INNER JOIN mst_produk ON mst_produk.`Kode_Produk` = trs_mutasi_koreksi.`produk`
                                  WHERE   qty > 0 AND trs_mutasi_koreksi.status = 'Approve' and
                                    trs_mutasi_koreksi.`produk` = 'SLRDS1' and 
                                        IFNULL(DATE(tgl_approve),tanggal) between '2020-12-01 00:00:00' and '2020-12-23 23:59:59'
                                  UNION ALL

                                  SELECT No_Terima AS 'NoDoc', 
                                         CONCAT('Relokasi Dari Cabang  : ', Cabang_Pengirim) AS 'Dokumen',
                                         Tgl_terima AS 'TglDoc',
                                         Time_terima as 'TimeDoc',
                                         Produk AS 'Kode' ,
                                         NamaProduk AS 'NamaProduk' ,
                                         Satuan AS 'Unit',
                                         (Qty+Bonus) AS 'qty_in',
                                         0 AS 'qty_out',
                                         BatchNo AS 'BatchNo',
                                         ExpDate AS 'ExpDate'
                                  FROM  trs_relokasi_terima_detail 
                                  WHERE   (Qty > 0 or Bonus > 0) AND
                                        Status = 'Terima' and
                                        Produk = 'SLRDS1' and 
                                        Tgl_terima between '2020-12-01 00:00:00' and '2020-12-23 23:59:59'
                                    
                                  UNION ALL 

                                  SELECT NoFaktur AS 'NoDoc',
                                        CONCAT('Terima dari ',Pelanggan, ' - ' ,NamaPelanggan) AS 'Dokumen',
                                        TglFaktur AS 'TglDoc',
                                        TimeFaktur as 'TimeDoc',
                                        KodeProduk AS 'Kode', 
                                        NamaProduk AS 'NamaProduk',
                                        UOM AS 'Unit',
                                        (QtyFaktur+BonusFaktur) AS 'qty_in',
                                        0 AS 'qty_out',
                                        BatchNo,
                                        ExpDate
                                  FROM trs_faktur_detail 
                                  WHERE TipeDokumen ='Retur' AND 
                                        ifnull(status,'') != 'Batal' and
                                        KodeProduk = 'SLRDS1' and 
                                        TglFaktur between '2020-12-01 00:00:00' and '2020-12-23 23:59:59'

                                  UNION ALL


                                  SELECT NoDO AS 'NoDoc',
                                    CONCAT('Kirim ke ',Pelanggan, ' - ' ,NamaPelanggan) AS 'Dokumen',  
                                    TglDO AS 'TglDoc',
                                    TimeDO AS 'TimeDoc',
                                    KodeProduk AS 'Kode',
                                    NamaProduk AS 'NamaProduk',
                                    UOM AS 'Unit',
                                    0 AS 'qty_in', 
                                    (QtyDO+BonusDO) AS 'qty_out',
                                    BatchNo,ExpDate
                                  FROM trs_delivery_order_sales_detail 
                                  WHERE KodeProduk = 'SLRDS1'  
                                    AND TglDO BETWEEN '2020-12-01 00:00:00' and '2020-12-23 23:59:59' and tipedokumen ='DO'
                                  UNION ALL
                                  SELECT NoDO AS 'NoDoc',
                                    CONCAT('Batal Kirim ke ',Pelanggan, ' - ' ,NamaPelanggan) AS 'Dokumen',  
                                    TglDO AS 'TglDoc',
                                    TimeDO AS 'TimeDoc',
                                    KodeProduk AS 'Kode',
                                    NamaProduk AS 'NamaProduk',
                                    UOM AS 'Unit',
                                    (QtyDO+BonusDO) AS 'qty_in', 
                                    0 AS 'qty_out',
                                    BatchNo,ExpDate
                                  FROM trs_delivery_order_sales_detail 
                                  WHERE KodeProduk = 'SLRDS1' 
                                    AND Status = 'Batal' 
                                    AND date(ifnull(time_batal,'')) BETWEEN '2020-12-01 00:00:00' and '2020-12-23 23:59:59'
                                  UNION ALL
                                  SELECT NoDO AS 'NoDoc',
                                    CONCAT('Retur Kirim dari ',Pelanggan, ' - ' ,NamaPelanggan) AS 'Dokumen',  
                                    TglDO AS 'TglDoc',
                                    TimeDO AS 'TimeDoc',
                                    KodeProduk AS 'Kode',
                                    NamaProduk AS 'NamaProduk',
                                    UOM AS 'Unit',
                                    (QtyDO+BonusDO) AS 'qty_in', 
                                    0 AS 'qty_out',
                                    BatchNo,ExpDate
                                  FROM trs_delivery_order_sales_detail 
                                  WHERE KodeProduk = 'SLRDS1' and 
                                        TipeDokumen ='Retur' and Status = 'Retur' 
                                    AND TglDO BETWEEN '2020-12-01 00:00:00' and '2020-12-23 23:59:59'
                                  UNION ALL

                                  SELECT trs_relokasi_kirim_detail.No_Relokasi AS 'NoDoc', 
                                        CASE WHEN Status = 'ApproveLog' THEN
                                         CONCAT('Relokasi ke Cabang  : ', trs_relokasi_kirim_detail.Cabang_Penerima)
                                        ELSE
                                          CONCAT('Relokasi ke Cabang  : ', trs_relokasi_kirim_detail.Cabang_Penerima)
                                        END
                                         AS 'Dokumen',
                                         CASE WHEN tgl_app IS NULL THEN trs_relokasi_kirim_detail.Tgl_kirim ELSE trs_relokasi_kirim_detail.tgl_app END AS 'TglDoc',
                                         CASE WHEN tgl_app IS NULL THEN trs_relokasi_kirim_detail.Time_kirim ELSE trs_relokasi_kirim_detail.App_BM_Time END  'TimeDoc',
                                         Produk AS 'Kode' ,
                                         NamaProduk AS 'NamaProduk' ,
                                         Satuan AS 'Unit',
                                         0 AS 'qty_in',
                                         CASE WHEN Status = 'ApproveLog' THEN
                                         0
                                         ELSE
                                         (Qty+Bonus)
                                         END AS 'qty_out',
                                         BatchNo AS 'BatchNo',
                                         ExpDate AS 'ExpDate'
                                  FROM  trs_relokasi_kirim_detail
                                  WHERE trs_relokasi_kirim_detail.Status IN ('Kirim','Reject','RejectPusat','RejectCabPenerima','ApproveLog') and
                                        trs_relokasi_kirim_detail.Produk = 'SLRDS1' and 
                                          CASE WHEN tgl_app IS NULL THEN trs_relokasi_kirim_detail.Tgl_kirim ELSE trs_relokasi_kirim_detail.tgl_app END
                                         between '2020-12-01 00:00:00' and '2020-12-23 23:59:59' 

                                  UNION ALL

                                  SELECT trs_relokasi_kirim_detail.No_Relokasi AS 'NoDoc', 
                                         CASE WHEN Keterangan_reject LIKE '%Penerima%' THEN
                                          'Relokasi Reject Cabang Penerima'
                                         ELSE 
                                           'Relokasi Reject Pusat'
                                         END AS 'Dokumen',
                                         trs_relokasi_kirim_detail.tgl_reject AS 'TglDoc',
                                         trs_relokasi_kirim_detail.Time_kirim 'TimeDoc',
                                         Produk AS 'Kode' ,
                                         NamaProduk AS 'NamaProduk' ,
                                         Satuan AS 'Unit',
                                         (Qty+Bonus) AS 'qty_in',
                                         0 AS 'qty_out',
                                         BatchNo AS 'BatchNo',
                                         ExpDate AS 'ExpDate'
                                  FROM  trs_relokasi_kirim_detail
                                  WHERE trs_relokasi_kirim_detail.Status = 'Reject' and
                                        trs_relokasi_kirim_detail.Produk = 'SLRDS1' and 
                                        trs_relokasi_kirim_detail.Tgl_reject between '2020-12-01 00:00:00' and '2020-12-23 23:59:59'

                                  UNION ALL

                                  SELECT trs_usulan_retur_beli_header.No_Usulan AS 'NoDoc', 
                                        CONCAT('Usulan Retur Beli : QTY = ',((trs_usulan_retur_beli_detail.Qty+trs_usulan_retur_beli_detail.Bonus) * -1),'  ~ Ke : ',trs_usulan_retur_beli_header.Prinsipal) AS 'Dokumen',
                                        trs_usulan_retur_beli_header.Tanggal AS 'TglDoc',
                                        trs_usulan_retur_beli_header.added_time as 'TimeDoc',
                                        trs_usulan_retur_beli_detail.Produk AS 'Kode' ,
                                        trs_usulan_retur_beli_detail.Nama_produk AS 'NamaProduk' ,
                                        trs_usulan_retur_beli_detail.Satuan AS 'Unit',
                                        0 AS 'qty_in',
                                        0 AS 'qty_out',
                                        trs_usulan_retur_beli_detail.BatchNo AS 'BatchNo',
                                        trs_usulan_retur_beli_detail.ExpDate AS 'ExpDate'
                                  FROM  trs_usulan_retur_beli_header INNER JOIN trs_usulan_retur_beli_detail ON trs_usulan_retur_beli_header.No_Usulan = trs_usulan_retur_beli_detail.No_Usulan 
                                  WHERE ifnull(trs_usulan_retur_beli_header.App_BM_Status,'') <> 'R' and
                                    trs_usulan_retur_beli_detail.Produk = 'SLRDS1'and 
                                        trs_usulan_retur_beli_header.tanggal between '2020-12-01 00:00:00' and '2020-12-23 23:59:59'

                                  UNION ALL

                                  SELECT trs_usulan_retur_beli_header.No_Usulan AS 'NoDoc', 
                                        CONCAT('Reject Usulan Beli Pusat : QTY = ',((trs_usulan_retur_beli_detail.Qty+trs_usulan_retur_beli_detail.Bonus) * -1),'  ~ Ke : ',trs_usulan_retur_beli_header.Prinsipal) AS 'Dokumen',
                                        trs_usulan_retur_beli_header.Tanggal AS 'TglDoc',
                                        trs_usulan_retur_beli_header.added_time as 'TimeDoc',
                                        trs_usulan_retur_beli_detail.Produk AS 'Kode' ,
                                        trs_usulan_retur_beli_detail.Nama_produk AS 'NamaProduk' ,
                                        trs_usulan_retur_beli_detail.Satuan AS 'Unit',
                                        0 AS 'qty_in',
                                        0 AS 'qty_out',
                                        trs_usulan_retur_beli_detail.BatchNo AS 'BatchNo',
                                        trs_usulan_retur_beli_detail.ExpDate AS 'ExpDate'
                                  FROM  trs_usulan_retur_beli_header INNER JOIN trs_usulan_retur_beli_detail ON trs_usulan_retur_beli_header.No_Usulan = trs_usulan_retur_beli_detail.No_Usulan 
                                  WHERE ifnull(trs_usulan_retur_beli_header.App_BM_Status,'') <> 'R' and ifnull(trs_usulan_retur_beli_header.App_Pst_Status,'') = 'Reject' and
                                    trs_usulan_retur_beli_detail.Produk = 'SLRDS1'and 
                                        trs_usulan_retur_beli_header.tanggal between '2020-12-01 00:00:00' and '2020-12-23 23:59:59'
                                  
                                  UNION ALL

                                  SELECT no_koreksi AS 'NoDoc', 
                                        CONCAT('Usulan Adjusment (-): QTY = ',(qty * -1),' ',catatan) AS 'Dokumen',
                                        tanggal AS 'TglDoc',
                                        trs_mutasi_koreksi.created_at as 'TimeDoc',
                                        trs_mutasi_koreksi.produk AS 'Kode' ,
                                        trs_mutasi_koreksi.nama_produk AS 'NamaProduk' ,
                                        Satuan AS 'Unit',
                                        0 AS 'qty_in',
                                        0 AS 'qty_out',
                                        batch AS 'BatchNo',
                                        exp_date AS 'ExpDate'
                                  FROM  trs_mutasi_koreksi INNER JOIN mst_produk ON mst_produk.`Kode_Produk` = trs_mutasi_koreksi.`produk`
                                  WHERE   qty < 0 AND trs_mutasi_koreksi.status IN ('Open','Approve') and
                                    trs_mutasi_koreksi.`produk` = 'SLRDS1'and 
                                        CASE WHEN trs_mutasi_koreksi.`Status` = 'Open' THEN
                                            tanggal
                                         ELSE
                                            IFNULL(DATE(tgl_approve),tanggal)
                                         END between '2020-12-01 00:00:00' and '2020-12-23 23:59:59'
                                        
                                  UNION ALL

                                  SELECT no_koreksi AS 'NoDoc', 
                                        CONCAT('Adjusment (-): ',catatan) AS 'Dokumen',
                                        IFNULL(DATE(tgl_approve),tanggal) AS 'TglDoc',
                                        trs_mutasi_koreksi.created_at as 'TimeDoc',
                                        trs_mutasi_koreksi.produk AS 'Kode' ,
                                        trs_mutasi_koreksi.nama_produk AS 'NamaProduk' ,
                                        Satuan AS 'Unit',
                                        0 AS 'qty_in',
                                        (qty * -1) AS 'qty_out',
                                        batch AS 'BatchNo',
                                        exp_date AS 'ExpDate'
                                  FROM  trs_mutasi_koreksi INNER JOIN mst_produk ON mst_produk.`Kode_Produk` = trs_mutasi_koreksi.`produk`
                                  WHERE   qty < 0 AND trs_mutasi_koreksi.status = 'Approve' and
                                    trs_mutasi_koreksi.`produk` = 'SLRDS1'and 
                                        IFNULL(DATE(tgl_approve),tanggal) between '2020-12-01 00:00:00' and '2020-12-23 23:59:59'
                                  
                                  UNION ALL 

                                  SELECT nodokumen AS 'NoDoc', 
                                        CONCAT('Mutasi Batch Dari Batch ',batchno_awal,' ke Batch ',batchno_akhir,' : QTY = ',qty) AS 'Dokumen',
                                        DATE(tanggal) AS 'TglDoc',
                                        create_date AS 'TimeDoc',
                                        trs_mutasi_batch.produk AS 'Kode' ,
                                        namaproduk AS 'NamaProduk' ,
                                        '' AS 'Unit',
                                        0 AS 'qty_in',
                                        0 AS 'qty_out',
                                        batchno_akhir AS 'BatchNo',
                                        expdate_akhir AS 'ExpDate'
                                  FROM  trs_mutasi_batch INNER JOIN mst_produk ON mst_produk.`Kode_Produk` = trs_mutasi_batch.`produk`
                                  WHERE    trs_mutasi_batch.status = 'Approve' AND
                                    trs_mutasi_batch.`produk` = 'SLRDS1'AND 
                                        DATE(tanggal) BETWEEN '2020-12-01 00:00:00' and '2020-12-23 23:59:59'
                                        
                                  ORDER BY TglDoc,TimeDoc,NoDoc ASC;
ERROR - 2020-12-23 14:32:44 --> 404 Page Not Found: /index
ERROR - 2020-12-23 14:32:49 --> Severity: Notice --> Undefined offset: 1 D:\xampp70\htdocs\sstcabang\application\controllers\pembelian\Inventori.php 617
ERROR - 2020-12-23 14:32:50 --> Query error: Unknown column 'trs_usulan_retur_beli_header.App_Pst_Status' in 'where clause' - Invalid query: SELECT NoDokumen AS 'NoDoc',
                                          CONCAT('Terima dari ',Prinsipal,' - ',Supplier) AS 'Dokumen',
                                          TglDokumen AS 'TglDoc',
                                          TimeDokumen as 'TimeDoc',
                                          Produk AS 'Kode',
                                          NamaProduk AS 'NamaProduk',
                                          Satuan AS 'Unit',
                                          (ifnull(Qty,'') + ifnull(Bonus,'')) AS 'qty_in',
                                          0 AS 'qty_out',
                                          BatchNo,
                                          ExpDate
                                  FROM trs_terima_barang_detail
                                  WHERE trs_terima_barang_detail.Produk = 'SLRDS1' and 
                                        Status not in ('pending','Batal') and
                                        ifnull(Tipe,'') not in  ('BKB','Tolakan') and
                                        TglDokumen between '2020-12-01 00:00:00' and '2020-12-23 23:59:59'
                                  
                                  UNION ALL

                                  SELECT NoDokumen AS 'NoDoc',
                                          CONCAT('Retur Ke ',Prinsipal,' - ',Supplier) AS 'Dokumen',
                                          TglDokumen AS 'TglDoc',
                                          TimeDokumen as 'TimeDoc',
                                          Produk AS 'Kode',
                                          NamaProduk AS 'NamaProduk',
                                          Satuan AS 'Unit',
                                          0 AS 'qty_in',
                                          (((ifnull(Qty,'') + ifnull(Bonus,'')))*-1) AS 'qty_out',
                                          BatchNo,
                                          ExpDate
                                  FROM trs_terima_barang_detail
                                  where   ifnull(Tipe,'') = 'BKB' and Produk = 'SLRDS1' and 
                                        TglDokumen between '2020-12-01 00:00:00' and '2020-12-23 23:59:59'
                                  
                                  UNION ALL
                                  SELECT NoDokumen AS 'NoDoc',
                                          CONCAT('Tolakan Retur ',Prinsipal,' - ',Supplier,' ~ Qty : ', (ifnull(Qty,'') + ifnull(Bonus,''))*-1) AS 'Dokumen',
                                          TglDokumen AS 'TglDoc',
                                          TimeDokumen as 'TimeDoc',
                                          Produk AS 'Kode',
                                          NamaProduk AS 'NamaProduk',
                                          Satuan AS 'Unit',
                                          0 AS 'qty_in',
                                          0 AS 'qty_out',
                                          BatchNo,
                                          ExpDate
                                  FROM trs_terima_barang_detail
                                  where   ifnull(Tipe,'') = 'Tolakan' and Produk = 'SLRDS1' and 
                                        TglDokumen between '2020-12-01 00:00:00' and '2020-12-23 23:59:59'

                                  UNION ALL
                                  SELECT no_koreksi AS 'NoDoc', 
                                         CONCAT('Usulan Adjusment (+) : ', catatan) AS 'Dokumen',
                                         tanggal AS 'TglDoc',
                                         trs_mutasi_koreksi.created_at as 'TimeDoc',
                                         trs_mutasi_koreksi.produk AS 'Kode' ,
                                         trs_mutasi_koreksi.nama_produk AS 'NamaProduk' ,
                                         Satuan AS 'Unit',
                                         qty AS 'qty_in',
                                         0 AS 'qty_out',
                                         batch AS 'BatchNo',
                                         exp_date AS 'ExpDate'
                                  FROM  trs_mutasi_koreksi INNER JOIN mst_produk ON mst_produk.`Kode_Produk` = trs_mutasi_koreksi.`produk`
                                  WHERE   qty > 0 AND trs_mutasi_koreksi.status IN ('Open','Approve') and
                                    trs_mutasi_koreksi.`produk` = 'SLRDS1' and 
                                        CASE WHEN trs_mutasi_koreksi.`Status` = 'Open' THEN
                                          tanggal
                                       ELSE
                                          IFNULL(DATE(tgl_approve),tanggal)
                                       END between '2020-12-01 00:00:00' and '2020-12-23 23:59:59'
                                  UNION ALL
                                  SELECT NoDokumen AS 'NoDoc', 
                                         CONCAT('Mutasi Gudang dari Gudang : ', gudang_awal,' Ke Gudang : ',gudang_akhir,' ~ QTY = ',qty) AS 'Dokumen',
                                         tanggal AS 'TglDoc',
                                         trs_mutasi_gudang.create_date as 'TimeDoc',
                                         trs_mutasi_gudang.produk AS 'Kode' ,
                                         trs_mutasi_gudang.namaproduk AS 'NamaProduk' ,
                                         '' AS 'Unit',
                                         0 AS 'qty_in',
                                         0 AS 'qty_out',
                                         batchno_awal AS 'BatchNo',
                                         expdate_awal AS 'ExpDate'
                                  FROM  trs_mutasi_gudang INNER JOIN mst_produk ON mst_produk.`Kode_Produk` = trs_mutasi_gudang.`produk`
                                  WHERE   qty > 0 AND trs_mutasi_gudang.status IN ('Open','Approve') and
                                    trs_mutasi_gudang.`produk` = 'SLRDS1' and 
                                        tanggal between '2020-12-01 00:00:00' and '2020-12-23 23:59:59'
                                  UNION ALL

                                  SELECT no_koreksi AS 'NoDoc', 
                                         CONCAT('Adjusment (+) : QTY = ',qty,' ', catatan) AS 'Dokumen',
                                         IFNULL(DATE(tgl_approve),tanggal) AS 'TglDoc',
                                         trs_mutasi_koreksi.created_at as 'TimeDoc',
                                         trs_mutasi_koreksi.produk AS 'Kode' ,
                                         trs_mutasi_koreksi.nama_produk AS 'NamaProduk' ,
                                         Satuan AS 'Unit',
                                         0 AS 'qty_in',
                                         0 AS 'qty_out',
                                         batch AS 'BatchNo',
                                         exp_date AS 'ExpDate'
                                  FROM  trs_mutasi_koreksi INNER JOIN mst_produk ON mst_produk.`Kode_Produk` = trs_mutasi_koreksi.`produk`
                                  WHERE   qty > 0 AND trs_mutasi_koreksi.status = 'Approve' and
                                    trs_mutasi_koreksi.`produk` = 'SLRDS1' and 
                                        IFNULL(DATE(tgl_approve),tanggal) between '2020-12-01 00:00:00' and '2020-12-23 23:59:59'
                                  UNION ALL

                                  SELECT No_Terima AS 'NoDoc', 
                                         CONCAT('Relokasi Dari Cabang  : ', Cabang_Pengirim) AS 'Dokumen',
                                         Tgl_terima AS 'TglDoc',
                                         Time_terima as 'TimeDoc',
                                         Produk AS 'Kode' ,
                                         NamaProduk AS 'NamaProduk' ,
                                         Satuan AS 'Unit',
                                         (Qty+Bonus) AS 'qty_in',
                                         0 AS 'qty_out',
                                         BatchNo AS 'BatchNo',
                                         ExpDate AS 'ExpDate'
                                  FROM  trs_relokasi_terima_detail 
                                  WHERE   (Qty > 0 or Bonus > 0) AND
                                        Status = 'Terima' and
                                        Produk = 'SLRDS1' and 
                                        Tgl_terima between '2020-12-01 00:00:00' and '2020-12-23 23:59:59'
                                    
                                  UNION ALL 

                                  SELECT NoFaktur AS 'NoDoc',
                                        CONCAT('Terima dari ',Pelanggan, ' - ' ,NamaPelanggan) AS 'Dokumen',
                                        TglFaktur AS 'TglDoc',
                                        TimeFaktur as 'TimeDoc',
                                        KodeProduk AS 'Kode', 
                                        NamaProduk AS 'NamaProduk',
                                        UOM AS 'Unit',
                                        (QtyFaktur+BonusFaktur) AS 'qty_in',
                                        0 AS 'qty_out',
                                        BatchNo,
                                        ExpDate
                                  FROM trs_faktur_detail 
                                  WHERE TipeDokumen ='Retur' AND 
                                        ifnull(status,'') != 'Batal' and
                                        KodeProduk = 'SLRDS1' and 
                                        TglFaktur between '2020-12-01 00:00:00' and '2020-12-23 23:59:59'

                                  UNION ALL


                                  SELECT NoDO AS 'NoDoc',
                                    CONCAT('Kirim ke ',Pelanggan, ' - ' ,NamaPelanggan) AS 'Dokumen',  
                                    TglDO AS 'TglDoc',
                                    TimeDO AS 'TimeDoc',
                                    KodeProduk AS 'Kode',
                                    NamaProduk AS 'NamaProduk',
                                    UOM AS 'Unit',
                                    0 AS 'qty_in', 
                                    (QtyDO+BonusDO) AS 'qty_out',
                                    BatchNo,ExpDate
                                  FROM trs_delivery_order_sales_detail 
                                  WHERE KodeProduk = 'SLRDS1'  
                                    AND TglDO BETWEEN '2020-12-01 00:00:00' and '2020-12-23 23:59:59' and tipedokumen ='DO'
                                  UNION ALL
                                  SELECT NoDO AS 'NoDoc',
                                    CONCAT('Batal Kirim ke ',Pelanggan, ' - ' ,NamaPelanggan) AS 'Dokumen',  
                                    TglDO AS 'TglDoc',
                                    TimeDO AS 'TimeDoc',
                                    KodeProduk AS 'Kode',
                                    NamaProduk AS 'NamaProduk',
                                    UOM AS 'Unit',
                                    (QtyDO+BonusDO) AS 'qty_in', 
                                    0 AS 'qty_out',
                                    BatchNo,ExpDate
                                  FROM trs_delivery_order_sales_detail 
                                  WHERE KodeProduk = 'SLRDS1' 
                                    AND Status = 'Batal' 
                                    AND date(ifnull(time_batal,'')) BETWEEN '2020-12-01 00:00:00' and '2020-12-23 23:59:59'
                                  UNION ALL
                                  SELECT NoDO AS 'NoDoc',
                                    CONCAT('Retur Kirim dari ',Pelanggan, ' - ' ,NamaPelanggan) AS 'Dokumen',  
                                    TglDO AS 'TglDoc',
                                    TimeDO AS 'TimeDoc',
                                    KodeProduk AS 'Kode',
                                    NamaProduk AS 'NamaProduk',
                                    UOM AS 'Unit',
                                    (QtyDO+BonusDO) AS 'qty_in', 
                                    0 AS 'qty_out',
                                    BatchNo,ExpDate
                                  FROM trs_delivery_order_sales_detail 
                                  WHERE KodeProduk = 'SLRDS1' and 
                                        TipeDokumen ='Retur' and Status = 'Retur' 
                                    AND TglDO BETWEEN '2020-12-01 00:00:00' and '2020-12-23 23:59:59'
                                  UNION ALL

                                  SELECT trs_relokasi_kirim_detail.No_Relokasi AS 'NoDoc', 
                                        CASE WHEN Status = 'ApproveLog' THEN
                                         CONCAT('Relokasi ke Cabang  : ', trs_relokasi_kirim_detail.Cabang_Penerima)
                                        ELSE
                                          CONCAT('Relokasi ke Cabang  : ', trs_relokasi_kirim_detail.Cabang_Penerima)
                                        END
                                         AS 'Dokumen',
                                         CASE WHEN tgl_app IS NULL THEN trs_relokasi_kirim_detail.Tgl_kirim ELSE trs_relokasi_kirim_detail.tgl_app END AS 'TglDoc',
                                         CASE WHEN tgl_app IS NULL THEN trs_relokasi_kirim_detail.Time_kirim ELSE trs_relokasi_kirim_detail.App_BM_Time END  'TimeDoc',
                                         Produk AS 'Kode' ,
                                         NamaProduk AS 'NamaProduk' ,
                                         Satuan AS 'Unit',
                                         0 AS 'qty_in',
                                         CASE WHEN Status = 'ApproveLog' THEN
                                         0
                                         ELSE
                                         (Qty+Bonus)
                                         END AS 'qty_out',
                                         BatchNo AS 'BatchNo',
                                         ExpDate AS 'ExpDate'
                                  FROM  trs_relokasi_kirim_detail
                                  WHERE trs_relokasi_kirim_detail.Status IN ('Kirim','Reject','RejectPusat','RejectCabPenerima','ApproveLog') and
                                        trs_relokasi_kirim_detail.Produk = 'SLRDS1' and 
                                          CASE WHEN tgl_app IS NULL THEN trs_relokasi_kirim_detail.Tgl_kirim ELSE trs_relokasi_kirim_detail.tgl_app END
                                         between '2020-12-01 00:00:00' and '2020-12-23 23:59:59' 

                                  UNION ALL

                                  SELECT trs_relokasi_kirim_detail.No_Relokasi AS 'NoDoc', 
                                         CASE WHEN Keterangan_reject LIKE '%Penerima%' THEN
                                          'Relokasi Reject Cabang Penerima'
                                         ELSE 
                                           'Relokasi Reject Pusat'
                                         END AS 'Dokumen',
                                         trs_relokasi_kirim_detail.tgl_reject AS 'TglDoc',
                                         trs_relokasi_kirim_detail.Time_kirim 'TimeDoc',
                                         Produk AS 'Kode' ,
                                         NamaProduk AS 'NamaProduk' ,
                                         Satuan AS 'Unit',
                                         (Qty+Bonus) AS 'qty_in',
                                         0 AS 'qty_out',
                                         BatchNo AS 'BatchNo',
                                         ExpDate AS 'ExpDate'
                                  FROM  trs_relokasi_kirim_detail
                                  WHERE trs_relokasi_kirim_detail.Status = 'Reject' and
                                        trs_relokasi_kirim_detail.Produk = 'SLRDS1' and 
                                        trs_relokasi_kirim_detail.Tgl_reject between '2020-12-01 00:00:00' and '2020-12-23 23:59:59'

                                  UNION ALL

                                  SELECT trs_usulan_retur_beli_header.No_Usulan AS 'NoDoc', 
                                        CONCAT('Usulan Retur Beli : QTY = ',((trs_usulan_retur_beli_detail.Qty+trs_usulan_retur_beli_detail.Bonus) * -1),'  ~ Ke : ',trs_usulan_retur_beli_header.Prinsipal) AS 'Dokumen',
                                        trs_usulan_retur_beli_header.Tanggal AS 'TglDoc',
                                        trs_usulan_retur_beli_header.added_time as 'TimeDoc',
                                        trs_usulan_retur_beli_detail.Produk AS 'Kode' ,
                                        trs_usulan_retur_beli_detail.Nama_produk AS 'NamaProduk' ,
                                        trs_usulan_retur_beli_detail.Satuan AS 'Unit',
                                        0 AS 'qty_in',
                                        0 AS 'qty_out',
                                        trs_usulan_retur_beli_detail.BatchNo AS 'BatchNo',
                                        trs_usulan_retur_beli_detail.ExpDate AS 'ExpDate'
                                  FROM  trs_usulan_retur_beli_header INNER JOIN trs_usulan_retur_beli_detail ON trs_usulan_retur_beli_header.No_Usulan = trs_usulan_retur_beli_detail.No_Usulan 
                                  WHERE ifnull(trs_usulan_retur_beli_header.App_BM_Status,'') <> 'R' and
                                    trs_usulan_retur_beli_detail.Produk = 'SLRDS1'and 
                                        trs_usulan_retur_beli_header.tanggal between '2020-12-01 00:00:00' and '2020-12-23 23:59:59'

                                  UNION ALL

                                  SELECT trs_usulan_retur_beli_header.No_Usulan AS 'NoDoc', 
                                        CONCAT('Reject Usulan Beli Pusat : QTY = ',((trs_usulan_retur_beli_detail.Qty+trs_usulan_retur_beli_detail.Bonus) * -1),'  ~ Ke : ',trs_usulan_retur_beli_header.Prinsipal) AS 'Dokumen',
                                        trs_usulan_retur_beli_header.Tanggal AS 'TglDoc',
                                        trs_usulan_retur_beli_header.added_time as 'TimeDoc',
                                        trs_usulan_retur_beli_detail.Produk AS 'Kode' ,
                                        trs_usulan_retur_beli_detail.Nama_produk AS 'NamaProduk' ,
                                        trs_usulan_retur_beli_detail.Satuan AS 'Unit',
                                        0 AS 'qty_in',
                                        0 AS 'qty_out',
                                        trs_usulan_retur_beli_detail.BatchNo AS 'BatchNo',
                                        trs_usulan_retur_beli_detail.ExpDate AS 'ExpDate'
                                  FROM  trs_usulan_retur_beli_header INNER JOIN trs_usulan_retur_beli_detail ON trs_usulan_retur_beli_header.No_Usulan = trs_usulan_retur_beli_detail.No_Usulan 
                                  WHERE ifnull(trs_usulan_retur_beli_header.App_BM_Status,'') <> 'R' and ifnull(trs_usulan_retur_beli_header.App_Pst_Status,'') = 'Reject' and
                                    trs_usulan_retur_beli_detail.Produk = 'SLRDS1'and 
                                        trs_usulan_retur_beli_header.tanggal between '2020-12-01 00:00:00' and '2020-12-23 23:59:59'
                                  
                                  UNION ALL

                                  SELECT no_koreksi AS 'NoDoc', 
                                        CONCAT('Usulan Adjusment (-): QTY = ',(qty * -1),' ',catatan) AS 'Dokumen',
                                        tanggal AS 'TglDoc',
                                        trs_mutasi_koreksi.created_at as 'TimeDoc',
                                        trs_mutasi_koreksi.produk AS 'Kode' ,
                                        trs_mutasi_koreksi.nama_produk AS 'NamaProduk' ,
                                        Satuan AS 'Unit',
                                        0 AS 'qty_in',
                                        0 AS 'qty_out',
                                        batch AS 'BatchNo',
                                        exp_date AS 'ExpDate'
                                  FROM  trs_mutasi_koreksi INNER JOIN mst_produk ON mst_produk.`Kode_Produk` = trs_mutasi_koreksi.`produk`
                                  WHERE   qty < 0 AND trs_mutasi_koreksi.status IN ('Open','Approve') and
                                    trs_mutasi_koreksi.`produk` = 'SLRDS1'and 
                                        CASE WHEN trs_mutasi_koreksi.`Status` = 'Open' THEN
                                            tanggal
                                         ELSE
                                            IFNULL(DATE(tgl_approve),tanggal)
                                         END between '2020-12-01 00:00:00' and '2020-12-23 23:59:59'
                                        
                                  UNION ALL

                                  SELECT no_koreksi AS 'NoDoc', 
                                        CONCAT('Adjusment (-): ',catatan) AS 'Dokumen',
                                        IFNULL(DATE(tgl_approve),tanggal) AS 'TglDoc',
                                        trs_mutasi_koreksi.created_at as 'TimeDoc',
                                        trs_mutasi_koreksi.produk AS 'Kode' ,
                                        trs_mutasi_koreksi.nama_produk AS 'NamaProduk' ,
                                        Satuan AS 'Unit',
                                        0 AS 'qty_in',
                                        (qty * -1) AS 'qty_out',
                                        batch AS 'BatchNo',
                                        exp_date AS 'ExpDate'
                                  FROM  trs_mutasi_koreksi INNER JOIN mst_produk ON mst_produk.`Kode_Produk` = trs_mutasi_koreksi.`produk`
                                  WHERE   qty < 0 AND trs_mutasi_koreksi.status = 'Approve' and
                                    trs_mutasi_koreksi.`produk` = 'SLRDS1'and 
                                        IFNULL(DATE(tgl_approve),tanggal) between '2020-12-01 00:00:00' and '2020-12-23 23:59:59'
                                  
                                  UNION ALL 

                                  SELECT nodokumen AS 'NoDoc', 
                                        CONCAT('Mutasi Batch Dari Batch ',batchno_awal,' ke Batch ',batchno_akhir,' : QTY = ',qty) AS 'Dokumen',
                                        DATE(tanggal) AS 'TglDoc',
                                        create_date AS 'TimeDoc',
                                        trs_mutasi_batch.produk AS 'Kode' ,
                                        namaproduk AS 'NamaProduk' ,
                                        '' AS 'Unit',
                                        0 AS 'qty_in',
                                        0 AS 'qty_out',
                                        batchno_akhir AS 'BatchNo',
                                        expdate_akhir AS 'ExpDate'
                                  FROM  trs_mutasi_batch INNER JOIN mst_produk ON mst_produk.`Kode_Produk` = trs_mutasi_batch.`produk`
                                  WHERE    trs_mutasi_batch.status = 'Approve' AND
                                    trs_mutasi_batch.`produk` = 'SLRDS1'AND 
                                        DATE(tanggal) BETWEEN '2020-12-01 00:00:00' and '2020-12-23 23:59:59'
                                        
                                  ORDER BY TglDoc,TimeDoc,NoDoc ASC;
ERROR - 2020-12-23 14:32:50 --> Severity: Notice --> Undefined offset: 1 D:\xampp70\htdocs\sstcabang\application\controllers\pembelian\Inventori.php 693
ERROR - 2020-12-23 14:32:50 --> Cabang
ERROR - 2020-12-23 14:32:50 --> Severity: Notice --> Undefined offset: 1 D:\xampp70\htdocs\sstcabang\application\controllers\pembelian\Inventori.php 617
ERROR - 2020-12-23 14:32:51 --> Query error: Unknown column 'trs_usulan_retur_beli_header.App_Pst_Status' in 'where clause' - Invalid query: SELECT NoDokumen AS 'NoDoc',
                                          CONCAT('Terima dari ',Prinsipal,' - ',Supplier) AS 'Dokumen',
                                          TglDokumen AS 'TglDoc',
                                          TimeDokumen as 'TimeDoc',
                                          Produk AS 'Kode',
                                          NamaProduk AS 'NamaProduk',
                                          Satuan AS 'Unit',
                                          (ifnull(Qty,'') + ifnull(Bonus,'')) AS 'qty_in',
                                          0 AS 'qty_out',
                                          BatchNo,
                                          ExpDate
                                  FROM trs_terima_barang_detail
                                  WHERE trs_terima_barang_detail.Produk = 'SLRDS1' and 
                                        Status not in ('pending','Batal') and
                                        ifnull(Tipe,'') not in  ('BKB','Tolakan') and
                                        TglDokumen between '2020-12-01 00:00:00' and '2020-12-23 23:59:59'
                                  
                                  UNION ALL

                                  SELECT NoDokumen AS 'NoDoc',
                                          CONCAT('Retur Ke ',Prinsipal,' - ',Supplier) AS 'Dokumen',
                                          TglDokumen AS 'TglDoc',
                                          TimeDokumen as 'TimeDoc',
                                          Produk AS 'Kode',
                                          NamaProduk AS 'NamaProduk',
                                          Satuan AS 'Unit',
                                          0 AS 'qty_in',
                                          (((ifnull(Qty,'') + ifnull(Bonus,'')))*-1) AS 'qty_out',
                                          BatchNo,
                                          ExpDate
                                  FROM trs_terima_barang_detail
                                  where   ifnull(Tipe,'') = 'BKB' and Produk = 'SLRDS1' and 
                                        TglDokumen between '2020-12-01 00:00:00' and '2020-12-23 23:59:59'
                                  
                                  UNION ALL
                                  SELECT NoDokumen AS 'NoDoc',
                                          CONCAT('Tolakan Retur ',Prinsipal,' - ',Supplier,' ~ Qty : ', (ifnull(Qty,'') + ifnull(Bonus,''))*-1) AS 'Dokumen',
                                          TglDokumen AS 'TglDoc',
                                          TimeDokumen as 'TimeDoc',
                                          Produk AS 'Kode',
                                          NamaProduk AS 'NamaProduk',
                                          Satuan AS 'Unit',
                                          0 AS 'qty_in',
                                          0 AS 'qty_out',
                                          BatchNo,
                                          ExpDate
                                  FROM trs_terima_barang_detail
                                  where   ifnull(Tipe,'') = 'Tolakan' and Produk = 'SLRDS1' and 
                                        TglDokumen between '2020-12-01 00:00:00' and '2020-12-23 23:59:59'

                                  UNION ALL
                                  SELECT no_koreksi AS 'NoDoc', 
                                         CONCAT('Usulan Adjusment (+) : ', catatan) AS 'Dokumen',
                                         tanggal AS 'TglDoc',
                                         trs_mutasi_koreksi.created_at as 'TimeDoc',
                                         trs_mutasi_koreksi.produk AS 'Kode' ,
                                         trs_mutasi_koreksi.nama_produk AS 'NamaProduk' ,
                                         Satuan AS 'Unit',
                                         qty AS 'qty_in',
                                         0 AS 'qty_out',
                                         batch AS 'BatchNo',
                                         exp_date AS 'ExpDate'
                                  FROM  trs_mutasi_koreksi INNER JOIN mst_produk ON mst_produk.`Kode_Produk` = trs_mutasi_koreksi.`produk`
                                  WHERE   qty > 0 AND trs_mutasi_koreksi.status IN ('Open','Approve') and
                                    trs_mutasi_koreksi.`produk` = 'SLRDS1' and 
                                        CASE WHEN trs_mutasi_koreksi.`Status` = 'Open' THEN
                                          tanggal
                                       ELSE
                                          IFNULL(DATE(tgl_approve),tanggal)
                                       END between '2020-12-01 00:00:00' and '2020-12-23 23:59:59'
                                  UNION ALL
                                  SELECT NoDokumen AS 'NoDoc', 
                                         CONCAT('Mutasi Gudang dari Gudang : ', gudang_awal,' Ke Gudang : ',gudang_akhir,' ~ QTY = ',qty) AS 'Dokumen',
                                         tanggal AS 'TglDoc',
                                         trs_mutasi_gudang.create_date as 'TimeDoc',
                                         trs_mutasi_gudang.produk AS 'Kode' ,
                                         trs_mutasi_gudang.namaproduk AS 'NamaProduk' ,
                                         '' AS 'Unit',
                                         0 AS 'qty_in',
                                         0 AS 'qty_out',
                                         batchno_awal AS 'BatchNo',
                                         expdate_awal AS 'ExpDate'
                                  FROM  trs_mutasi_gudang INNER JOIN mst_produk ON mst_produk.`Kode_Produk` = trs_mutasi_gudang.`produk`
                                  WHERE   qty > 0 AND trs_mutasi_gudang.status IN ('Open','Approve') and
                                    trs_mutasi_gudang.`produk` = 'SLRDS1' and 
                                        tanggal between '2020-12-01 00:00:00' and '2020-12-23 23:59:59'
                                  UNION ALL

                                  SELECT no_koreksi AS 'NoDoc', 
                                         CONCAT('Adjusment (+) : QTY = ',qty,' ', catatan) AS 'Dokumen',
                                         IFNULL(DATE(tgl_approve),tanggal) AS 'TglDoc',
                                         trs_mutasi_koreksi.created_at as 'TimeDoc',
                                         trs_mutasi_koreksi.produk AS 'Kode' ,
                                         trs_mutasi_koreksi.nama_produk AS 'NamaProduk' ,
                                         Satuan AS 'Unit',
                                         0 AS 'qty_in',
                                         0 AS 'qty_out',
                                         batch AS 'BatchNo',
                                         exp_date AS 'ExpDate'
                                  FROM  trs_mutasi_koreksi INNER JOIN mst_produk ON mst_produk.`Kode_Produk` = trs_mutasi_koreksi.`produk`
                                  WHERE   qty > 0 AND trs_mutasi_koreksi.status = 'Approve' and
                                    trs_mutasi_koreksi.`produk` = 'SLRDS1' and 
                                        IFNULL(DATE(tgl_approve),tanggal) between '2020-12-01 00:00:00' and '2020-12-23 23:59:59'
                                  UNION ALL

                                  SELECT No_Terima AS 'NoDoc', 
                                         CONCAT('Relokasi Dari Cabang  : ', Cabang_Pengirim) AS 'Dokumen',
                                         Tgl_terima AS 'TglDoc',
                                         Time_terima as 'TimeDoc',
                                         Produk AS 'Kode' ,
                                         NamaProduk AS 'NamaProduk' ,
                                         Satuan AS 'Unit',
                                         (Qty+Bonus) AS 'qty_in',
                                         0 AS 'qty_out',
                                         BatchNo AS 'BatchNo',
                                         ExpDate AS 'ExpDate'
                                  FROM  trs_relokasi_terima_detail 
                                  WHERE   (Qty > 0 or Bonus > 0) AND
                                        Status = 'Terima' and
                                        Produk = 'SLRDS1' and 
                                        Tgl_terima between '2020-12-01 00:00:00' and '2020-12-23 23:59:59'
                                    
                                  UNION ALL 

                                  SELECT NoFaktur AS 'NoDoc',
                                        CONCAT('Terima dari ',Pelanggan, ' - ' ,NamaPelanggan) AS 'Dokumen',
                                        TglFaktur AS 'TglDoc',
                                        TimeFaktur as 'TimeDoc',
                                        KodeProduk AS 'Kode', 
                                        NamaProduk AS 'NamaProduk',
                                        UOM AS 'Unit',
                                        (QtyFaktur+BonusFaktur) AS 'qty_in',
                                        0 AS 'qty_out',
                                        BatchNo,
                                        ExpDate
                                  FROM trs_faktur_detail 
                                  WHERE TipeDokumen ='Retur' AND 
                                        ifnull(status,'') != 'Batal' and
                                        KodeProduk = 'SLRDS1' and 
                                        TglFaktur between '2020-12-01 00:00:00' and '2020-12-23 23:59:59'

                                  UNION ALL


                                  SELECT NoDO AS 'NoDoc',
                                    CONCAT('Kirim ke ',Pelanggan, ' - ' ,NamaPelanggan) AS 'Dokumen',  
                                    TglDO AS 'TglDoc',
                                    TimeDO AS 'TimeDoc',
                                    KodeProduk AS 'Kode',
                                    NamaProduk AS 'NamaProduk',
                                    UOM AS 'Unit',
                                    0 AS 'qty_in', 
                                    (QtyDO+BonusDO) AS 'qty_out',
                                    BatchNo,ExpDate
                                  FROM trs_delivery_order_sales_detail 
                                  WHERE KodeProduk = 'SLRDS1'  
                                    AND TglDO BETWEEN '2020-12-01 00:00:00' and '2020-12-23 23:59:59' and tipedokumen ='DO'
                                  UNION ALL
                                  SELECT NoDO AS 'NoDoc',
                                    CONCAT('Batal Kirim ke ',Pelanggan, ' - ' ,NamaPelanggan) AS 'Dokumen',  
                                    TglDO AS 'TglDoc',
                                    TimeDO AS 'TimeDoc',
                                    KodeProduk AS 'Kode',
                                    NamaProduk AS 'NamaProduk',
                                    UOM AS 'Unit',
                                    (QtyDO+BonusDO) AS 'qty_in', 
                                    0 AS 'qty_out',
                                    BatchNo,ExpDate
                                  FROM trs_delivery_order_sales_detail 
                                  WHERE KodeProduk = 'SLRDS1' 
                                    AND Status = 'Batal' 
                                    AND date(ifnull(time_batal,'')) BETWEEN '2020-12-01 00:00:00' and '2020-12-23 23:59:59'
                                  UNION ALL
                                  SELECT NoDO AS 'NoDoc',
                                    CONCAT('Retur Kirim dari ',Pelanggan, ' - ' ,NamaPelanggan) AS 'Dokumen',  
                                    TglDO AS 'TglDoc',
                                    TimeDO AS 'TimeDoc',
                                    KodeProduk AS 'Kode',
                                    NamaProduk AS 'NamaProduk',
                                    UOM AS 'Unit',
                                    (QtyDO+BonusDO) AS 'qty_in', 
                                    0 AS 'qty_out',
                                    BatchNo,ExpDate
                                  FROM trs_delivery_order_sales_detail 
                                  WHERE KodeProduk = 'SLRDS1' and 
                                        TipeDokumen ='Retur' and Status = 'Retur' 
                                    AND TglDO BETWEEN '2020-12-01 00:00:00' and '2020-12-23 23:59:59'
                                  UNION ALL

                                  SELECT trs_relokasi_kirim_detail.No_Relokasi AS 'NoDoc', 
                                        CASE WHEN Status = 'ApproveLog' THEN
                                         CONCAT('Relokasi ke Cabang  : ', trs_relokasi_kirim_detail.Cabang_Penerima)
                                        ELSE
                                          CONCAT('Relokasi ke Cabang  : ', trs_relokasi_kirim_detail.Cabang_Penerima)
                                        END
                                         AS 'Dokumen',
                                         CASE WHEN tgl_app IS NULL THEN trs_relokasi_kirim_detail.Tgl_kirim ELSE trs_relokasi_kirim_detail.tgl_app END AS 'TglDoc',
                                         CASE WHEN tgl_app IS NULL THEN trs_relokasi_kirim_detail.Time_kirim ELSE trs_relokasi_kirim_detail.App_BM_Time END  'TimeDoc',
                                         Produk AS 'Kode' ,
                                         NamaProduk AS 'NamaProduk' ,
                                         Satuan AS 'Unit',
                                         0 AS 'qty_in',
                                         CASE WHEN Status = 'ApproveLog' THEN
                                         0
                                         ELSE
                                         (Qty+Bonus)
                                         END AS 'qty_out',
                                         BatchNo AS 'BatchNo',
                                         ExpDate AS 'ExpDate'
                                  FROM  trs_relokasi_kirim_detail
                                  WHERE trs_relokasi_kirim_detail.Status IN ('Kirim','Reject','RejectPusat','RejectCabPenerima','ApproveLog') and
                                        trs_relokasi_kirim_detail.Produk = 'SLRDS1' and 
                                          CASE WHEN tgl_app IS NULL THEN trs_relokasi_kirim_detail.Tgl_kirim ELSE trs_relokasi_kirim_detail.tgl_app END
                                         between '2020-12-01 00:00:00' and '2020-12-23 23:59:59' 

                                  UNION ALL

                                  SELECT trs_relokasi_kirim_detail.No_Relokasi AS 'NoDoc', 
                                         CASE WHEN Keterangan_reject LIKE '%Penerima%' THEN
                                          'Relokasi Reject Cabang Penerima'
                                         ELSE 
                                           'Relokasi Reject Pusat'
                                         END AS 'Dokumen',
                                         trs_relokasi_kirim_detail.tgl_reject AS 'TglDoc',
                                         trs_relokasi_kirim_detail.Time_kirim 'TimeDoc',
                                         Produk AS 'Kode' ,
                                         NamaProduk AS 'NamaProduk' ,
                                         Satuan AS 'Unit',
                                         (Qty+Bonus) AS 'qty_in',
                                         0 AS 'qty_out',
                                         BatchNo AS 'BatchNo',
                                         ExpDate AS 'ExpDate'
                                  FROM  trs_relokasi_kirim_detail
                                  WHERE trs_relokasi_kirim_detail.Status = 'Reject' and
                                        trs_relokasi_kirim_detail.Produk = 'SLRDS1' and 
                                        trs_relokasi_kirim_detail.Tgl_reject between '2020-12-01 00:00:00' and '2020-12-23 23:59:59'

                                  UNION ALL

                                  SELECT trs_usulan_retur_beli_header.No_Usulan AS 'NoDoc', 
                                        CONCAT('Usulan Retur Beli : QTY = ',((trs_usulan_retur_beli_detail.Qty+trs_usulan_retur_beli_detail.Bonus) * -1),'  ~ Ke : ',trs_usulan_retur_beli_header.Prinsipal) AS 'Dokumen',
                                        trs_usulan_retur_beli_header.Tanggal AS 'TglDoc',
                                        trs_usulan_retur_beli_header.added_time as 'TimeDoc',
                                        trs_usulan_retur_beli_detail.Produk AS 'Kode' ,
                                        trs_usulan_retur_beli_detail.Nama_produk AS 'NamaProduk' ,
                                        trs_usulan_retur_beli_detail.Satuan AS 'Unit',
                                        0 AS 'qty_in',
                                        0 AS 'qty_out',
                                        trs_usulan_retur_beli_detail.BatchNo AS 'BatchNo',
                                        trs_usulan_retur_beli_detail.ExpDate AS 'ExpDate'
                                  FROM  trs_usulan_retur_beli_header INNER JOIN trs_usulan_retur_beli_detail ON trs_usulan_retur_beli_header.No_Usulan = trs_usulan_retur_beli_detail.No_Usulan 
                                  WHERE ifnull(trs_usulan_retur_beli_header.App_BM_Status,'') <> 'R' and
                                    trs_usulan_retur_beli_detail.Produk = 'SLRDS1'and 
                                        trs_usulan_retur_beli_header.tanggal between '2020-12-01 00:00:00' and '2020-12-23 23:59:59'

                                  UNION ALL

                                  SELECT trs_usulan_retur_beli_header.No_Usulan AS 'NoDoc', 
                                        CONCAT('Reject Usulan Beli Pusat : QTY = ',((trs_usulan_retur_beli_detail.Qty+trs_usulan_retur_beli_detail.Bonus) * -1),'  ~ Ke : ',trs_usulan_retur_beli_header.Prinsipal) AS 'Dokumen',
                                        trs_usulan_retur_beli_header.Tanggal AS 'TglDoc',
                                        trs_usulan_retur_beli_header.added_time as 'TimeDoc',
                                        trs_usulan_retur_beli_detail.Produk AS 'Kode' ,
                                        trs_usulan_retur_beli_detail.Nama_produk AS 'NamaProduk' ,
                                        trs_usulan_retur_beli_detail.Satuan AS 'Unit',
                                        0 AS 'qty_in',
                                        0 AS 'qty_out',
                                        trs_usulan_retur_beli_detail.BatchNo AS 'BatchNo',
                                        trs_usulan_retur_beli_detail.ExpDate AS 'ExpDate'
                                  FROM  trs_usulan_retur_beli_header INNER JOIN trs_usulan_retur_beli_detail ON trs_usulan_retur_beli_header.No_Usulan = trs_usulan_retur_beli_detail.No_Usulan 
                                  WHERE ifnull(trs_usulan_retur_beli_header.App_BM_Status,'') <> 'R' and ifnull(trs_usulan_retur_beli_header.App_Pst_Status,'') = 'Reject' and
                                    trs_usulan_retur_beli_detail.Produk = 'SLRDS1'and 
                                        trs_usulan_retur_beli_header.tanggal between '2020-12-01 00:00:00' and '2020-12-23 23:59:59'
                                  
                                  UNION ALL

                                  SELECT no_koreksi AS 'NoDoc', 
                                        CONCAT('Usulan Adjusment (-): QTY = ',(qty * -1),' ',catatan) AS 'Dokumen',
                                        tanggal AS 'TglDoc',
                                        trs_mutasi_koreksi.created_at as 'TimeDoc',
                                        trs_mutasi_koreksi.produk AS 'Kode' ,
                                        trs_mutasi_koreksi.nama_produk AS 'NamaProduk' ,
                                        Satuan AS 'Unit',
                                        0 AS 'qty_in',
                                        0 AS 'qty_out',
                                        batch AS 'BatchNo',
                                        exp_date AS 'ExpDate'
                                  FROM  trs_mutasi_koreksi INNER JOIN mst_produk ON mst_produk.`Kode_Produk` = trs_mutasi_koreksi.`produk`
                                  WHERE   qty < 0 AND trs_mutasi_koreksi.status IN ('Open','Approve') and
                                    trs_mutasi_koreksi.`produk` = 'SLRDS1'and 
                                        CASE WHEN trs_mutasi_koreksi.`Status` = 'Open' THEN
                                            tanggal
                                         ELSE
                                            IFNULL(DATE(tgl_approve),tanggal)
                                         END between '2020-12-01 00:00:00' and '2020-12-23 23:59:59'
                                        
                                  UNION ALL

                                  SELECT no_koreksi AS 'NoDoc', 
                                        CONCAT('Adjusment (-): ',catatan) AS 'Dokumen',
                                        IFNULL(DATE(tgl_approve),tanggal) AS 'TglDoc',
                                        trs_mutasi_koreksi.created_at as 'TimeDoc',
                                        trs_mutasi_koreksi.produk AS 'Kode' ,
                                        trs_mutasi_koreksi.nama_produk AS 'NamaProduk' ,
                                        Satuan AS 'Unit',
                                        0 AS 'qty_in',
                                        (qty * -1) AS 'qty_out',
                                        batch AS 'BatchNo',
                                        exp_date AS 'ExpDate'
                                  FROM  trs_mutasi_koreksi INNER JOIN mst_produk ON mst_produk.`Kode_Produk` = trs_mutasi_koreksi.`produk`
                                  WHERE   qty < 0 AND trs_mutasi_koreksi.status = 'Approve' and
                                    trs_mutasi_koreksi.`produk` = 'SLRDS1'and 
                                        IFNULL(DATE(tgl_approve),tanggal) between '2020-12-01 00:00:00' and '2020-12-23 23:59:59'
                                  
                                  UNION ALL 

                                  SELECT nodokumen AS 'NoDoc', 
                                        CONCAT('Mutasi Batch Dari Batch ',batchno_awal,' ke Batch ',batchno_akhir,' : QTY = ',qty) AS 'Dokumen',
                                        DATE(tanggal) AS 'TglDoc',
                                        create_date AS 'TimeDoc',
                                        trs_mutasi_batch.produk AS 'Kode' ,
                                        namaproduk AS 'NamaProduk' ,
                                        '' AS 'Unit',
                                        0 AS 'qty_in',
                                        0 AS 'qty_out',
                                        batchno_akhir AS 'BatchNo',
                                        expdate_akhir AS 'ExpDate'
                                  FROM  trs_mutasi_batch INNER JOIN mst_produk ON mst_produk.`Kode_Produk` = trs_mutasi_batch.`produk`
                                  WHERE    trs_mutasi_batch.status = 'Approve' AND
                                    trs_mutasi_batch.`produk` = 'SLRDS1'AND 
                                        DATE(tanggal) BETWEEN '2020-12-01 00:00:00' and '2020-12-23 23:59:59'
                                        
                                  ORDER BY TglDoc,TimeDoc,NoDoc ASC;
ERROR - 2020-12-23 14:35:13 --> 404 Page Not Found: /index
ERROR - 2020-12-23 14:37:57 --> 404 Page Not Found: /index
ERROR - 2020-12-23 14:38:52 --> Query error: Unknown column 'App_Pst_Time' in 'field list' - Invalid query: update trs_usulan_retur_beli_header set Status_Usulan = "Close", App_Log_Status = "Reject", 
                            App_Pst_Time = "2020-12-23 14:38:52" where  No_Usulan = "RTR-N/MTM/18/231220/1000219"
ERROR - 2020-12-23 14:39:12 --> 404 Page Not Found: /index
ERROR - 2020-12-23 15:01:48 --> Cabang
ERROR - 2020-12-23 15:05:00 --> 404 Page Not Found: /index
ERROR - 2020-12-23 15:07:47 --> 404 Page Not Found: /index
ERROR - 2020-12-23 15:07:47 --> 404 Page Not Found: /index
ERROR - 2020-12-23 15:12:59 --> 404 Page Not Found: /index
ERROR - 2020-12-23 15:13:56 --> Cabang
ERROR - 2020-12-23 15:18:00 --> Severity: Notice --> Undefined property: mysqli::$No_Usulan D:\xampp70\htdocs\sstcabang\application\models\pembelian\Model_retur_beli.php 1246
ERROR - 2020-12-23 15:18:00 --> Severity: Notice --> Undefined property: mysqli::$App_Log_Status D:\xampp70\htdocs\sstcabang\application\models\pembelian\Model_retur_beli.php 1246
ERROR - 2020-12-23 15:18:00 --> Severity: Notice --> Undefined property: mysqli::$App_Log_Status D:\xampp70\htdocs\sstcabang\application\models\pembelian\Model_retur_beli.php 1251
ERROR - 2020-12-23 15:18:00 --> Severity: Notice --> Undefined property: mysqli::$No_Usulan D:\xampp70\htdocs\sstcabang\application\models\pembelian\Model_retur_beli.php 1252
ERROR - 2020-12-23 15:18:00 --> Severity: Notice --> Undefined property: mysqli::$No_Usulan D:\xampp70\htdocs\sstcabang\application\models\pembelian\Model_retur_beli.php 1257
ERROR - 2020-12-23 15:18:00 --> Severity: Notice --> Undefined property: mysqli::$No_Usulan D:\xampp70\htdocs\sstcabang\application\models\pembelian\Model_retur_beli.php 1289
ERROR - 2020-12-23 15:18:00 --> Severity: Notice --> Undefined property: mysqli_result::$No_Usulan D:\xampp70\htdocs\sstcabang\application\models\pembelian\Model_retur_beli.php 1246
ERROR - 2020-12-23 15:18:00 --> Severity: Notice --> Undefined property: mysqli_result::$App_Log_Status D:\xampp70\htdocs\sstcabang\application\models\pembelian\Model_retur_beli.php 1246
ERROR - 2020-12-23 15:18:00 --> Severity: Notice --> Undefined property: mysqli_result::$App_Log_Status D:\xampp70\htdocs\sstcabang\application\models\pembelian\Model_retur_beli.php 1251
ERROR - 2020-12-23 15:18:00 --> Severity: Notice --> Undefined property: mysqli_result::$No_Usulan D:\xampp70\htdocs\sstcabang\application\models\pembelian\Model_retur_beli.php 1252
ERROR - 2020-12-23 15:18:00 --> Severity: Notice --> Undefined property: mysqli_result::$No_Usulan D:\xampp70\htdocs\sstcabang\application\models\pembelian\Model_retur_beli.php 1257
ERROR - 2020-12-23 15:18:00 --> Severity: Notice --> Undefined property: mysqli_result::$No_Usulan D:\xampp70\htdocs\sstcabang\application\models\pembelian\Model_retur_beli.php 1289
ERROR - 2020-12-23 15:18:00 --> Severity: Notice --> Trying to get property of non-object D:\xampp70\htdocs\sstcabang\application\models\pembelian\Model_retur_beli.php 1246
ERROR - 2020-12-23 15:18:00 --> Severity: Notice --> Trying to get property of non-object D:\xampp70\htdocs\sstcabang\application\models\pembelian\Model_retur_beli.php 1246
ERROR - 2020-12-23 15:18:00 --> Severity: Notice --> Trying to get property of non-object D:\xampp70\htdocs\sstcabang\application\models\pembelian\Model_retur_beli.php 1251
ERROR - 2020-12-23 15:18:00 --> Severity: Notice --> Trying to get property of non-object D:\xampp70\htdocs\sstcabang\application\models\pembelian\Model_retur_beli.php 1252
ERROR - 2020-12-23 15:18:00 --> Severity: Notice --> Trying to get property of non-object D:\xampp70\htdocs\sstcabang\application\models\pembelian\Model_retur_beli.php 1257
ERROR - 2020-12-23 15:18:00 --> Severity: Notice --> Trying to get property of non-object D:\xampp70\htdocs\sstcabang\application\models\pembelian\Model_retur_beli.php 1289
ERROR - 2020-12-23 15:18:00 --> Severity: Notice --> Trying to get property of non-object D:\xampp70\htdocs\sstcabang\application\models\pembelian\Model_retur_beli.php 1246
ERROR - 2020-12-23 15:18:00 --> Severity: Notice --> Trying to get property of non-object D:\xampp70\htdocs\sstcabang\application\models\pembelian\Model_retur_beli.php 1246
ERROR - 2020-12-23 15:18:00 --> Severity: Notice --> Trying to get property of non-object D:\xampp70\htdocs\sstcabang\application\models\pembelian\Model_retur_beli.php 1251
ERROR - 2020-12-23 15:18:00 --> Severity: Notice --> Trying to get property of non-object D:\xampp70\htdocs\sstcabang\application\models\pembelian\Model_retur_beli.php 1252
ERROR - 2020-12-23 15:18:00 --> Severity: Notice --> Trying to get property of non-object D:\xampp70\htdocs\sstcabang\application\models\pembelian\Model_retur_beli.php 1257
ERROR - 2020-12-23 15:18:00 --> Severity: Notice --> Trying to get property of non-object D:\xampp70\htdocs\sstcabang\application\models\pembelian\Model_retur_beli.php 1289
ERROR - 2020-12-23 15:18:00 --> Severity: Notice --> Trying to get property of non-object D:\xampp70\htdocs\sstcabang\application\models\pembelian\Model_retur_beli.php 1246
ERROR - 2020-12-23 15:18:00 --> Severity: Notice --> Trying to get property of non-object D:\xampp70\htdocs\sstcabang\application\models\pembelian\Model_retur_beli.php 1246
ERROR - 2020-12-23 15:18:00 --> Severity: Notice --> Trying to get property of non-object D:\xampp70\htdocs\sstcabang\application\models\pembelian\Model_retur_beli.php 1251
ERROR - 2020-12-23 15:18:00 --> Severity: Notice --> Trying to get property of non-object D:\xampp70\htdocs\sstcabang\application\models\pembelian\Model_retur_beli.php 1252
ERROR - 2020-12-23 15:18:00 --> Severity: Notice --> Trying to get property of non-object D:\xampp70\htdocs\sstcabang\application\models\pembelian\Model_retur_beli.php 1257
ERROR - 2020-12-23 15:18:00 --> Severity: Notice --> Trying to get property of non-object D:\xampp70\htdocs\sstcabang\application\models\pembelian\Model_retur_beli.php 1289
ERROR - 2020-12-23 15:18:00 --> Severity: Notice --> Trying to get property of non-object D:\xampp70\htdocs\sstcabang\application\models\pembelian\Model_retur_beli.php 1246
ERROR - 2020-12-23 15:18:00 --> Severity: Notice --> Trying to get property of non-object D:\xampp70\htdocs\sstcabang\application\models\pembelian\Model_retur_beli.php 1246
ERROR - 2020-12-23 15:18:00 --> Severity: Notice --> Trying to get property of non-object D:\xampp70\htdocs\sstcabang\application\models\pembelian\Model_retur_beli.php 1251
ERROR - 2020-12-23 15:18:00 --> Severity: Notice --> Trying to get property of non-object D:\xampp70\htdocs\sstcabang\application\models\pembelian\Model_retur_beli.php 1252
ERROR - 2020-12-23 15:18:00 --> Severity: Notice --> Trying to get property of non-object D:\xampp70\htdocs\sstcabang\application\models\pembelian\Model_retur_beli.php 1257
ERROR - 2020-12-23 15:18:00 --> Severity: Notice --> Trying to get property of non-object D:\xampp70\htdocs\sstcabang\application\models\pembelian\Model_retur_beli.php 1289
ERROR - 2020-12-23 15:18:00 --> Severity: Notice --> Trying to get property of non-object D:\xampp70\htdocs\sstcabang\application\models\pembelian\Model_retur_beli.php 1246
ERROR - 2020-12-23 15:18:00 --> Severity: Notice --> Trying to get property of non-object D:\xampp70\htdocs\sstcabang\application\models\pembelian\Model_retur_beli.php 1246
ERROR - 2020-12-23 15:18:00 --> Severity: Notice --> Trying to get property of non-object D:\xampp70\htdocs\sstcabang\application\models\pembelian\Model_retur_beli.php 1251
ERROR - 2020-12-23 15:18:00 --> Severity: Notice --> Trying to get property of non-object D:\xampp70\htdocs\sstcabang\application\models\pembelian\Model_retur_beli.php 1252
ERROR - 2020-12-23 15:18:00 --> Severity: Notice --> Trying to get property of non-object D:\xampp70\htdocs\sstcabang\application\models\pembelian\Model_retur_beli.php 1257
ERROR - 2020-12-23 15:18:00 --> Severity: Notice --> Trying to get property of non-object D:\xampp70\htdocs\sstcabang\application\models\pembelian\Model_retur_beli.php 1289
ERROR - 2020-12-23 15:18:00 --> Severity: Notice --> Trying to get property of non-object D:\xampp70\htdocs\sstcabang\application\models\pembelian\Model_retur_beli.php 1246
ERROR - 2020-12-23 15:18:00 --> Severity: Notice --> Trying to get property of non-object D:\xampp70\htdocs\sstcabang\application\models\pembelian\Model_retur_beli.php 1246
ERROR - 2020-12-23 15:18:00 --> Severity: Notice --> Trying to get property of non-object D:\xampp70\htdocs\sstcabang\application\models\pembelian\Model_retur_beli.php 1251
ERROR - 2020-12-23 15:18:00 --> Severity: Notice --> Trying to get property of non-object D:\xampp70\htdocs\sstcabang\application\models\pembelian\Model_retur_beli.php 1252
ERROR - 2020-12-23 15:18:00 --> Severity: Notice --> Trying to get property of non-object D:\xampp70\htdocs\sstcabang\application\models\pembelian\Model_retur_beli.php 1257
ERROR - 2020-12-23 15:18:00 --> Severity: Notice --> Trying to get property of non-object D:\xampp70\htdocs\sstcabang\application\models\pembelian\Model_retur_beli.php 1289
ERROR - 2020-12-23 15:18:13 --> Severity: Notice --> Undefined property: mysqli::$No_Usulan D:\xampp70\htdocs\sstcabang\application\models\pembelian\Model_retur_beli.php 1246
ERROR - 2020-12-23 15:18:13 --> Severity: Notice --> Undefined property: mysqli::$App_Log_Status D:\xampp70\htdocs\sstcabang\application\models\pembelian\Model_retur_beli.php 1246
ERROR - 2020-12-23 15:18:13 --> Severity: Notice --> Undefined property: mysqli::$App_Log_Status D:\xampp70\htdocs\sstcabang\application\models\pembelian\Model_retur_beli.php 1251
ERROR - 2020-12-23 15:18:13 --> Severity: Notice --> Undefined property: mysqli::$No_Usulan D:\xampp70\htdocs\sstcabang\application\models\pembelian\Model_retur_beli.php 1252
ERROR - 2020-12-23 15:18:13 --> Severity: Notice --> Undefined property: mysqli::$No_Usulan D:\xampp70\htdocs\sstcabang\application\models\pembelian\Model_retur_beli.php 1257
ERROR - 2020-12-23 15:18:13 --> Severity: Notice --> Undefined property: mysqli::$No_Usulan D:\xampp70\htdocs\sstcabang\application\models\pembelian\Model_retur_beli.php 1289
ERROR - 2020-12-23 15:18:13 --> Severity: Notice --> Undefined property: mysqli_result::$No_Usulan D:\xampp70\htdocs\sstcabang\application\models\pembelian\Model_retur_beli.php 1246
ERROR - 2020-12-23 15:18:13 --> Severity: Notice --> Undefined property: mysqli_result::$App_Log_Status D:\xampp70\htdocs\sstcabang\application\models\pembelian\Model_retur_beli.php 1246
ERROR - 2020-12-23 15:18:13 --> Severity: Notice --> Undefined property: mysqli_result::$App_Log_Status D:\xampp70\htdocs\sstcabang\application\models\pembelian\Model_retur_beli.php 1251
ERROR - 2020-12-23 15:18:13 --> Severity: Notice --> Undefined property: mysqli_result::$No_Usulan D:\xampp70\htdocs\sstcabang\application\models\pembelian\Model_retur_beli.php 1252
ERROR - 2020-12-23 15:18:13 --> Severity: Notice --> Undefined property: mysqli_result::$No_Usulan D:\xampp70\htdocs\sstcabang\application\models\pembelian\Model_retur_beli.php 1257
ERROR - 2020-12-23 15:18:13 --> Severity: Notice --> Undefined property: mysqli_result::$No_Usulan D:\xampp70\htdocs\sstcabang\application\models\pembelian\Model_retur_beli.php 1289
ERROR - 2020-12-23 15:18:13 --> Severity: Notice --> Trying to get property of non-object D:\xampp70\htdocs\sstcabang\application\models\pembelian\Model_retur_beli.php 1246
ERROR - 2020-12-23 15:18:13 --> Severity: Notice --> Trying to get property of non-object D:\xampp70\htdocs\sstcabang\application\models\pembelian\Model_retur_beli.php 1246
ERROR - 2020-12-23 15:18:13 --> Severity: Notice --> Trying to get property of non-object D:\xampp70\htdocs\sstcabang\application\models\pembelian\Model_retur_beli.php 1251
ERROR - 2020-12-23 15:18:13 --> Severity: Notice --> Trying to get property of non-object D:\xampp70\htdocs\sstcabang\application\models\pembelian\Model_retur_beli.php 1252
ERROR - 2020-12-23 15:18:13 --> Severity: Notice --> Trying to get property of non-object D:\xampp70\htdocs\sstcabang\application\models\pembelian\Model_retur_beli.php 1257
ERROR - 2020-12-23 15:18:13 --> Severity: Notice --> Trying to get property of non-object D:\xampp70\htdocs\sstcabang\application\models\pembelian\Model_retur_beli.php 1289
ERROR - 2020-12-23 15:18:13 --> Severity: Notice --> Trying to get property of non-object D:\xampp70\htdocs\sstcabang\application\models\pembelian\Model_retur_beli.php 1246
ERROR - 2020-12-23 15:18:13 --> Severity: Notice --> Trying to get property of non-object D:\xampp70\htdocs\sstcabang\application\models\pembelian\Model_retur_beli.php 1246
ERROR - 2020-12-23 15:18:13 --> Severity: Notice --> Trying to get property of non-object D:\xampp70\htdocs\sstcabang\application\models\pembelian\Model_retur_beli.php 1251
ERROR - 2020-12-23 15:18:13 --> Severity: Notice --> Trying to get property of non-object D:\xampp70\htdocs\sstcabang\application\models\pembelian\Model_retur_beli.php 1252
ERROR - 2020-12-23 15:18:13 --> Severity: Notice --> Trying to get property of non-object D:\xampp70\htdocs\sstcabang\application\models\pembelian\Model_retur_beli.php 1257
ERROR - 2020-12-23 15:18:13 --> Severity: Notice --> Trying to get property of non-object D:\xampp70\htdocs\sstcabang\application\models\pembelian\Model_retur_beli.php 1289
ERROR - 2020-12-23 15:18:13 --> Severity: Notice --> Trying to get property of non-object D:\xampp70\htdocs\sstcabang\application\models\pembelian\Model_retur_beli.php 1246
ERROR - 2020-12-23 15:18:13 --> Severity: Notice --> Trying to get property of non-object D:\xampp70\htdocs\sstcabang\application\models\pembelian\Model_retur_beli.php 1246
ERROR - 2020-12-23 15:18:13 --> Severity: Notice --> Trying to get property of non-object D:\xampp70\htdocs\sstcabang\application\models\pembelian\Model_retur_beli.php 1251
ERROR - 2020-12-23 15:18:13 --> Severity: Notice --> Trying to get property of non-object D:\xampp70\htdocs\sstcabang\application\models\pembelian\Model_retur_beli.php 1252
ERROR - 2020-12-23 15:18:13 --> Severity: Notice --> Trying to get property of non-object D:\xampp70\htdocs\sstcabang\application\models\pembelian\Model_retur_beli.php 1257
ERROR - 2020-12-23 15:18:13 --> Severity: Notice --> Trying to get property of non-object D:\xampp70\htdocs\sstcabang\application\models\pembelian\Model_retur_beli.php 1289
ERROR - 2020-12-23 15:18:13 --> Severity: Notice --> Trying to get property of non-object D:\xampp70\htdocs\sstcabang\application\models\pembelian\Model_retur_beli.php 1246
ERROR - 2020-12-23 15:18:13 --> Severity: Notice --> Trying to get property of non-object D:\xampp70\htdocs\sstcabang\application\models\pembelian\Model_retur_beli.php 1246
ERROR - 2020-12-23 15:18:13 --> Severity: Notice --> Trying to get property of non-object D:\xampp70\htdocs\sstcabang\application\models\pembelian\Model_retur_beli.php 1251
ERROR - 2020-12-23 15:18:13 --> Severity: Notice --> Trying to get property of non-object D:\xampp70\htdocs\sstcabang\application\models\pembelian\Model_retur_beli.php 1252
ERROR - 2020-12-23 15:18:13 --> Severity: Notice --> Trying to get property of non-object D:\xampp70\htdocs\sstcabang\application\models\pembelian\Model_retur_beli.php 1257
ERROR - 2020-12-23 15:18:13 --> Severity: Notice --> Trying to get property of non-object D:\xampp70\htdocs\sstcabang\application\models\pembelian\Model_retur_beli.php 1289
ERROR - 2020-12-23 15:18:13 --> Severity: Notice --> Trying to get property of non-object D:\xampp70\htdocs\sstcabang\application\models\pembelian\Model_retur_beli.php 1246
ERROR - 2020-12-23 15:18:13 --> Severity: Notice --> Trying to get property of non-object D:\xampp70\htdocs\sstcabang\application\models\pembelian\Model_retur_beli.php 1246
ERROR - 2020-12-23 15:18:13 --> Severity: Notice --> Trying to get property of non-object D:\xampp70\htdocs\sstcabang\application\models\pembelian\Model_retur_beli.php 1251
ERROR - 2020-12-23 15:18:13 --> Severity: Notice --> Trying to get property of non-object D:\xampp70\htdocs\sstcabang\application\models\pembelian\Model_retur_beli.php 1252
ERROR - 2020-12-23 15:18:13 --> Severity: Notice --> Trying to get property of non-object D:\xampp70\htdocs\sstcabang\application\models\pembelian\Model_retur_beli.php 1257
ERROR - 2020-12-23 15:18:13 --> Severity: Notice --> Trying to get property of non-object D:\xampp70\htdocs\sstcabang\application\models\pembelian\Model_retur_beli.php 1289
ERROR - 2020-12-23 15:18:13 --> Severity: Notice --> Trying to get property of non-object D:\xampp70\htdocs\sstcabang\application\models\pembelian\Model_retur_beli.php 1246
ERROR - 2020-12-23 15:18:13 --> Severity: Notice --> Trying to get property of non-object D:\xampp70\htdocs\sstcabang\application\models\pembelian\Model_retur_beli.php 1246
ERROR - 2020-12-23 15:18:13 --> Severity: Notice --> Trying to get property of non-object D:\xampp70\htdocs\sstcabang\application\models\pembelian\Model_retur_beli.php 1251
ERROR - 2020-12-23 15:18:13 --> Severity: Notice --> Trying to get property of non-object D:\xampp70\htdocs\sstcabang\application\models\pembelian\Model_retur_beli.php 1252
ERROR - 2020-12-23 15:18:13 --> Severity: Notice --> Trying to get property of non-object D:\xampp70\htdocs\sstcabang\application\models\pembelian\Model_retur_beli.php 1257
ERROR - 2020-12-23 15:18:13 --> Severity: Notice --> Trying to get property of non-object D:\xampp70\htdocs\sstcabang\application\models\pembelian\Model_retur_beli.php 1289
ERROR - 2020-12-23 15:18:49 --> Cabang
ERROR - 2020-12-23 15:19:39 --> Severity: Notice --> Undefined property: mysqli::$No_Usulan D:\xampp70\htdocs\sstcabang\application\models\pembelian\Model_retur_beli.php 1246
ERROR - 2020-12-23 15:19:39 --> Severity: Notice --> Undefined property: mysqli::$App_Log_Status D:\xampp70\htdocs\sstcabang\application\models\pembelian\Model_retur_beli.php 1246
ERROR - 2020-12-23 15:41:27 --> Cabang
ERROR - 2020-12-23 15:44:29 --> Cabang
ERROR - 2020-12-23 15:44:56 --> Cabang
